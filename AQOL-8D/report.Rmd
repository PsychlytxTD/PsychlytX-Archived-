---
title: "Assessment of Quality of Life - 8 Dimensions (AQoL-8D)"
author: "Report generated by PsychlytX"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
PN: 'NULL' 
CN: 'NULL'
Tab_Reference: 'NULL'
Stats_Table_Fullscale: 'NULL'
Stats_Table_Super_Physical: 'NULL'
Stats_Table_Super_Mental: 'NULL'
Stats_Table_Independent_Living: 'NULL'
Stats_Table_Pain: 'NULL'
Stats_Table_Senses: 'NULL'
Stats_Table_Relationships: 'NULL'
Stats_Table_Mental_Health: 'NULL'
Stats_Table_Coping: 'NULL'
Stats_Table_Self_Worth: 'NULL'
Stats_Table_Happiness: 'NULL'
Entered_Scores_Df: 'NULL'
Cutoff_Names: 'NULL'
Item_Df: 'NULL'
subtitle: '**Patient:** `r PN` **|** **Clinician:** `r CN`'
---

```{r,echo = FALSE,warning=FALSE,comment = NA}
knitr::opts_chunk$set(fig.width=7,fig.height=3) 

```

#AQoL-8D Total Scale 

##Response Summary

```{r,echo=FALSE,warning=FALSE,comment=NA}
Scores_Table<- Entered_Scores_Df[,c(1,2,3,4,5,6,7)]
names(Scores_Table)<- c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```


##Data Employed in Reliable Change Analyses

```{r,echo=FALSE,warning=FALSE,comment=NA}

Stats_Table_Fullscale<- kable(Stats_Table_Fullscale, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Fullscale, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```


##Trend (Standardised Scores)

```{r,echo=FALSE,warning=FALSE,comment=FALSE,message=FALSE, fig.width=9}
 p1<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1]),
                                                   paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1]),
                                                   paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim, ymax=Entered_Scores_Df$CI_Upper_Lim), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde", face = "bold") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score)), size = 3, family = "AvantGarde", face = "bold")   
                        
p1<- p1+labs(x="Date", y = "AQoL-8D Total Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde"))
print(p1) 
```

##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by ** 
```{r, echo = FALSE, warning = FALSE,comment=NA, message=FALSE}

if(length(Entered_Scores_Df$Date) == 2) {  

Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2<- data.frame(Time1, SigChange2)
      names(Change_Rep_Df2)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a<- data.frame(Time2, SigChange3a)
      names(Change_Rep_Df3a)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4<- data.frame(Time1, SigChange2, SigChange3, SigChange4)
      names(Change_Rep_Df4)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a<- data.frame(Time2, SigChange4a, SigChange4b)
      names(Change_Rep_Df4a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b<- data.frame(Time3, SigChange4c)
      names(Change_Rep_Df4b)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE, comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5<- data.frame(Time1, SigChange2, SigChange3, SigChange4, SigChange5)
      names(Change_Rep_Df5)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a<- data.frame(Time2, SigChange5a, SigChange5b, SigChange5c)
      names(Change_Rep_Df5a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4])
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b<- data.frame(Time3, SigChange5d, SigChange5e)
      names(Change_Rep_Df5b)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[4] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5], "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[4] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c<- data.frame(Time4, SigChange5f)
      names(Change_Rep_Df5c)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Physical Super Dimension

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Super_Physical<- Entered_Scores_Df[,c(1,92,93,94,95,96,97)]
names(Scores_Table_Super_Physical)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Super_Physical<- kable(Stats_Table_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Super_Physical, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p2<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Super_Physical, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Super_Physical_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Super_Physical_1[1],":",Entered_Scores_Df$Cutoff_Score_Super_Physical_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Super_Physical_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Super_Physical_2[1],":",Entered_Scores_Df$Cutoff_Score_Super_Physical_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Super_Physical_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Super_Physical_3[1],":",Entered_Scores_Df$Cutoff_Score_Super_Physical_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Super_Physical_1[1],":",Entered_Scores_Df$Cutoff_Score_Super_Physical_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Super_Physical_2[1],":",Entered_Scores_Df$Cutoff_Score_Super_Physical_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Super_Physical_3[1],":",Entered_Scores_Df$Cutoff_Score_Super_Physical_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Super_Physical, ymax=Entered_Scores_Df$CI_Upper_Lim_Super_Physical), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Super_Physical)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Super_Physical)), size = 3, family = "AvantGarde") 
  
p2<- p2+labs(x="Date", y = "Physical Super Dimension Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p2)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2], "**")
      } else if(Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Super_Physical<- data.frame(Time1, SigChange2_Super_Physical)
      names(Change_Rep_Df2_Super_Physical)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2], "**")
      } else if(Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2])
      }
      
      if(Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange3_Super_Physical<- paste((Rep_Df$Score_Super_Physical[3] - Rep_Df$Score_Super_Physical[1]), "**")
      } else if(Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange3_Super_Physical<- paste((Rep_Df$Score_Super_Physical[3] - Rep_Df$Score_Super_Physical[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Super_Physical<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Super_Physical)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Super_Physical)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Upper_Lim_Super_Physical[2] | Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange3a_Super_Physical<- paste(Rep_Df$Change_Super_Physical[3], "**")
      } else if(Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Upper_Lim_Super_Physical[2] & Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange3a_Super_Physical<- paste(Rep_Df$Change_Super_Physical[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Super_Physical<- data.frame(Time2, SigChange3a_Super_Physical)
      names(Change_Rep_Df3a_Super_Physical)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2], "**")
      } else if(Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2])
      }
      
      if(Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange3_Super_Physical<- paste((Rep_Df$Score_Super_Physical[3] - Rep_Df$Score_Super_Physical[1]), "**")
      } else if(Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange3_Super_Physical<- paste((Rep_Df$Score_Super_Physical[3] - Rep_Df$Score_Super_Physical[1]))
      }
      
      if(Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange4_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[1]), "**")
      } else if(Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange4_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Super_Physical<- data.frame(Time1, SigChange2_Super_Physical, SigChange3_Super_Physical, SigChange4_Super_Physical)
      names(Change_Rep_Df4_Super_Physical)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Super_Physical)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Super_Physical)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Upper_Lim_Super_Physical[2] | Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange4a_Super_Physical<- paste(Rep_Df$Change_Super_Physical[3], "**")
      } else if(Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Upper_Lim_Super_Physical[2] & Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange4a_Super_Physical<- paste(Rep_Df$Change_Super_Physical[3])
      }
      
      if(Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Upper_Lim_Super_Physical[2] | Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange4b_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[2]), "**")
      } else if(Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Upper_Lim_Super_Physical[2] & Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange4b_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Super_Physical<- data.frame(Time2, SigChange4a_Super_Physical, SigChange4b_Super_Physical)
      names(Change_Rep_Df4a_Super_Physical)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Super_Physical)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Upper_Lim_Super_Physical[3] | Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Lower_Lim_Super_Physical[3]) {
        SigChange4c_Super_Physical<- paste(Rep_Df$Change_Super_Physical[4], "**")
      } else if(Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Upper_Lim_Super_Physical[3] & Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Lower_Lim_Super_Physical[3]) {
        SigChange4c_Super_Physical<- paste(Rep_Df$Change_Super_Physical[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Super_Physical<- data.frame(Time3, SigChange4c_Super_Physical)
      names(Change_Rep_Df4b_Super_Physical)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2], "**")
      } else if(Rep_Df$Score_Super_Physical[2] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[2] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange2_Super_Physical<- paste(Rep_Df$Change_Super_Physical[2])
      }
      
      if(Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange3_Super_Physical<- paste((Rep_Df$Score_Super_Physical[3] - Rep_Df$Score_Super_Physical[1]), "**")
      } else if(Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange3_Super_Physical<- paste((Rep_Df$Score_Super_Physical[3] - Rep_Df$Score_Super_Physical[1]))
      }
      
      if(Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange4_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[1]), "**")
      } else if(Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange4_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[1]))
      }
      
      if(Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Upper_Lim_Super_Physical[1] | Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange5_Super_Physical<- paste((Rep_Df$Score_Super_Physical[5] - Rep_Df$Score_Super_Physical[1]), "**")
      } else if(Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Upper_Lim_Super_Physical[1] & Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Lower_Lim_Super_Physical[1]) {
        SigChange5_Super_Physical<- paste((Rep_Df$Score_Super_Physical[5] - Rep_Df$Score_Super_Physical[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Super_Physical<- data.frame(Time1, SigChange2_Super_Physical, SigChange3_Super_Physical, SigChange4_Super_Physical, SigChange5_Super_Physical)
      names(Change_Rep_Df5_Super_Physical)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Super_Physical)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Super_Physical)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Super_Physical)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Upper_Lim_Super_Physical[2] | Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange5a_Super_Physical<- paste(Rep_Df$Change_Super_Physical[3], "**")
      } else if(Rep_Df$Score_Super_Physical[3] < Rep_Df$CI_Upper_Lim_Super_Physical[2] & Rep_Df$Score_Super_Physical[3] > Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange5a_Super_Physical<- paste(Rep_Df$Change_Super_Physical[3])
      }
      
      if(Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Upper_Lim_Super_Physical[2] | Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange5b_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[2]), "**")
      } else if(Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Upper_Lim_Super_Physical[2] & Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange5b_Super_Physical<- paste((Rep_Df$Score_Super_Physical[4] - Rep_Df$Score_Super_Physical[2]))
      }
      
      if(Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Upper_Lim_Super_Physical[2] | Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange5c_Super_Physical<- paste((Rep_Df$Score_Super_Physical[5] - Rep_Df$Score_Super_Physical[2]), "**")
      } else if(Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Upper_Lim_Super_Physical[2] & Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Lower_Lim_Super_Physical[2]) {
        SigChange5c_Super_Physical<- paste((Rep_Df$Score_Super_Physical[5] - Rep_Df$Score_Super_Physical[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Super_Physical<- data.frame(Time2, SigChange5a_Super_Physical, SigChange5b_Super_Physical, SigChange5c_Super_Physical)
      names(Change_Rep_Df5a_Super_Physical)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Super_Physical)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Super_Physical)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Upper_Lim_Super_Physical[3] | Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Lower_Lim_Super_Physical[3]) {
        SigChange5d_Super_Physical<- paste(Rep_Df$Change_Super_Physical[4], "**")
      } else if(Rep_Df$Score_Super_Physical[4] < Rep_Df$CI_Upper_Lim_Super_Physical[3] & Rep_Df$Score_Super_Physical[4] > Rep_Df$CI_Lower_Lim_Super_Physical[3]) {
        SigChange5d_Super_Physical<- paste(Rep_Df$Change_Super_Physical[4])
      }
      
      if(Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Upper_Lim_Super_Physical[3] | Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Lower_Lim_Super_Physical[3]) {
        SigChange5e_Super_Physical<- paste((Rep_Df$Score_Super_Physical[5] - Rep_Df$Score_Super_Physical[3]), "**")
      } else if(Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Upper_Lim_Super_Physical[3] & Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Lower_Lim_Super_Physical[3]) {
        SigChange5e_Super_Physical<- paste((Rep_Df$Score_Super_Physical[5] - Rep_Df$Score_Super_Physical[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Super_Physical<- data.frame(Time3, SigChange5d_Super_Physical, SigChange5e_Super_Physical)
      names(Change_Rep_Df5b_Super_Physical)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Super_Physical)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Upper_Lim_Super_Physical[4] | Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Lower_Lim_Super_Physical[4]) {
        SigChange5f_Super_Physical<- paste(Rep_Df$Change_Super_Physical[5], "**")
      } else if(Rep_Df$Score_Super_Physical[5] < Rep_Df$CI_Upper_Lim_Super_Physical[4] & Rep_Df$Score_Super_Physical[5] > Rep_Df$CI_Lower_Lim_Super_Physical[4]) {
        SigChange5f_Super_Physical<- paste(Rep_Df$Change_Super_Physical[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Super_Physical<- data.frame(Time4, SigChange5f_Super_Physical)
      names(Change_Rep_Df5c_Super_Physical)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Super_Physical, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Mental Super Dimension

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Super_Mental<- Entered_Scores_Df[,c(1,83,84,85,86,87,88)]
names(Scores_Table_Super_Mental)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Super_Mental<- kable(Stats_Table_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Super_Mental, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p3<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Super_Mental, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Super_Mental_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Super_Mental_1[1],":",Entered_Scores_Df$Cutoff_Score_Super_Mental_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Super_Mental_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Super_Mental_2[1],":",Entered_Scores_Df$Cutoff_Score_Super_Mental_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Super_Mental_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Super_Mental_3[1],":",Entered_Scores_Df$Cutoff_Score_Super_Mental_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Super_Mental_1[1],":",Entered_Scores_Df$Cutoff_Score_Super_Mental_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Super_Mental_2[1],":",Entered_Scores_Df$Cutoff_Score_Super_Mental_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Super_Mental_3[1],":",Entered_Scores_Df$Cutoff_Score_Super_Mental_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Super_Mental, ymax=Entered_Scores_Df$CI_Upper_Lim_Super_Mental), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Super_Mental)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Super_Mental)), size = 3, family = "AvantGarde") 
  
p3<- p3+labs(x="Date", y = "Mental Super Dimension Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p3)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2], "**")
      } else if(Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Super_Mental<- data.frame(Time1, SigChange2_Super_Mental)
      names(Change_Rep_Df2_Super_Mental)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2], "**")
      } else if(Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2])
      }
      
      if(Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange3_Super_Mental<- paste((Rep_Df$Score_Super_Mental[3] - Rep_Df$Score_Super_Mental[1]), "**")
      } else if(Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange3_Super_Mental<- paste((Rep_Df$Score_Super_Mental[3] - Rep_Df$Score_Super_Mental[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Super_Mental<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Super_Mental)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Super_Mental)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Upper_Lim_Super_Mental[2] | Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange3a_Super_Mental<- paste(Rep_Df$Change_Super_Mental[3], "**")
      } else if(Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Upper_Lim_Super_Mental[2] & Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange3a_Super_Mental<- paste(Rep_Df$Change_Super_Mental[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Super_Mental<- data.frame(Time2, SigChange3a_Super_Mental)
      names(Change_Rep_Df3a_Super_Mental)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2], "**")
      } else if(Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2])
      }
      
      if(Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange3_Super_Mental<- paste((Rep_Df$Score_Super_Mental[3] - Rep_Df$Score_Super_Mental[1]), "**")
      } else if(Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange3_Super_Mental<- paste((Rep_Df$Score_Super_Mental[3] - Rep_Df$Score_Super_Mental[1]))
      }
      
      if(Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange4_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[1]), "**")
      } else if(Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange4_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Super_Mental<- data.frame(Time1, SigChange2_Super_Mental, SigChange3_Super_Mental, SigChange4_Super_Mental)
      names(Change_Rep_Df4_Super_Mental)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Super_Mental)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Super_Mental)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Upper_Lim_Super_Mental[2] | Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange4a_Super_Mental<- paste(Rep_Df$Change_Super_Mental[3], "**")
      } else if(Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Upper_Lim_Super_Mental[2] & Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange4a_Super_Mental<- paste(Rep_Df$Change_Super_Mental[3])
      }
      
      if(Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Upper_Lim_Super_Mental[2] | Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange4b_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[2]), "**")
      } else if(Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Upper_Lim_Super_Mental[2] & Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange4b_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Super_Mental<- data.frame(Time2, SigChange4a_Super_Mental, SigChange4b_Super_Mental)
      names(Change_Rep_Df4a_Super_Mental)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Super_Mental)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Upper_Lim_Super_Mental[3] | Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Lower_Lim_Super_Mental[3]) {
        SigChange4c_Super_Mental<- paste(Rep_Df$Change_Super_Mental[4], "**")
      } else if(Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Upper_Lim_Super_Mental[3] & Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Lower_Lim_Super_Mental[3]) {
        SigChange4c_Super_Mental<- paste(Rep_Df$Change_Super_Mental[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Super_Mental<- data.frame(Time3, SigChange4c_Super_Mental)
      names(Change_Rep_Df4b_Super_Mental)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2], "**")
      } else if(Rep_Df$Score_Super_Mental[2] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[2] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange2_Super_Mental<- paste(Rep_Df$Change_Super_Mental[2])
      }
      
      if(Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange3_Super_Mental<- paste((Rep_Df$Score_Super_Mental[3] - Rep_Df$Score_Super_Mental[1]), "**")
      } else if(Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange3_Super_Mental<- paste((Rep_Df$Score_Super_Mental[3] - Rep_Df$Score_Super_Mental[1]))
      }
      
      if(Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange4_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[1]), "**")
      } else if(Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange4_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[1]))
      }
      
      if(Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Upper_Lim_Super_Mental[1] | Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange5_Super_Mental<- paste((Rep_Df$Score_Super_Mental[5] - Rep_Df$Score_Super_Mental[1]), "**")
      } else if(Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Upper_Lim_Super_Mental[1] & Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Lower_Lim_Super_Mental[1]) {
        SigChange5_Super_Mental<- paste((Rep_Df$Score_Super_Mental[5] - Rep_Df$Score_Super_Mental[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Super_Mental<- data.frame(Time1, SigChange2_Super_Mental, SigChange3_Super_Mental, SigChange4_Super_Mental, SigChange5_Super_Mental)
      names(Change_Rep_Df5_Super_Mental)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Super_Mental)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Super_Mental)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Super_Mental)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Upper_Lim_Super_Mental[2] | Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange5a_Super_Mental<- paste(Rep_Df$Change_Super_Mental[3], "**")
      } else if(Rep_Df$Score_Super_Mental[3] < Rep_Df$CI_Upper_Lim_Super_Mental[2] & Rep_Df$Score_Super_Mental[3] > Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange5a_Super_Mental<- paste(Rep_Df$Change_Super_Mental[3])
      }
      
      if(Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Upper_Lim_Super_Mental[2] | Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange5b_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[2]), "**")
      } else if(Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Upper_Lim_Super_Mental[2] & Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange5b_Super_Mental<- paste((Rep_Df$Score_Super_Mental[4] - Rep_Df$Score_Super_Mental[2]))
      }
      
      if(Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Upper_Lim_Super_Mental[2] | Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange5c_Super_Mental<- paste((Rep_Df$Score_Super_Mental[5] - Rep_Df$Score_Super_Mental[2]), "**")
      } else if(Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Upper_Lim_Super_Mental[2] & Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Lower_Lim_Super_Mental[2]) {
        SigChange5c_Super_Mental<- paste((Rep_Df$Score_Super_Mental[5] - Rep_Df$Score_Super_Mental[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Super_Mental<- data.frame(Time2, SigChange5a_Super_Mental, SigChange5b_Super_Mental, SigChange5c_Super_Mental)
      names(Change_Rep_Df5a_Super_Mental)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Super_Mental)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Super_Mental)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Upper_Lim_Super_Mental[3] | Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Lower_Lim_Super_Mental[3]) {
        SigChange5d_Super_Mental<- paste(Rep_Df$Change_Super_Mental[4], "**")
      } else if(Rep_Df$Score_Super_Mental[4] < Rep_Df$CI_Upper_Lim_Super_Mental[3] & Rep_Df$Score_Super_Mental[4] > Rep_Df$CI_Lower_Lim_Super_Mental[3]) {
        SigChange5d_Super_Mental<- paste(Rep_Df$Change_Super_Mental[4])
      }
      
      if(Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Upper_Lim_Super_Mental[3] | Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Lower_Lim_Super_Mental[3]) {
        SigChange5e_Super_Mental<- paste((Rep_Df$Score_Super_Mental[5] - Rep_Df$Score_Super_Mental[3]), "**")
      } else if(Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Upper_Lim_Super_Mental[3] & Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Lower_Lim_Super_Mental[3]) {
        SigChange5e_Super_Mental<- paste((Rep_Df$Score_Super_Mental[5] - Rep_Df$Score_Super_Mental[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Super_Mental<- data.frame(Time3, SigChange5d_Super_Mental, SigChange5e_Super_Mental)
      names(Change_Rep_Df5b_Super_Mental)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Super_Mental)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Upper_Lim_Super_Mental[4] | Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Lower_Lim_Super_Mental[4]) {
        SigChange5f_Super_Mental<- paste(Rep_Df$Change_Super_Mental[5], "**")
      } else if(Rep_Df$Score_Super_Mental[5] < Rep_Df$CI_Upper_Lim_Super_Mental[4] & Rep_Df$Score_Super_Mental[5] > Rep_Df$CI_Lower_Lim_Super_Mental[4]) {
        SigChange5f_Super_Mental<- paste(Rep_Df$Change_Super_Mental[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Super_Mental<- data.frame(Time4, SigChange5f_Super_Mental)
      names(Change_Rep_Df5c_Super_Mental)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Super_Mental, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Independent Living Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Independent_Living<- Entered_Scores_Df[,c(1,11,12,13,14,15,16)]
names(Scores_Table_Independent_Living)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Independent_Living<- kable(Stats_Table_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Independent_Living, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p4<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Independent_Living, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Independent_Living_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Independent_Living_1[1],":",Entered_Scores_Df$Cutoff_Score_Independent_Living_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Independent_Living_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Independent_Living_2[1],":",Entered_Scores_Df$Cutoff_Score_Independent_Living_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Independent_Living_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Independent_Living_3[1],":",Entered_Scores_Df$Cutoff_Score_Independent_Living_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Independent_Living_1[1],":",Entered_Scores_Df$Cutoff_Score_Independent_Living_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Independent_Living_2[1],":",Entered_Scores_Df$Cutoff_Score_Independent_Living_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Independent_Living_3[1],":",Entered_Scores_Df$Cutoff_Score_Independent_Living_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Independent_Living, ymax=Entered_Scores_Df$CI_Upper_Lim_Independent_Living), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Independent_Living)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Independent_Living)), size = 3, family = "AvantGarde")  
  
p4<- p4+labs(x="Date", y = "Independent Living Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p4)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2], "**")
      } else if(Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Independent_Living<- data.frame(Time1, SigChange2_Independent_Living)
      names(Change_Rep_Df2_Independent_Living)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2], "**")
      } else if(Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2])
      }
      
      if(Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange3_Independent_Living<- paste((Rep_Df$Score_Independent_Living[3] - Rep_Df$Score_Independent_Living[1]), "**")
      } else if(Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange3_Independent_Living<- paste((Rep_Df$Score_Independent_Living[3] - Rep_Df$Score_Independent_Living[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Independent_Living<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Independent_Living)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Independent_Living)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Upper_Lim_Independent_Living[2] | Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange3a_Independent_Living<- paste(Rep_Df$Change_Independent_Living[3], "**")
      } else if(Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Upper_Lim_Independent_Living[2] & Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange3a_Independent_Living<- paste(Rep_Df$Change_Independent_Living[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Independent_Living<- data.frame(Time2, SigChange3a_Independent_Living)
      names(Change_Rep_Df3a_Independent_Living)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2], "**")
      } else if(Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2])
      }
      
      if(Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange3_Independent_Living<- paste((Rep_Df$Score_Independent_Living[3] - Rep_Df$Score_Independent_Living[1]), "**")
      } else if(Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange3_Independent_Living<- paste((Rep_Df$Score_Independent_Living[3] - Rep_Df$Score_Independent_Living[1]))
      }
      
      if(Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange4_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[1]), "**")
      } else if(Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange4_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Independent_Living<- data.frame(Time1, SigChange2_Independent_Living, SigChange3_Independent_Living, SigChange4_Independent_Living)
      names(Change_Rep_Df4_Independent_Living)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Independent_Living)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Independent_Living)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Upper_Lim_Independent_Living[2] | Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange4a_Independent_Living<- paste(Rep_Df$Change_Independent_Living[3], "**")
      } else if(Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Upper_Lim_Independent_Living[2] & Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange4a_Independent_Living<- paste(Rep_Df$Change_Independent_Living[3])
      }
      
      if(Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Upper_Lim_Independent_Living[2] | Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange4b_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[2]), "**")
      } else if(Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Upper_Lim_Independent_Living[2] & Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange4b_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Independent_Living<- data.frame(Time2, SigChange4a_Independent_Living, SigChange4b_Independent_Living)
      names(Change_Rep_Df4a_Independent_Living)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Independent_Living)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Upper_Lim_Independent_Living[3] | Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Lower_Lim_Independent_Living[3]) {
        SigChange4c_Independent_Living<- paste(Rep_Df$Change_Independent_Living[4], "**")
      } else if(Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Upper_Lim_Independent_Living[3] & Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Lower_Lim_Independent_Living[3]) {
        SigChange4c_Independent_Living<- paste(Rep_Df$Change_Independent_Living[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Independent_Living<- data.frame(Time3, SigChange4c_Independent_Living)
      names(Change_Rep_Df4b_Independent_Living)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2], "**")
      } else if(Rep_Df$Score_Independent_Living[2] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[2] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange2_Independent_Living<- paste(Rep_Df$Change_Independent_Living[2])
      }
      
      if(Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange3_Independent_Living<- paste((Rep_Df$Score_Independent_Living[3] - Rep_Df$Score_Independent_Living[1]), "**")
      } else if(Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange3_Independent_Living<- paste((Rep_Df$Score_Independent_Living[3] - Rep_Df$Score_Independent_Living[1]))
      }
      
      if(Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange4_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[1]), "**")
      } else if(Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange4_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[1]))
      }
      
      if(Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Upper_Lim_Independent_Living[1] | Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange5_Independent_Living<- paste((Rep_Df$Score_Independent_Living[5] - Rep_Df$Score_Independent_Living[1]), "**")
      } else if(Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Upper_Lim_Independent_Living[1] & Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Lower_Lim_Independent_Living[1]) {
        SigChange5_Independent_Living<- paste((Rep_Df$Score_Independent_Living[5] - Rep_Df$Score_Independent_Living[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Independent_Living<- data.frame(Time1, SigChange2_Independent_Living, SigChange3_Independent_Living, SigChange4_Independent_Living, SigChange5_Independent_Living)
      names(Change_Rep_Df5_Independent_Living)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Independent_Living)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Independent_Living)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Independent_Living)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Upper_Lim_Independent_Living[2] | Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange5a_Independent_Living<- paste(Rep_Df$Change_Independent_Living[3], "**")
      } else if(Rep_Df$Score_Independent_Living[3] < Rep_Df$CI_Upper_Lim_Independent_Living[2] & Rep_Df$Score_Independent_Living[3] > Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange5a_Independent_Living<- paste(Rep_Df$Change_Independent_Living[3])
      }
      
      if(Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Upper_Lim_Independent_Living[2] | Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange5b_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[2]), "**")
      } else if(Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Upper_Lim_Independent_Living[2] & Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange5b_Independent_Living<- paste((Rep_Df$Score_Independent_Living[4] - Rep_Df$Score_Independent_Living[2]))
      }
      
      if(Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Upper_Lim_Independent_Living[2] | Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange5c_Independent_Living<- paste((Rep_Df$Score_Independent_Living[5] - Rep_Df$Score_Independent_Living[2]), "**")
      } else if(Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Upper_Lim_Independent_Living[2] & Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Lower_Lim_Independent_Living[2]) {
        SigChange5c_Independent_Living<- paste((Rep_Df$Score_Independent_Living[5] - Rep_Df$Score_Independent_Living[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Independent_Living<- data.frame(Time2, SigChange5a_Independent_Living, SigChange5b_Independent_Living, SigChange5c_Independent_Living)
      names(Change_Rep_Df5a_Independent_Living)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Independent_Living)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Independent_Living)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Upper_Lim_Independent_Living[3] | Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Lower_Lim_Independent_Living[3]) {
        SigChange5d_Independent_Living<- paste(Rep_Df$Change_Independent_Living[4], "**")
      } else if(Rep_Df$Score_Independent_Living[4] < Rep_Df$CI_Upper_Lim_Independent_Living[3] & Rep_Df$Score_Independent_Living[4] > Rep_Df$CI_Lower_Lim_Independent_Living[3]) {
        SigChange5d_Independent_Living<- paste(Rep_Df$Change_Independent_Living[4])
      }
      
      if(Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Upper_Lim_Independent_Living[3] | Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Lower_Lim_Independent_Living[3]) {
        SigChange5e_Independent_Living<- paste((Rep_Df$Score_Independent_Living[5] - Rep_Df$Score_Independent_Living[3]), "**")
      } else if(Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Upper_Lim_Independent_Living[3] & Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Lower_Lim_Independent_Living[3]) {
        SigChange5e_Independent_Living<- paste((Rep_Df$Score_Independent_Living[5] - Rep_Df$Score_Independent_Living[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Independent_Living<- data.frame(Time3, SigChange5d_Independent_Living, SigChange5e_Independent_Living)
      names(Change_Rep_Df5b_Independent_Living)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Independent_Living)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Upper_Lim_Independent_Living[4] | Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Lower_Lim_Independent_Living[4]) {
        SigChange5f_Independent_Living<- paste(Rep_Df$Change_Independent_Living[5], "**")
      } else if(Rep_Df$Score_Independent_Living[5] < Rep_Df$CI_Upper_Lim_Independent_Living[4] & Rep_Df$Score_Independent_Living[5] > Rep_Df$CI_Lower_Lim_Independent_Living[4]) {
        SigChange5f_Independent_Living<- paste(Rep_Df$Change_Independent_Living[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Independent_Living<- data.frame(Time4, SigChange5f_Independent_Living)
      names(Change_Rep_Df5c_Independent_Living)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Independent_Living, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Pain Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Pain<- Entered_Scores_Df[,c(1,47,48,49,50,51,52)]
names(Scores_Table_Pain)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Pain<- kable(Stats_Table_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Pain, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p5<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Pain, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Pain_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Pain_1[1],":",Entered_Scores_Df$Cutoff_Score_Pain_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Pain_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Pain_2[1],":",Entered_Scores_Df$Cutoff_Score_Pain_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Pain_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Pain_3[1],":",Entered_Scores_Df$Cutoff_Score_Pain_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Pain_1[1],":",Entered_Scores_Df$Cutoff_Score_Pain_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Pain_2[1],":",Entered_Scores_Df$Cutoff_Score_Pain_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Pain_3[1],":",Entered_Scores_Df$Cutoff_Score_Pain_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Pain, ymax=Entered_Scores_Df$CI_Upper_Lim_Pain), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Pain)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Pain)), size = 3, family = "AvantGarde") 
  
p5<- p5+labs(x="Date", y = "Pain Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p5)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Pain[2] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[2] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change_Pain[2], "**")
      } else if(Rep_Df$Score_Pain[2] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[2] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change_Pain[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Pain<- data.frame(Time1, SigChange2_Pain)
      names(Change_Rep_Df2_Pain)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Pain[2] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[2] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change_Pain[2], "**")
      } else if(Rep_Df$Score_Pain[2] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[2] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change_Pain[2])
      }
      
      if(Rep_Df$Score_Pain[3] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[3] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange3_Pain<- paste((Rep_Df$Score_Pain[3] - Rep_Df$Score_Pain[1]), "**")
      } else if(Rep_Df$Score_Pain[3] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[3] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange3_Pain<- paste((Rep_Df$Score_Pain[3] - Rep_Df$Score_Pain[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Pain<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Pain)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Pain)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Pain[3] > Rep_Df$CI_Upper_Lim_Pain[2] | Rep_Df$Score_Pain[3] < Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange3a_Pain<- paste(Rep_Df$Change_Pain[3], "**")
      } else if(Rep_Df$Score_Pain[3] < Rep_Df$CI_Upper_Lim_Pain[2] & Rep_Df$Score_Pain[3] > Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange3a_Pain<- paste(Rep_Df$Change_Pain[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Pain<- data.frame(Time2, SigChange3a_Pain)
      names(Change_Rep_Df3a_Pain)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Pain[2] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[2] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change_Pain[2], "**")
      } else if(Rep_Df$Score_Pain[2] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[2] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change_Pain[2])
      }
      
      if(Rep_Df$Score_Pain[3] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[3] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange3_Pain<- paste((Rep_Df$Score_Pain[3] - Rep_Df$Score_Pain[1]), "**")
      } else if(Rep_Df$Score_Pain[3] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[3] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange3_Pain<- paste((Rep_Df$Score_Pain[3] - Rep_Df$Score_Pain[1]))
      }
      
      if(Rep_Df$Score_Pain[4] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[4] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange4_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[1]), "**")
      } else if(Rep_Df$Score_Pain[4] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[4] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange4_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Pain<- data.frame(Time1, SigChange2_Pain, SigChange3_Pain, SigChange4_Pain)
      names(Change_Rep_Df4_Pain)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Pain)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Pain)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Pain[3] > Rep_Df$CI_Upper_Lim_Pain[2] | Rep_Df$Score_Pain[3] < Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange4a_Pain<- paste(Rep_Df$Change_Pain[3], "**")
      } else if(Rep_Df$Score_Pain[3] < Rep_Df$CI_Upper_Lim_Pain[2] & Rep_Df$Score_Pain[3] > Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange4a_Pain<- paste(Rep_Df$Change_Pain[3])
      }
      
      if(Rep_Df$Score_Pain[4] > Rep_Df$CI_Upper_Lim_Pain[2] | Rep_Df$Score_Pain[4] < Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange4b_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[2]), "**")
      } else if(Rep_Df$Score_Pain[4] < Rep_Df$CI_Upper_Lim_Pain[2] & Rep_Df$Score_Pain[4] > Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange4b_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Pain<- data.frame(Time2, SigChange4a_Pain, SigChange4b_Pain)
      names(Change_Rep_Df4a_Pain)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Pain)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Pain[4] > Rep_Df$CI_Upper_Lim_Pain[3] | Rep_Df$Score_Pain[4] < Rep_Df$CI_Lower_Lim_Pain[3]) {
        SigChange4c_Pain<- paste(Rep_Df$Change_Pain[4], "**")
      } else if(Rep_Df$Score_Pain[4] < Rep_Df$CI_Upper_Lim_Pain[3] & Rep_Df$Score_Pain[4] > Rep_Df$CI_Lower_Lim_Pain[3]) {
        SigChange4c_Pain<- paste(Rep_Df$Change_Pain[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Pain<- data.frame(Time3, SigChange4c_Pain)
      names(Change_Rep_Df4b_Pain)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Pain[2] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[2] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Pain[2] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[2] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange2_Pain<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Pain[3] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[3] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange3_Pain<- paste((Rep_Df$Score_Pain[3] - Rep_Df$Score_Pain[1]), "**")
      } else if(Rep_Df$Score_Pain[3] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[3] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange3_Pain<- paste((Rep_Df$Score_Pain[3] - Rep_Df$Score_Pain[1]))
      }
      
      if(Rep_Df$Score_Pain[4] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[4] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange4_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[1]), "**")
      } else if(Rep_Df$Score_Pain[4] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[4] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange4_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[1]))
      }
      
      if(Rep_Df$Score_Pain[5] > Rep_Df$CI_Upper_Lim_Pain[1] | Rep_Df$Score_Pain[5] < Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange5_Pain<- paste((Rep_Df$Score_Pain[5] - Rep_Df$Score_Pain[1]), "**")
      } else if(Rep_Df$Score_Pain[5] < Rep_Df$CI_Upper_Lim_Pain[1] & Rep_Df$Score_Pain[5] > Rep_Df$CI_Lower_Lim_Pain[1]) {
        SigChange5_Pain<- paste((Rep_Df$Score_Pain[5] - Rep_Df$Score_Pain[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Pain<- data.frame(Time1, SigChange2_Pain, SigChange3_Pain, SigChange4_Pain, SigChange5_Pain)
      names(Change_Rep_Df5_Pain)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Pain)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Pain)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Pain)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Pain[3] > Rep_Df$CI_Upper_Lim_Pain[2] | Rep_Df$Score_Pain[3] < Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange5a_Pain<- paste(Rep_Df$Change_Pain[3], "**")
      } else if(Rep_Df$Score_Pain[3] < Rep_Df$CI_Upper_Lim_Pain[2] & Rep_Df$Score_Pain[3] > Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange5a_Pain<- paste(Rep_Df$Change_Pain[3])
      }
      
      if(Rep_Df$Score_Pain[4] > Rep_Df$CI_Upper_Lim_Pain[2] | Rep_Df$Score_Pain[4] < Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange5b_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[2]), "**")
      } else if(Rep_Df$Score_Pain[4] < Rep_Df$CI_Upper_Lim_Pain[2] & Rep_Df$Score_Pain[4] > Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange5b_Pain<- paste((Rep_Df$Score_Pain[4] - Rep_Df$Score_Pain[2]))
      }
      
      if(Rep_Df$Score_Pain[5] > Rep_Df$CI_Upper_Lim_Pain[2] | Rep_Df$Score_Pain[5] < Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange5c_Pain<- paste((Rep_Df$Score_Pain[5] - Rep_Df$Score_Pain[2]), "**")
      } else if(Rep_Df$Score_Pain[5] < Rep_Df$CI_Upper_Lim_Pain[2] & Rep_Df$Score_Pain[5] > Rep_Df$CI_Lower_Lim_Pain[2]) {
        SigChange5c_Pain<- paste((Rep_Df$Score_Pain[5] - Rep_Df$Score_Pain[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Pain<- data.frame(Time2, SigChange5a_Pain, SigChange5b_Pain, SigChange5c_Pain)
      names(Change_Rep_Df5a_Pain)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Pain)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Pain)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Pain[4] > Rep_Df$CI_Upper_Lim_Pain[3] | Rep_Df$Score_Pain[4] < Rep_Df$CI_Lower_Lim_Pain[3]) {
        SigChange5d_Pain<- paste(Rep_Df$Change_Pain[4], "**")
      } else if(Rep_Df$Score_Pain[4] < Rep_Df$CI_Upper_Lim_Pain[3] & Rep_Df$Score_Pain[4] > Rep_Df$CI_Lower_Lim_Pain[3]) {
        SigChange5d_Pain<- paste(Rep_Df$Change_Pain[4])
      }
      
      if(Rep_Df$Score_Pain[5] > Rep_Df$CI_Upper_Lim_Pain[3] | Rep_Df$Score_Pain[5] < Rep_Df$CI_Lower_Lim_Pain[3]) {
        SigChange5e_Pain<- paste((Rep_Df$Score_Pain[5] - Rep_Df$Score_Pain[3]), "**")
      } else if(Rep_Df$Score_Pain[5] < Rep_Df$CI_Upper_Lim_Pain[3] & Rep_Df$Score_Pain[5] > Rep_Df$CI_Lower_Lim_Pain[3]) {
        SigChange5e_Pain<- paste((Rep_Df$Score_Pain[5] - Rep_Df$Score_Pain[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Pain<- data.frame(Time3, SigChange5d_Pain, SigChange5e_Pain)
      names(Change_Rep_Df5b_Pain)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Pain)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Pain[5] > Rep_Df$CI_Upper_Lim_Pain[4] | Rep_Df$Score_Pain[5] < Rep_Df$CI_Lower_Lim_Pain[4]) {
        SigChange5f_Pain<- paste(Rep_Df$Change_Pain[5], "**")
      } else if(Rep_Df$Score_Pain[5] < Rep_Df$CI_Upper_Lim_Pain[4] & Rep_Df$Score_Pain[5] > Rep_Df$CI_Lower_Lim_Pain[4]) {
        SigChange5f_Pain<- paste(Rep_Df$Change_Pain[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Pain<- data.frame(Time4, SigChange5f_Pain)
      names(Change_Rep_Df5c_Pain)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Pain, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Senses Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Senses<- Entered_Scores_Df[,c(1,56,57,58,59,60,61)]
names(Scores_Table_Senses)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Senses<- kable(Stats_Table_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Senses, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p6<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Senses, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Senses_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Senses_1[1],":",Entered_Scores_Df$Cutoff_Score_Senses_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Senses_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Senses_2[1],":",Entered_Scores_Df$Cutoff_Score_Senses_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Senses_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Senses_3[1],":",Entered_Scores_Df$Cutoff_Score_Senses_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Senses_1[1],":",Entered_Scores_Df$Cutoff_Score_Senses_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Senses_2[1],":",Entered_Scores_Df$Cutoff_Score_Senses_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Senses_3[1],":",Entered_Scores_Df$Cutoff_Score_Senses_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Senses, ymax=Entered_Scores_Df$CI_Upper_Lim_Senses), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Senses)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Senses)), size = 3, family = "AvantGarde") 
  
p6<- p6+labs(x="Date", y = "Senses Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p6)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Senses[2] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[2] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2], "**")
      } else if(Rep_Df$Score_Senses[2] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[2] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Senses<- data.frame(Time1, SigChange2_Senses)
      names(Change_Rep_Df2_Senses)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Senses[2] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[2] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2], "**")
      } else if(Rep_Df$Score_Senses[2] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[2] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2])
      }
      
      if(Rep_Df$Score_Senses[3] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[3] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange3_Senses<- paste((Rep_Df$Score_Senses[3] - Rep_Df$Score_Senses[1]), "**")
      } else if(Rep_Df$Score_Senses[3] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[3] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange3_Senses<- paste((Rep_Df$Score_Senses[3] - Rep_Df$Score_Senses[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Senses<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Senses)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Senses)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Senses[3] > Rep_Df$CI_Upper_Lim_Senses[2] | Rep_Df$Score_Senses[3] < Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange3a_Senses<- paste(Rep_Df$Change_Senses[3], "**")
      } else if(Rep_Df$Score_Senses[3] < Rep_Df$CI_Upper_Lim_Senses[2] & Rep_Df$Score_Senses[3] > Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange3a_Senses<- paste(Rep_Df$Change_Senses[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Senses<- data.frame(Time2, SigChange3a_Senses)
      names(Change_Rep_Df3a_Senses)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Senses[2] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[2] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2], "**")
      } else if(Rep_Df$Score_Senses[2] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[2] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2])
      }
      
      if(Rep_Df$Score_Senses[3] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[3] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange3_Senses<- paste((Rep_Df$Score_Senses[3] - Rep_Df$Score_Senses[1]), "**")
      } else if(Rep_Df$Score_Senses[3] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[3] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange3_Senses<- paste((Rep_Df$Score_Senses[3] - Rep_Df$Score_Senses[1]))
      }
      
      if(Rep_Df$Score_Senses[4] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[4] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange4_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[1]), "**")
      } else if(Rep_Df$Score_Senses[4] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[4] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange4_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Senses<- data.frame(Time1, SigChange2_Senses, SigChange3_Senses, SigChange4_Senses)
      names(Change_Rep_Df4_Senses)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Senses)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Senses)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Senses[3] > Rep_Df$CI_Upper_Lim_Senses[2] | Rep_Df$Score_Senses[3] < Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange4a_Senses<- paste(Rep_Df$Change_Senses[3], "**")
      } else if(Rep_Df$Score_Senses[3] < Rep_Df$CI_Upper_Lim_Senses[2] & Rep_Df$Score_Senses[3] > Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange4a_Senses<- paste(Rep_Df$Change_Senses[3])
      }
      
      if(Rep_Df$Score_Senses[4] > Rep_Df$CI_Upper_Lim_Senses[2] | Rep_Df$Score_Senses[4] < Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange4b_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[2]), "**")
      } else if(Rep_Df$Score_Senses[4] < Rep_Df$CI_Upper_Lim_Senses[2] & Rep_Df$Score_Senses[4] > Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange4b_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Senses<- data.frame(Time2, SigChange4a_Senses, SigChange4b_Senses)
      names(Change_Rep_Df4a_Senses)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Senses)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Senses[4] > Rep_Df$CI_Upper_Lim_Senses[3] | Rep_Df$Score_Senses[4] < Rep_Df$CI_Lower_Lim_Senses[3]) {
        SigChange4c_Senses<- paste(Rep_Df$Change_Senses[4], "**")
      } else if(Rep_Df$Score_Senses[4] < Rep_Df$CI_Upper_Lim_Senses[3] & Rep_Df$Score_Senses[4] > Rep_Df$CI_Lower_Lim_Senses[3]) {
        SigChange4c_Senses<- paste(Rep_Df$Change_Senses[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Senses<- data.frame(Time3, SigChange4c_Senses)
      names(Change_Rep_Df4b_Senses)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Senses[2] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[2] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2], "**")
      } else if(Rep_Df$Score_Senses[2] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[2] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange2_Senses<- paste(Rep_Df$Change_Senses[2])
      }
      
      if(Rep_Df$Score_Senses[3] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[3] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange3_Senses<- paste((Rep_Df$Score_Senses[3] - Rep_Df$Score_Senses[1]), "**")
      } else if(Rep_Df$Score_Senses[3] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[3] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange3_Senses<- paste((Rep_Df$Score_Senses[3] - Rep_Df$Score_Senses[1]))
      }
      
      if(Rep_Df$Score_Senses[4] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[4] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange4_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[1]), "**")
      } else if(Rep_Df$Score_Senses[4] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[4] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange4_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[1]))
      }
      
      if(Rep_Df$Score_Senses[5] > Rep_Df$CI_Upper_Lim_Senses[1] | Rep_Df$Score_Senses[5] < Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange5_Senses<- paste((Rep_Df$Score_Senses[5] - Rep_Df$Score_Senses[1]), "**")
      } else if(Rep_Df$Score_Senses[5] < Rep_Df$CI_Upper_Lim_Senses[1] & Rep_Df$Score_Senses[5] > Rep_Df$CI_Lower_Lim_Senses[1]) {
        SigChange5_Senses<- paste((Rep_Df$Score_Senses[5] - Rep_Df$Score_Senses[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Senses<- data.frame(Time1, SigChange2_Senses, SigChange3_Senses, SigChange4_Senses, SigChange5_Senses)
      names(Change_Rep_Df5_Senses)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Senses)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Senses)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Senses)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Senses[3] > Rep_Df$CI_Upper_Lim_Senses[2] | Rep_Df$Score_Senses[3] < Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange5a_Senses<- paste(Rep_Df$Change_Senses[3], "**")
      } else if(Rep_Df$Score_Senses[3] < Rep_Df$CI_Upper_Lim_Senses[2] & Rep_Df$Score_Senses[3] > Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange5a_Senses<- paste(Rep_Df$Change_Senses[3])
      }
      
      if(Rep_Df$Score_Senses[4] > Rep_Df$CI_Upper_Lim_Senses[2] | Rep_Df$Score_Senses[4] < Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange5b_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[2]), "**")
      } else if(Rep_Df$Score_Senses[4] < Rep_Df$CI_Upper_Lim_Senses[2] & Rep_Df$Score_Senses[4] > Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange5b_Senses<- paste((Rep_Df$Score_Senses[4] - Rep_Df$Score_Senses[2]))
      }
      
      if(Rep_Df$Score_Senses[5] > Rep_Df$CI_Upper_Lim_Senses[2] | Rep_Df$Score_Senses[5] < Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange5c_Senses<- paste((Rep_Df$Score_Senses[5] - Rep_Df$Score_Senses[2]), "**")
      } else if(Rep_Df$Score_Senses[5] < Rep_Df$CI_Upper_Lim_Senses[2] & Rep_Df$Score_Senses[5] > Rep_Df$CI_Lower_Lim_Senses[2]) {
        SigChange5c_Senses<- paste((Rep_Df$Score_Senses[5] - Rep_Df$Score_Senses[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Senses<- data.frame(Time2, SigChange5a_Senses, SigChange5b_Senses, SigChange5c_Senses)
      names(Change_Rep_Df5a_Senses)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Senses)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Senses)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Senses[4] > Rep_Df$CI_Upper_Lim_Senses[3] | Rep_Df$Score_Senses[4] < Rep_Df$CI_Lower_Lim_Senses[3]) {
        SigChange5d_Senses<- paste(Rep_Df$Change_Senses[4], "**")
      } else if(Rep_Df$Score_Senses[4] < Rep_Df$CI_Upper_Lim_Senses[3] & Rep_Df$Score_Senses[4] > Rep_Df$CI_Lower_Lim_Senses[3]) {
        SigChange5d_Senses<- paste(Rep_Df$Change_Senses[4])
      }
      
      if(Rep_Df$Score_Senses[5] > Rep_Df$CI_Upper_Lim_Senses[3] | Rep_Df$Score_Senses[5] < Rep_Df$CI_Lower_Lim_Senses[3]) {
        SigChange5e_Senses<- paste((Rep_Df$Score_Senses[5] - Rep_Df$Score_Senses[3]), "**")
      } else if(Rep_Df$Score_Senses[5] < Rep_Df$CI_Upper_Lim_Senses[3] & Rep_Df$Score_Senses[5] > Rep_Df$CI_Lower_Lim_Senses[3]) {
        SigChange5e_Senses<- paste((Rep_Df$Score_Senses[5] - Rep_Df$Score_Senses[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Senses<- data.frame(Time3, SigChange5d_Senses, SigChange5e_Senses)
      names(Change_Rep_Df5b_Senses)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Senses)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Senses[5] > Rep_Df$CI_Upper_Lim_Senses[4] | Rep_Df$Score_Senses[5] < Rep_Df$CI_Lower_Lim_Senses[4]) {
        SigChange5f_Senses<- paste(Rep_Df$Change_Senses[5], "**")
      } else if(Rep_Df$Score_Senses[5] < Rep_Df$CI_Upper_Lim_Senses[4] & Rep_Df$Score_Senses[5] > Rep_Df$CI_Lower_Lim_Senses[4]) {
        SigChange5f_Senses<- paste(Rep_Df$Change_Senses[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Senses<- data.frame(Time4, SigChange5f_Senses)
      names(Change_Rep_Df5c_Senses)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Senses, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage


#Relationships Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Relationships<- Entered_Scores_Df[,c(1,20,21,22,23,24,25)]
names(Scores_Table_Relationships)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Relationships<- kable(Stats_Table_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Relationships, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p7<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Relationships, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Relationships_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Relationships_1[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Relationships_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Relationships_2[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Relationships_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Relationships_3[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Relationships_1[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Relationships_2[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Relationships_3[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Relationships, ymax=Entered_Scores_Df$CI_Upper_Lim_Relationships), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Relationships)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Relationships)), size = 3, family = "AvantGarde") 
  
p7<- p7+labs(x="Date", y = "Relationships Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p7)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Relationships<- data.frame(Time1, SigChange2_Relationships)
      names(Change_Rep_Df2_Relationships)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Relationships<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Relationships)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Relationships)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange3a_Relationships<- paste(Rep_Df$Change_Relationships[3], "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange3a_Relationships<- paste(Rep_Df$Change_Relationships[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Relationships<- data.frame(Time2, SigChange3a_Relationships)
      names(Change_Rep_Df3a_Relationships)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]))
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Relationships<- data.frame(Time1, SigChange2_Relationships, SigChange3_Relationships, SigChange4_Relationships)
      names(Change_Rep_Df4_Relationships)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Relationships)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Relationships)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4a_Relationships<- paste(Rep_Df$Change_Relationships[3], "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4a_Relationships<- paste(Rep_Df$Change_Relationships[3])
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Relationships<- data.frame(Time2, SigChange4a_Relationships, SigChange4b_Relationships)
      names(Change_Rep_Df4a_Relationships)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Relationships)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[3] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange4c_Relationships<- paste(Rep_Df$Change_Relationships[4], "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[3] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange4c_Relationships<- paste(Rep_Df$Change_Relationships[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Relationships<- data.frame(Time3, SigChange4c_Relationships)
      names(Change_Rep_Df4b_Relationships)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]))
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]))
      }
      
      if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange5_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange5_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Relationships<- data.frame(Time1, SigChange2_Relationships, SigChange3_Relationships, SigChange4_Relationships, SigChange5_Relationships)
      names(Change_Rep_Df5_Relationships)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Relationships)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Relationships)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Relationships)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5a_Relationships<- paste(Rep_Df$Change_Relationships[3], "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5a_Relationships<- paste(Rep_Df$Change_Relationships[3])
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]))
      }
      
      if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5c_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[2]), "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5c_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Relationships<- data.frame(Time2, SigChange5a_Relationships, SigChange5b_Relationships, SigChange5c_Relationships)
      names(Change_Rep_Df5a_Relationships)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Relationships)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Relationships)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[3] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5d_Relationships<- paste(Rep_Df$Change_Relationships[4], "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[3] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5d_Relationships<- paste(Rep_Df$Change_Relationships[4])
      }
      
      if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[3] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5e_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[3]), "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[3] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5e_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Relationships<- data.frame(Time3, SigChange5d_Relationships, SigChange5e_Relationships)
      names(Change_Rep_Df5b_Relationships)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Relationships)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[4] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[4]) {
        SigChange5f_Relationships<- paste(Rep_Df$Change_Relationships[5], "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[4] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[4]) {
        SigChange5f_Relationships<- paste(Rep_Df$Change_Relationships[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Relationships<- data.frame(Time4, SigChange5f_Relationships)
      names(Change_Rep_Df5c_Relationships)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage


#Mental Health Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Mental_Health<- Entered_Scores_Df[,c(1,29,30,31,32,33,34)]
names(Scores_Table_Mental_Health)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Mental_Health<- kable(Stats_Table_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Mental_Health, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p8<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Mental_Health, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Mental_Health_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Mental_Health_1[1],":",Entered_Scores_Df$Cutoff_Score_Mental_Health_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Mental_Health_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Mental_Health_2[1],":",Entered_Scores_Df$Cutoff_Score_Mental_Health_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Mental_Health_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Mental_Health_3[1],":",Entered_Scores_Df$Cutoff_Score_Mental_Health_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Mental_Health_1[1],":",Entered_Scores_Df$Cutoff_Score_Mental_Health_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Mental_Health_2[1],":",Entered_Scores_Df$Cutoff_Score_Mental_Health_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Mental_Health_3[1],":",Entered_Scores_Df$Cutoff_Score_Mental_Health_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Mental_Health, ymax=Entered_Scores_Df$CI_Upper_Lim_Mental_Health), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Mental_Health)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Mental_Health)), size = 3, family = "AvantGarde")
  
p8<- p8+labs(x="Date", y = "Mental Health Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p8)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2], "**")
      } else if(Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Mental_Health<- data.frame(Time1, SigChange2_Mental_Health)
      names(Change_Rep_Df2_Mental_Health)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2], "**")
      } else if(Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2])
      }
      
      if(Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange3_Mental_Health<- paste((Rep_Df$Score_Mental_Health[3] - Rep_Df$Score_Mental_Health[1]), "**")
      } else if(Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange3_Mental_Health<- paste((Rep_Df$Score_Mental_Health[3] - Rep_Df$Score_Mental_Health[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Mental_Health<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Mental_Health)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Mental_Health)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Upper_Lim_Mental_Health[2] | Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange3a_Mental_Health<- paste(Rep_Df$Change_Mental_Health[3], "**")
      } else if(Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Upper_Lim_Mental_Health[2] & Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange3a_Mental_Health<- paste(Rep_Df$Change_Mental_Health[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Mental_Health<- data.frame(Time2, SigChange3a_Mental_Health)
      names(Change_Rep_Df3a_Mental_Health)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2], "**")
      } else if(Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2])
      }
      
      if(Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange3_Mental_Health<- paste((Rep_Df$Score_Mental_Health[3] - Rep_Df$Score_Mental_Health[1]), "**")
      } else if(Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange3_Mental_Health<- paste((Rep_Df$Score_Mental_Health[3] - Rep_Df$Score_Mental_Health[1]))
      }
      
      if(Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange4_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[1]), "**")
      } else if(Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange4_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Mental_Health<- data.frame(Time1, SigChange2_Mental_Health, SigChange3_Mental_Health, SigChange4_Mental_Health)
      names(Change_Rep_Df4_Mental_Health)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Mental_Health)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Mental_Health)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Upper_Lim_Mental_Health[2] | Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange4a_Mental_Health<- paste(Rep_Df$Change_Mental_Health[3], "**")
      } else if(Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Upper_Lim_Mental_Health[2] & Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange4a_Mental_Health<- paste(Rep_Df$Change_Mental_Health[3])
      }
      
      if(Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Upper_Lim_Mental_Health[2] | Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange4b_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[2]), "**")
      } else if(Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Upper_Lim_Mental_Health[2] & Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange4b_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Mental_Health<- data.frame(Time2, SigChange4a_Mental_Health, SigChange4b_Mental_Health)
      names(Change_Rep_Df4a_Mental_Health)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Mental_Health)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Upper_Lim_Mental_Health[3] | Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Lower_Lim_Mental_Health[3]) {
        SigChange4c_Mental_Health<- paste(Rep_Df$Change_Mental_Health[4], "**")
      } else if(Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Upper_Lim_Mental_Health[3] & Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Lower_Lim_Mental_Health[3]) {
        SigChange4c_Mental_Health<- paste(Rep_Df$Change_Mental_Health[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Mental_Health<- data.frame(Time3, SigChange4c_Mental_Health)
      names(Change_Rep_Df4b_Mental_Health)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2], "**")
      } else if(Rep_Df$Score_Mental_Health[2] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[2] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange2_Mental_Health<- paste(Rep_Df$Change_Mental_Health[2])
      }
      
      if(Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange3_Mental_Health<- paste((Rep_Df$Score_Mental_Health[3] - Rep_Df$Score_Mental_Health[1]), "**")
      } else if(Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange3_Mental_Health<- paste((Rep_Df$Score_Mental_Health[3] - Rep_Df$Score_Mental_Health[1]))
      }
      
      if(Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange4_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[1]), "**")
      } else if(Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange4_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[1]))
      }
      
      if(Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Upper_Lim_Mental_Health[1] | Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange5_Mental_Health<- paste((Rep_Df$Score_Mental_Health[5] - Rep_Df$Score_Mental_Health[1]), "**")
      } else if(Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Upper_Lim_Mental_Health[1] & Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Lower_Lim_Mental_Health[1]) {
        SigChange5_Mental_Health<- paste((Rep_Df$Score_Mental_Health[5] - Rep_Df$Score_Mental_Health[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Mental_Health<- data.frame(Time1, SigChange2_Mental_Health, SigChange3_Mental_Health, SigChange4_Mental_Health, SigChange5_Mental_Health)
      names(Change_Rep_Df5_Mental_Health)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Mental_Health)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Mental_Health)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Mental_Health)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Upper_Lim_Mental_Health[2] | Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange5a_Mental_Health<- paste(Rep_Df$Change_Mental_Health[3], "**")
      } else if(Rep_Df$Score_Mental_Health[3] < Rep_Df$CI_Upper_Lim_Mental_Health[2] & Rep_Df$Score_Mental_Health[3] > Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange5a_Mental_Health<- paste(Rep_Df$Change_Mental_Health[3])
      }
      
      if(Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Upper_Lim_Mental_Health[2] | Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange5b_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[2]), "**")
      } else if(Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Upper_Lim_Mental_Health[2] & Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange5b_Mental_Health<- paste((Rep_Df$Score_Mental_Health[4] - Rep_Df$Score_Mental_Health[2]))
      }
      
      if(Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Upper_Lim_Mental_Health[2] | Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange5c_Mental_Health<- paste((Rep_Df$Score_Mental_Health[5] - Rep_Df$Score_Mental_Health[2]), "**")
      } else if(Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Upper_Lim_Mental_Health[2] & Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Lower_Lim_Mental_Health[2]) {
        SigChange5c_Mental_Health<- paste((Rep_Df$Score_Mental_Health[5] - Rep_Df$Score_Mental_Health[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Mental_Health<- data.frame(Time2, SigChange5a_Mental_Health, SigChange5b_Mental_Health, SigChange5c_Mental_Health)
      names(Change_Rep_Df5a_Mental_Health)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Mental_Health)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Mental_Health)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Upper_Lim_Mental_Health[3] | Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Lower_Lim_Mental_Health[3]) {
        SigChange5d_Mental_Health<- paste(Rep_Df$Change_Mental_Health[4], "**")
      } else if(Rep_Df$Score_Mental_Health[4] < Rep_Df$CI_Upper_Lim_Mental_Health[3] & Rep_Df$Score_Mental_Health[4] > Rep_Df$CI_Lower_Lim_Mental_Health[3]) {
        SigChange5d_Mental_Health<- paste(Rep_Df$Change_Mental_Health[4])
      }
      
      if(Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Upper_Lim_Mental_Health[3] | Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Lower_Lim_Mental_Health[3]) {
        SigChange5e_Mental_Health<- paste((Rep_Df$Score_Mental_Health[5] - Rep_Df$Score_Mental_Health[3]), "**")
      } else if(Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Upper_Lim_Mental_Health[3] & Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Lower_Lim_Mental_Health[3]) {
        SigChange5e_Mental_Health<- paste((Rep_Df$Score_Mental_Health[5] - Rep_Df$Score_Mental_Health[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Mental_Health<- data.frame(Time3, SigChange5d_Mental_Health, SigChange5e_Mental_Health)
      names(Change_Rep_Df5b_Mental_Health)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Mental_Health)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Upper_Lim_Mental_Health[4] | Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Lower_Lim_Mental_Health[4]) {
        SigChange5f_Mental_Health<- paste(Rep_Df$Change_Mental_Health[5], "**")
      } else if(Rep_Df$Score_Mental_Health[5] < Rep_Df$CI_Upper_Lim_Mental_Health[4] & Rep_Df$Score_Mental_Health[5] > Rep_Df$CI_Lower_Lim_Mental_Health[4]) {
        SigChange5f_Mental_Health<- paste(Rep_Df$Change_Mental_Health[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Mental_Health<- data.frame(Time4, SigChange5f_Mental_Health)
      names(Change_Rep_Df5c_Mental_Health)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Mental_Health, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Coping Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Coping<- Entered_Scores_Df[,c(1,38,39,40,41,42,43)]
names(Scores_Table_Coping)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Coping<- kable(Stats_Table_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Coping, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p9<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Coping, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Coping_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Coping_1[1],":",Entered_Scores_Df$Cutoff_Score_Coping_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Coping_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Coping_2[1],":",Entered_Scores_Df$Cutoff_Score_Coping_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Coping_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Coping_3[1],":",Entered_Scores_Df$Cutoff_Score_Coping_3[1])), color = "#827717", size = 0.4)  + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Coping_1[1],":",Entered_Scores_Df$Cutoff_Score_Coping_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Coping_2[1],":",Entered_Scores_Df$Cutoff_Score_Coping_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Coping_3[1],":",Entered_Scores_Df$Cutoff_Score_Coping_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Coping, ymax=Entered_Scores_Df$CI_Upper_Lim_Coping), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Coping)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Coping)), size = 3, family = "AvantGarde") 
  
p9<- p9+labs(x="Date", y = "Coping Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p9)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Coping[2] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[2] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change_Coping[2], "**")
      } else if(Rep_Df$Score_Coping[2] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[2] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change_Coping[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Coping<- data.frame(Time1, SigChange2_Coping)
      names(Change_Rep_Df2_Coping)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Coping[2] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[2] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change_Coping[2], "**")
      } else if(Rep_Df$Score_Coping[2] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[2] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change_Coping[2])
      }
      
      if(Rep_Df$Score_Coping[3] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[3] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange3_Coping<- paste((Rep_Df$Score_Coping[3] - Rep_Df$Score_Coping[1]), "**")
      } else if(Rep_Df$Score_Coping[3] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[3] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange3_Coping<- paste((Rep_Df$Score_Coping[3] - Rep_Df$Score_Coping[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Coping<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Coping)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Coping)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Coping[3] > Rep_Df$CI_Upper_Lim_Coping[2] | Rep_Df$Score_Coping[3] < Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange3a_Coping<- paste(Rep_Df$Change_Coping[3], "**")
      } else if(Rep_Df$Score_Coping[3] < Rep_Df$CI_Upper_Lim_Coping[2] & Rep_Df$Score_Coping[3] > Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange3a_Coping<- paste(Rep_Df$Change_Coping[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Coping<- data.frame(Time2, SigChange3a_Coping)
      names(Change_Rep_Df3a_Coping)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Coping[2] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[2] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change_Coping[2], "**")
      } else if(Rep_Df$Score_Coping[2] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[2] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change_Coping[2])
      }
      
      if(Rep_Df$Score_Coping[3] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[3] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange3_Coping<- paste((Rep_Df$Score_Coping[3] - Rep_Df$Score_Coping[1]), "**")
      } else if(Rep_Df$Score_Coping[3] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[3] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange3_Coping<- paste((Rep_Df$Score_Coping[3] - Rep_Df$Score_Coping[1]))
      }
      
      if(Rep_Df$Score_Coping[4] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[4] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange4_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[1]), "**")
      } else if(Rep_Df$Score_Coping[4] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[4] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange4_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Coping<- data.frame(Time1, SigChange2_Coping, SigChange3_Coping, SigChange4_Coping)
      names(Change_Rep_Df4_Coping)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Coping)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Coping)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Coping[3] > Rep_Df$CI_Upper_Lim_Coping[2] | Rep_Df$Score_Coping[3] < Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange4a_Coping<- paste(Rep_Df$Change_Coping[3], "**")
      } else if(Rep_Df$Score_Coping[3] < Rep_Df$CI_Upper_Lim_Coping[2] & Rep_Df$Score_Coping[3] > Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange4a_Coping<- paste(Rep_Df$Change_Coping[3])
      }
      
      if(Rep_Df$Score_Coping[4] > Rep_Df$CI_Upper_Lim_Coping[2] | Rep_Df$Score_Coping[4] < Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange4b_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[2]), "**")
      } else if(Rep_Df$Score_Coping[4] < Rep_Df$CI_Upper_Lim_Coping[2] & Rep_Df$Score_Coping[4] > Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange4b_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Coping<- data.frame(Time2, SigChange4a_Coping, SigChange4b_Coping)
      names(Change_Rep_Df4a_Coping)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Coping)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Coping[4] > Rep_Df$CI_Upper_Lim_Coping[3] | Rep_Df$Score_Coping[4] < Rep_Df$CI_Lower_Lim_Coping[3]) {
        SigChange4c_Coping<- paste(Rep_Df$Change_Coping[4], "**")
      } else if(Rep_Df$Score_Coping[4] < Rep_Df$CI_Upper_Lim_Coping[3] & Rep_Df$Score_Coping[4] > Rep_Df$CI_Lower_Lim_Coping[3]) {
        SigChange4c_Coping<- paste(Rep_Df$Change_Coping[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Coping<- data.frame(Time3, SigChange4c_Coping)
      names(Change_Rep_Df4b_Coping)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Coping[2] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[2] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Coping[2] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[2] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange2_Coping<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Coping[3] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[3] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange3_Coping<- paste((Rep_Df$Score_Coping[3] - Rep_Df$Score_Coping[1]), "**")
      } else if(Rep_Df$Score_Coping[3] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[3] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange3_Coping<- paste((Rep_Df$Score_Coping[3] - Rep_Df$Score_Coping[1]))
      }
      
      if(Rep_Df$Score_Coping[4] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[4] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange4_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[1]), "**")
      } else if(Rep_Df$Score_Coping[4] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[4] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange4_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[1]))
      }
      
      if(Rep_Df$Score_Coping[5] > Rep_Df$CI_Upper_Lim_Coping[1] | Rep_Df$Score_Coping[5] < Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange5_Coping<- paste((Rep_Df$Score_Coping[5] - Rep_Df$Score_Coping[1]), "**")
      } else if(Rep_Df$Score_Coping[5] < Rep_Df$CI_Upper_Lim_Coping[1] & Rep_Df$Score_Coping[5] > Rep_Df$CI_Lower_Lim_Coping[1]) {
        SigChange5_Coping<- paste((Rep_Df$Score_Coping[5] - Rep_Df$Score_Coping[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Coping<- data.frame(Time1, SigChange2_Coping, SigChange3_Coping, SigChange4_Coping, SigChange5_Coping)
      names(Change_Rep_Df5_Coping)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Coping)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Coping)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Coping)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Coping[3] > Rep_Df$CI_Upper_Lim_Coping[2] | Rep_Df$Score_Coping[3] < Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange5a_Coping<- paste(Rep_Df$Change_Coping[3], "**")
      } else if(Rep_Df$Score_Coping[3] < Rep_Df$CI_Upper_Lim_Coping[2] & Rep_Df$Score_Coping[3] > Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange5a_Coping<- paste(Rep_Df$Change_Coping[3])
      }
      
      if(Rep_Df$Score_Coping[4] > Rep_Df$CI_Upper_Lim_Coping[2] | Rep_Df$Score_Coping[4] < Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange5b_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[2]), "**")
      } else if(Rep_Df$Score_Coping[4] < Rep_Df$CI_Upper_Lim_Coping[2] & Rep_Df$Score_Coping[4] > Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange5b_Coping<- paste((Rep_Df$Score_Coping[4] - Rep_Df$Score_Coping[2]))
      }
      
      if(Rep_Df$Score_Coping[5] > Rep_Df$CI_Upper_Lim_Coping[2] | Rep_Df$Score_Coping[5] < Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange5c_Coping<- paste((Rep_Df$Score_Coping[5] - Rep_Df$Score_Coping[2]), "**")
      } else if(Rep_Df$Score_Coping[5] < Rep_Df$CI_Upper_Lim_Coping[2] & Rep_Df$Score_Coping[5] > Rep_Df$CI_Lower_Lim_Coping[2]) {
        SigChange5c_Coping<- paste((Rep_Df$Score_Coping[5] - Rep_Df$Score_Coping[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Coping<- data.frame(Time2, SigChange5a_Coping, SigChange5b_Coping, SigChange5c_Coping)
      names(Change_Rep_Df5a_Coping)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Coping)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Coping)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Coping[4] > Rep_Df$CI_Upper_Lim_Coping[3] | Rep_Df$Score_Coping[4] < Rep_Df$CI_Lower_Lim_Coping[3]) {
        SigChange5d_Coping<- paste(Rep_Df$Change_Coping[4], "**")
      } else if(Rep_Df$Score_Coping[4] < Rep_Df$CI_Upper_Lim_Coping[3] & Rep_Df$Score_Coping[4] > Rep_Df$CI_Lower_Lim_Coping[3]) {
        SigChange5d_Coping<- paste(Rep_Df$Change_Coping[4])
      }
      
      if(Rep_Df$Score_Coping[5] > Rep_Df$CI_Upper_Lim_Coping[3] | Rep_Df$Score_Coping[5] < Rep_Df$CI_Lower_Lim_Coping[3]) {
        SigChange5e_Coping<- paste((Rep_Df$Score_Coping[5] - Rep_Df$Score_Coping[3]), "**")
      } else if(Rep_Df$Score_Coping[5] < Rep_Df$CI_Upper_Lim_Coping[3] & Rep_Df$Score_Coping[5] > Rep_Df$CI_Lower_Lim_Coping[3]) {
        SigChange5e_Coping<- paste((Rep_Df$Score_Coping[5] - Rep_Df$Score_Coping[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Coping<- data.frame(Time3, SigChange5d_Coping, SigChange5e_Coping)
      names(Change_Rep_Df5b_Coping)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Coping)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Coping[5] > Rep_Df$CI_Upper_Lim_Coping[4] | Rep_Df$Score_Coping[5] < Rep_Df$CI_Lower_Lim_Coping[4]) {
        SigChange5f_Coping<- paste(Rep_Df$Change_Coping[5], "**")
      } else if(Rep_Df$Score_Coping[5] < Rep_Df$CI_Upper_Lim_Coping[4] & Rep_Df$Score_Coping[5] > Rep_Df$CI_Lower_Lim_Coping[4]) {
        SigChange5f_Coping<- paste(Rep_Df$Change_Coping[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Coping<- data.frame(Time4, SigChange5f_Coping)
      names(Change_Rep_Df5c_Coping)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Coping, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Self Worth Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Self_Worth<- Entered_Scores_Df[,c(1,65,66,67,68,69,70)]
names(Scores_Table_Self_Worth)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Self_Worth<- kable(Stats_Table_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Self_Worth, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p10<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Self_Worth, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Self_Worth_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Self_Worth_1[1],":",Entered_Scores_Df$Cutoff_Score_Self_Worth_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Self_Worth_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Self_Worth_2[1],":",Entered_Scores_Df$Cutoff_Score_Self_Worth_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Self_Worth_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Self_Worth_3[1],":",Entered_Scores_Df$Cutoff_Score_Self_Worth_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Self_Worth_1[1],":",Entered_Scores_Df$Cutoff_Score_Self_Worth_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Self_Worth_2[1],":",Entered_Scores_Df$Cutoff_Score_Self_Worth_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Self_Worth_3[1],":",Entered_Scores_Df$Cutoff_Score_Self_Worth_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Self_Worth, ymax=Entered_Scores_Df$CI_Upper_Lim_Self_Worth), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Self_Worth)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Self_Worth)), size = 3, family = "AvantGarde")
  
p10<- p10+labs(x="Date", y = "Self Worth Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p10)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2], "**")
      } else if(Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Self_Worth<- data.frame(Time1, SigChange2_Self_Worth)
      names(Change_Rep_Df2_Self_Worth)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2], "**")
      } else if(Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2])
      }
      
      if(Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange3_Self_Worth<- paste((Rep_Df$Score_Self_Worth[3] - Rep_Df$Score_Self_Worth[1]), "**")
      } else if(Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange3_Self_Worth<- paste((Rep_Df$Score_Self_Worth[3] - Rep_Df$Score_Self_Worth[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Self_Worth<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Self_Worth)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Self_Worth)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Upper_Lim_Self_Worth[2] | Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange3a_Self_Worth<- paste(Rep_Df$Change_Self_Worth[3], "**")
      } else if(Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Upper_Lim_Self_Worth[2] & Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange3a_Self_Worth<- paste(Rep_Df$Change_Self_Worth[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Self_Worth<- data.frame(Time2, SigChange3a_Self_Worth)
      names(Change_Rep_Df3a_Self_Worth)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2], "**")
      } else if(Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2])
      }
      
      if(Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange3_Self_Worth<- paste((Rep_Df$Score_Self_Worth[3] - Rep_Df$Score_Self_Worth[1]), "**")
      } else if(Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange3_Self_Worth<- paste((Rep_Df$Score_Self_Worth[3] - Rep_Df$Score_Self_Worth[1]))
      }
      
      if(Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange4_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[1]), "**")
      } else if(Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange4_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Self_Worth<- data.frame(Time1, SigChange2_Self_Worth, SigChange3_Self_Worth, SigChange4_Self_Worth)
      names(Change_Rep_Df4_Self_Worth)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Self_Worth)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Self_Worth)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Upper_Lim_Self_Worth[2] | Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange4a_Self_Worth<- paste(Rep_Df$Change_Self_Worth[3], "**")
      } else if(Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Upper_Lim_Self_Worth[2] & Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange4a_Self_Worth<- paste(Rep_Df$Change_Self_Worth[3])
      }
      
      if(Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Upper_Lim_Self_Worth[2] | Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange4b_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[2]), "**")
      } else if(Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Upper_Lim_Self_Worth[2] & Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange4b_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Self_Worth<- data.frame(Time2, SigChange4a_Self_Worth, SigChange4b_Self_Worth)
      names(Change_Rep_Df4a_Self_Worth)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Self_Worth)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Upper_Lim_Self_Worth[3] | Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Lower_Lim_Self_Worth[3]) {
        SigChange4c_Self_Worth<- paste(Rep_Df$Change_Self_Worth[4], "**")
      } else if(Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Upper_Lim_Self_Worth[3] & Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Lower_Lim_Self_Worth[3]) {
        SigChange4c_Self_Worth<- paste(Rep_Df$Change_Self_Worth[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Self_Worth<- data.frame(Time3, SigChange4c_Self_Worth)
      names(Change_Rep_Df4b_Self_Worth)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2], "**")
      } else if(Rep_Df$Score_Self_Worth[2] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[2] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange2_Self_Worth<- paste(Rep_Df$Change_Self_Worth[2])
      }
      
      if(Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange3_Self_Worth<- paste((Rep_Df$Score_Self_Worth[3] - Rep_Df$Score_Self_Worth[1]), "**")
      } else if(Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange3_Self_Worth<- paste((Rep_Df$Score_Self_Worth[3] - Rep_Df$Score_Self_Worth[1]))
      }
      
      if(Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange4_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[1]), "**")
      } else if(Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange4_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[1]))
      }
      
      if(Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Upper_Lim_Self_Worth[1] | Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange5_Self_Worth<- paste((Rep_Df$Score_Self_Worth[5] - Rep_Df$Score_Self_Worth[1]), "**")
      } else if(Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Upper_Lim_Self_Worth[1] & Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Lower_Lim_Self_Worth[1]) {
        SigChange5_Self_Worth<- paste((Rep_Df$Score_Self_Worth[5] - Rep_Df$Score_Self_Worth[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Self_Worth<- data.frame(Time1, SigChange2_Self_Worth, SigChange3_Self_Worth, SigChange4_Self_Worth, SigChange5_Self_Worth)
      names(Change_Rep_Df5_Self_Worth)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Self_Worth)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Self_Worth)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Self_Worth)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Upper_Lim_Self_Worth[2] | Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange5a_Self_Worth<- paste(Rep_Df$Change_Self_Worth[3], "**")
      } else if(Rep_Df$Score_Self_Worth[3] < Rep_Df$CI_Upper_Lim_Self_Worth[2] & Rep_Df$Score_Self_Worth[3] > Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange5a_Self_Worth<- paste(Rep_Df$Change_Self_Worth[3])
      }
      
      if(Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Upper_Lim_Self_Worth[2] | Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange5b_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[2]), "**")
      } else if(Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Upper_Lim_Self_Worth[2] & Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange5b_Self_Worth<- paste((Rep_Df$Score_Self_Worth[4] - Rep_Df$Score_Self_Worth[2]))
      }
      
      if(Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Upper_Lim_Self_Worth[2] | Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange5c_Self_Worth<- paste((Rep_Df$Score_Self_Worth[5] - Rep_Df$Score_Self_Worth[2]), "**")
      } else if(Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Upper_Lim_Self_Worth[2] & Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Lower_Lim_Self_Worth[2]) {
        SigChange5c_Self_Worth<- paste((Rep_Df$Score_Self_Worth[5] - Rep_Df$Score_Self_Worth[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Self_Worth<- data.frame(Time2, SigChange5a_Self_Worth, SigChange5b_Self_Worth, SigChange5c_Self_Worth)
      names(Change_Rep_Df5a_Self_Worth)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Self_Worth)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Self_Worth)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Upper_Lim_Self_Worth[3] | Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Lower_Lim_Self_Worth[3]) {
        SigChange5d_Self_Worth<- paste(Rep_Df$Change_Self_Worth[4], "**")
      } else if(Rep_Df$Score_Self_Worth[4] < Rep_Df$CI_Upper_Lim_Self_Worth[3] & Rep_Df$Score_Self_Worth[4] > Rep_Df$CI_Lower_Lim_Self_Worth[3]) {
        SigChange5d_Self_Worth<- paste(Rep_Df$Change_Self_Worth[4])
      }
      
      if(Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Upper_Lim_Self_Worth[3] | Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Lower_Lim_Self_Worth[3]) {
        SigChange5e_Self_Worth<- paste((Rep_Df$Score_Self_Worth[5] - Rep_Df$Score_Self_Worth[3]), "**")
      } else if(Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Upper_Lim_Self_Worth[3] & Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Lower_Lim_Self_Worth[3]) {
        SigChange5e_Self_Worth<- paste((Rep_Df$Score_Self_Worth[5] - Rep_Df$Score_Self_Worth[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Self_Worth<- data.frame(Time3, SigChange5d_Self_Worth, SigChange5e_Self_Worth)
      names(Change_Rep_Df5b_Self_Worth)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Self_Worth)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Upper_Lim_Self_Worth[4] | Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Lower_Lim_Self_Worth[4]) {
        SigChange5f_Self_Worth<- paste(Rep_Df$Change_Self_Worth[5], "**")
      } else if(Rep_Df$Score_Self_Worth[5] < Rep_Df$CI_Upper_Lim_Self_Worth[4] & Rep_Df$Score_Self_Worth[5] > Rep_Df$CI_Lower_Lim_Self_Worth[4]) {
        SigChange5f_Self_Worth<- paste(Rep_Df$Change_Self_Worth[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Self_Worth<- data.frame(Time4, SigChange5f_Self_Worth)
      names(Change_Rep_Df5c_Self_Worth)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Self_Worth, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage


#Happiness Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Happiness<- Entered_Scores_Df[,c(1,74,75,76,77,78,79)]
names(Scores_Table_Happiness)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Happiness<- kable(Stats_Table_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Happiness, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Richardson & Iezzi (2011)")), notation = "number")
```

##Trend (Standardised Scores)

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=9}

 p11<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Happiness, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Happiness_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Happiness_1[1],":",Entered_Scores_Df$Cutoff_Score_Happiness_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Happiness_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Happiness_2[1],":",Entered_Scores_Df$Cutoff_Score_Happiness_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Happiness_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Happiness_3[1],":",Entered_Scores_Df$Cutoff_Score_Happiness_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Happiness_1[1],":",Entered_Scores_Df$Cutoff_Score_Happiness_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Happiness_2[1],":",Entered_Scores_Df$Cutoff_Score_Happiness_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Happiness_3[1],":",Entered_Scores_Df$Cutoff_Score_Happiness_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Happiness, ymax=Entered_Scores_Df$CI_Upper_Lim_Happiness), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Happiness)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Happiness)), size = 3, family = "AvantGarde")
  
p11<- p11+labs(x="Date", y = "Happiness Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-20, 120), breaks = c(0,20,40,60,80,100), labels = c('0 Min','20','40','60','80','100')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p11)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Happiness[2] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[2] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2], "**")
      } else if(Rep_Df$Score_Happiness[2] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[2] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Happiness<- data.frame(Time1, SigChange2_Happiness)
      names(Change_Rep_Df2_Happiness)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Happiness[2] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[2] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2], "**")
      } else if(Rep_Df$Score_Happiness[2] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[2] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2])
      }
      
      if(Rep_Df$Score_Happiness[3] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[3] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange3_Happiness<- paste((Rep_Df$Score_Happiness[3] - Rep_Df$Score_Happiness[1]), "**")
      } else if(Rep_Df$Score_Happiness[3] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[3] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange3_Happiness<- paste((Rep_Df$Score_Happiness[3] - Rep_Df$Score_Happiness[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Happiness<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Happiness)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Happiness)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Happiness[3] > Rep_Df$CI_Upper_Lim_Happiness[2] | Rep_Df$Score_Happiness[3] < Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange3a_Happiness<- paste(Rep_Df$Change_Happiness[3], "**")
      } else if(Rep_Df$Score_Happiness[3] < Rep_Df$CI_Upper_Lim_Happiness[2] & Rep_Df$Score_Happiness[3] > Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange3a_Happiness<- paste(Rep_Df$Change_Happiness[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Happiness<- data.frame(Time2, SigChange3a_Happiness)
      names(Change_Rep_Df3a_Happiness)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Happiness[2] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[2] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2], "**")
      } else if(Rep_Df$Score_Happiness[2] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[2] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2])
      }
      
      if(Rep_Df$Score_Happiness[3] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[3] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange3_Happiness<- paste((Rep_Df$Score_Happiness[3] - Rep_Df$Score_Happiness[1]), "**")
      } else if(Rep_Df$Score_Happiness[3] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[3] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange3_Happiness<- paste((Rep_Df$Score_Happiness[3] - Rep_Df$Score_Happiness[1]))
      }
      
      if(Rep_Df$Score_Happiness[4] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[4] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange4_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[1]), "**")
      } else if(Rep_Df$Score_Happiness[4] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[4] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange4_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Happiness<- data.frame(Time1, SigChange2_Happiness, SigChange3_Happiness, SigChange4_Happiness)
      names(Change_Rep_Df4_Happiness)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Happiness)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Happiness)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Happiness[3] > Rep_Df$CI_Upper_Lim_Happiness[2] | Rep_Df$Score_Happiness[3] < Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange4a_Happiness<- paste(Rep_Df$Change_Happiness[3], "**")
      } else if(Rep_Df$Score_Happiness[3] < Rep_Df$CI_Upper_Lim_Happiness[2] & Rep_Df$Score_Happiness[3] > Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange4a_Happiness<- paste(Rep_Df$Change_Happiness[3])
      }
      
      if(Rep_Df$Score_Happiness[4] > Rep_Df$CI_Upper_Lim_Happiness[2] | Rep_Df$Score_Happiness[4] < Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange4b_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[2]), "**")
      } else if(Rep_Df$Score_Happiness[4] < Rep_Df$CI_Upper_Lim_Happiness[2] & Rep_Df$Score_Happiness[4] > Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange4b_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Happiness<- data.frame(Time2, SigChange4a_Happiness, SigChange4b_Happiness)
      names(Change_Rep_Df4a_Happiness)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Happiness)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Happiness[4] > Rep_Df$CI_Upper_Lim_Happiness[3] | Rep_Df$Score_Happiness[4] < Rep_Df$CI_Lower_Lim_Happiness[3]) {
        SigChange4c_Happiness<- paste(Rep_Df$Change_Happiness[4], "**")
      } else if(Rep_Df$Score_Happiness[4] < Rep_Df$CI_Upper_Lim_Happiness[3] & Rep_Df$Score_Happiness[4] > Rep_Df$CI_Lower_Lim_Happiness[3]) {
        SigChange4c_Happiness<- paste(Rep_Df$Change_Happiness[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Happiness<- data.frame(Time3, SigChange4c_Happiness)
      names(Change_Rep_Df4b_Happiness)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Happiness[2] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[2] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2], "**")
      } else if(Rep_Df$Score_Happiness[2] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[2] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange2_Happiness<- paste(Rep_Df$Change_Happiness[2])
      }
      
      if(Rep_Df$Score_Happiness[3] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[3] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange3_Happiness<- paste((Rep_Df$Score_Happiness[3] - Rep_Df$Score_Happiness[1]), "**")
      } else if(Rep_Df$Score_Happiness[3] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[3] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange3_Happiness<- paste((Rep_Df$Score_Happiness[3] - Rep_Df$Score_Happiness[1]))
      }
      
      if(Rep_Df$Score_Happiness[4] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[4] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange4_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[1]), "**")
      } else if(Rep_Df$Score_Happiness[4] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[4] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange4_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[1]))
      }
      
      if(Rep_Df$Score_Happiness[5] > Rep_Df$CI_Upper_Lim_Happiness[1] | Rep_Df$Score_Happiness[5] < Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange5_Happiness<- paste((Rep_Df$Score_Happiness[5] - Rep_Df$Score_Happiness[1]), "**")
      } else if(Rep_Df$Score_Happiness[5] < Rep_Df$CI_Upper_Lim_Happiness[1] & Rep_Df$Score_Happiness[5] > Rep_Df$CI_Lower_Lim_Happiness[1]) {
        SigChange5_Happiness<- paste((Rep_Df$Score_Happiness[5] - Rep_Df$Score_Happiness[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Happiness<- data.frame(Time1, SigChange2_Happiness, SigChange3_Happiness, SigChange4_Happiness, SigChange5_Happiness)
      names(Change_Rep_Df5_Happiness)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Happiness)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Happiness)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Happiness)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Happiness[3] > Rep_Df$CI_Upper_Lim_Happiness[2] | Rep_Df$Score_Happiness[3] < Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange5a_Happiness<- paste(Rep_Df$Change_Happiness[3], "**")
      } else if(Rep_Df$Score_Happiness[3] < Rep_Df$CI_Upper_Lim_Happiness[2] & Rep_Df$Score_Happiness[3] > Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange5a_Happiness<- paste(Rep_Df$Change_Happiness[3])
      }
      
      if(Rep_Df$Score_Happiness[4] > Rep_Df$CI_Upper_Lim_Happiness[2] | Rep_Df$Score_Happiness[4] < Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange5b_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[2]), "**")
      } else if(Rep_Df$Score_Happiness[4] < Rep_Df$CI_Upper_Lim_Happiness[2] & Rep_Df$Score_Happiness[4] > Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange5b_Happiness<- paste((Rep_Df$Score_Happiness[4] - Rep_Df$Score_Happiness[2]))
      }
      
      if(Rep_Df$Score_Happiness[5] > Rep_Df$CI_Upper_Lim_Happiness[2] | Rep_Df$Score_Happiness[5] < Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange5c_Happiness<- paste((Rep_Df$Score_Happiness[5] - Rep_Df$Score_Happiness[2]), "**")
      } else if(Rep_Df$Score_Happiness[5] < Rep_Df$CI_Upper_Lim_Happiness[2] & Rep_Df$Score_Happiness[5] > Rep_Df$CI_Lower_Lim_Happiness[2]) {
        SigChange5c_Happiness<- paste((Rep_Df$Score_Happiness[5] - Rep_Df$Score_Happiness[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Happiness<- data.frame(Time2, SigChange5a_Happiness, SigChange5b_Happiness, SigChange5c_Happiness)
      names(Change_Rep_Df5a_Happiness)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Happiness)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Happiness)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Happiness[4] > Rep_Df$CI_Upper_Lim_Happiness[3] | Rep_Df$Score_Happiness[4] < Rep_Df$CI_Lower_Lim_Happiness[3]) {
        SigChange5d_Happiness<- paste(Rep_Df$Change_Happiness[4], "**")
      } else if(Rep_Df$Score_Happiness[4] < Rep_Df$CI_Upper_Lim_Happiness[3] & Rep_Df$Score_Happiness[4] > Rep_Df$CI_Lower_Lim_Happiness[3]) {
        SigChange5d_Happiness<- paste(Rep_Df$Change_Happiness[4])
      }
      
      if(Rep_Df$Score_Happiness[5] > Rep_Df$CI_Upper_Lim_Happiness[3] | Rep_Df$Score_Happiness[5] < Rep_Df$CI_Lower_Lim_Happiness[3]) {
        SigChange5e_Happiness<- paste((Rep_Df$Score_Happiness[5] - Rep_Df$Score_Happiness[3]), "**")
      } else if(Rep_Df$Score_Happiness[5] < Rep_Df$CI_Upper_Lim_Happiness[3] & Rep_Df$Score_Happiness[5] > Rep_Df$CI_Lower_Lim_Happiness[3]) {
        SigChange5e_Happiness<- paste((Rep_Df$Score_Happiness[5] - Rep_Df$Score_Happiness[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Happiness<- data.frame(Time3, SigChange5d_Happiness, SigChange5e_Happiness)
      names(Change_Rep_Df5b_Happiness)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Happiness)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Happiness[5] > Rep_Df$CI_Upper_Lim_Happiness[4] | Rep_Df$Score_Happiness[5] < Rep_Df$CI_Lower_Lim_Happiness[4]) {
        SigChange5f_Happiness<- paste(Rep_Df$Change_Happiness[5], "**")
      } else if(Rep_Df$Score_Happiness[5] < Rep_Df$CI_Upper_Lim_Happiness[4] & Rep_Df$Score_Happiness[5] > Rep_Df$CI_Lower_Lim_Happiness[4]) {
        SigChange5f_Happiness<- paste(Rep_Df$Change_Happiness[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Happiness<- data.frame(Time4, SigChange5f_Happiness)
      names(Change_Rep_Df5c_Happiness)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Happiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

###Most Recent Item Scores

#####`r Scores_Table[nrow(Scores_Table),1]`

```{r,echo=FALSE,warning=FALSE,comment=NA}

kable(Item_Df, format = "latex", booktabs = T) %>% kable_styling(position = "left", full_width = T, font_size = 13, latex_options = "striped") %>% row_spec(0, bold = T)
```

\newpage

\begingroup\Large

\begin{center} \textbf{Information About the Assessment of Quality of Life - 8 Dimensions (AQoL-8D)} \end{center} 

#What it Measures: 

* Health-related quality of life across the psychosocial domain (including mental health, happiness, coping, relationships & self worth) 
and the physical domain (including independent living, pain and functioning of the senses).


#What Higher Scores Mean:

* Greater quality of life. This applies to all subscales, dimensions and the total scale score. For exmample, a higher
score on the Pain subscale indicates **greater** quality of life in terms of pain frequency, intensity and interference
in daily activities.

#Scale Quality:

* The AQOL-8D was developed by a team at Monash University in Australia. It is intended to rectify the psychometric limitations of
existing measures that are widely used, including the EQ5D, 15D, HUI 3 and SF-6D. Research has suggested that the AQOL-8D has strong 
psychometric properties (Richardson & Iezzi, 2011). 


#Scale Structure & Scoring:

* A total quality of life score is calculated using all 35 items. 

* A **Mental Super Dimension** score reflects the respondent's responses across the subscales of **Mental Health**, **Happiness**,
**Coping**, **Relationships** and **Self-Worth**. 

* A **Physical Super Dimension** score reflects the respondent's responses across the subscales of **Independent Living**, **Pain** and
**Senses**. 

* Subscale scores can be used to assess specific facets of quality of life and inlude the 8 subscales listed above in bold.

* All scores appearing in the PDF report have been standardised and have a range of 0-100, with higher standardised scores indicating
greater quality of life. For more information about standardisation scoring, visit the scale authors' website (www.aqol.com.au).  

\endgroup