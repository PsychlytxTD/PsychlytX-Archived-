---
title: "Eating Disorder Examination Questionnaire (EDE-Q)"
author: "Report generated by PsychlytX"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
PN: 'NULL' 
CN: 'NULL'
Tab_Reference: 'NULL'
Binge_Info: 'NULL'
Basic_Info: 'NULL'
Stats_Table_Fullscale: 'NULL'
Stats_Table_Restraint: 'NULL'
Stats_Table_Eating_Concern: 'NULL'
Stats_Table_Shape_Concern: 'NULL'
Stats_Table_Weight_Concern: 'NULL'
Entered_Scores_Df: 'NULL'
Cutoff_Names: 'NULL'
Item_Df: 'NULL'
subtitle: '**Patient:** `r PN` **|** **Clinician:** `r CN`'
---

```{r,echo = FALSE,warning=FALSE,comment = NA}
knitr::opts_chunk$set(fig.width=7,fig.height=3) 

```

#EDE-Q Total Scale

##Response Summary

```{r,echo=FALSE,warning=FALSE,comment=NA}
Scores_Table<- Entered_Scores_Df[,c(1,2,3,4,5,6,7)]
names(Scores_Table)<- c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```


##Data Employed in Reliable Change Analyses

```{r,echo=FALSE,warning=FALSE,comment=NA}

Stats_Table_Fullscale<- kable(Stats_Table_Fullscale, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Fullscale, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Rose et al. (2013)")), notation = "number")
```


##Trend

```{r,echo=FALSE,warning=FALSE,comment=FALSE,message=FALSE, fig.width=8}
 p1<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_4[1], linetype = paste(Cutoff_Names$Cutoff_Name_4[1],":",Entered_Scores_Df$Cutoff_Score_4[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_5[1], linetype = paste(Cutoff_Names$Cutoff_Name_5[1],":",Entered_Scores_Df$Cutoff_Score_5[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("ff","8f","1f","11","solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1]),
          paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1]),
          paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1]),
           paste(Cutoff_Names$Cutoff_Name_4[1],":",Entered_Scores_Df$Cutoff_Score_4[1]),
           paste(Cutoff_Names$Cutoff_Name_5[1],":",Entered_Scores_Df$Cutoff_Score_5[1])
          )) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim, ymax=Entered_Scores_Df$CI_Upper_Lim), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde", face = "bold") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score)), size = 3, family = "AvantGarde", face = "bold") 
                        
p1<- p1+labs(x="Date", y = "Total EDE-Q Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-2, 6), breaks = c(0,1,2,3,4), labels = c('0 Min','1','2','3','4 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde"))
print(p1) 
```

##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by ** 
```{r, echo = FALSE, warning = FALSE,comment=NA, message=FALSE}

if(length(Entered_Scores_Df$Date) == 2) {  

Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2<- data.frame(Time1, SigChange2)
      names(Change_Rep_Df2)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a<- data.frame(Time2, SigChange3a)
      names(Change_Rep_Df3a)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4<- data.frame(Time1, SigChange2, SigChange3, SigChange4)
      names(Change_Rep_Df4)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a<- data.frame(Time2, SigChange4a, SigChange4b)
      names(Change_Rep_Df4a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b<- data.frame(Time3, SigChange4c)
      names(Change_Rep_Df4b)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE, comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5<- data.frame(Time1, SigChange2, SigChange3, SigChange4, SigChange5)
      names(Change_Rep_Df5)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a<- data.frame(Time2, SigChange5a, SigChange5b, SigChange5c)
      names(Change_Rep_Df5a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4])
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b<- data.frame(Time3, SigChange5d, SigChange5e)
      names(Change_Rep_Df5b)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[4] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5], "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[4] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c<- data.frame(Time4, SigChange5f)
      names(Change_Rep_Df5c)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Restraint Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Restraint<- Entered_Scores_Df[,c(1,13,14,15,16,17,18)]
names(Scores_Table_Restraint)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Restraint<- kable(Stats_Table_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Restraint, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Rose et al. (2013)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p2<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Restraint, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Restraint_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Restraint_1[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Restraint_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Restraint_2[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Restraint_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Restraint_3[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_3[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Restraint_4[1], linetype = paste(Cutoff_Names$Cutoff_Name_Restraint_4[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_4[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Restraint_5[1], linetype = paste(Cutoff_Names$Cutoff_Name_Restraint_5[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_5[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("ff","8f","1f","11","solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Restraint_1[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Restraint_2[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Restraint_3[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_3[1]),
paste(Cutoff_Names$Cutoff_Name_Restraint_4[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_4[1]),
paste(Cutoff_Names$Cutoff_Name_Restraint_5[1],":",Entered_Scores_Df$Cutoff_Score_Restraint_5[1])
           )) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Restraint, ymax=Entered_Scores_Df$CI_Upper_Lim_Restraint), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change_Restraint)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Restraint)), size = 3, family = "AvantGarde") 
  
p2<- p2+labs(x="Date", y = "Restraint Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-2, 7), breaks = c(0,1,2,3,4,5), labels = c('0 Min','1','2','3','4','5 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p2)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Restraint[2] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[2] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2], "**")
      } else if(Rep_Df$Score_Restraint[2] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[2] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Restraint<- data.frame(Time1, SigChange2_Restraint)
      names(Change_Rep_Df2_Restraint)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Restraint[2] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[2] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2], "**")
      } else if(Rep_Df$Score_Restraint[2] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[2] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2])
      }
      
      if(Rep_Df$Score_Restraint[3] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[3] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange3_Restraint<- paste((Rep_Df$Score_Restraint[3] - Rep_Df$Score_Restraint[1]), "**")
      } else if(Rep_Df$Score_Restraint[3] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[3] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange3_Restraint<- paste((Rep_Df$Score_Restraint[3] - Rep_Df$Score_Restraint[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Restraint<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Restraint)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Restraint)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Restraint[3] > Rep_Df$CI_Upper_Lim_Restraint[2] | Rep_Df$Score_Restraint[3] < Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange3a_Restraint<- paste(Rep_Df$Change_Restraint[3], "**")
      } else if(Rep_Df$Score_Restraint[3] < Rep_Df$CI_Upper_Lim_Restraint[2] & Rep_Df$Score_Restraint[3] > Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange3a_Restraint<- paste(Rep_Df$Change_Restraint[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Restraint<- data.frame(Time2, SigChange3a_Restraint)
      names(Change_Rep_Df3a_Restraint)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Restraint[2] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[2] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2], "**")
      } else if(Rep_Df$Score_Restraint[2] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[2] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2])
      }
      
      if(Rep_Df$Score_Restraint[3] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[3] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange3_Restraint<- paste((Rep_Df$Score_Restraint[3] - Rep_Df$Score_Restraint[1]), "**")
      } else if(Rep_Df$Score_Restraint[3] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[3] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange3_Restraint<- paste((Rep_Df$Score_Restraint[3] - Rep_Df$Score_Restraint[1]))
      }
      
      if(Rep_Df$Score_Restraint[4] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[4] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange4_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[1]), "**")
      } else if(Rep_Df$Score_Restraint[4] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[4] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange4_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Restraint<- data.frame(Time1, SigChange2_Restraint, SigChange3_Restraint, SigChange4_Restraint)
      names(Change_Rep_Df4_Restraint)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Restraint)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Restraint)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Restraint[3] > Rep_Df$CI_Upper_Lim_Restraint[2] | Rep_Df$Score_Restraint[3] < Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange4a_Restraint<- paste(Rep_Df$Change_Restraint[3], "**")
      } else if(Rep_Df$Score_Restraint[3] < Rep_Df$CI_Upper_Lim_Restraint[2] & Rep_Df$Score_Restraint[3] > Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange4a_Restraint<- paste(Rep_Df$Change_Restraint[3])
      }
      
      if(Rep_Df$Score_Restraint[4] > Rep_Df$CI_Upper_Lim_Restraint[2] | Rep_Df$Score_Restraint[4] < Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange4b_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[2]), "**")
      } else if(Rep_Df$Score_Restraint[4] < Rep_Df$CI_Upper_Lim_Restraint[2] & Rep_Df$Score_Restraint[4] > Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange4b_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Restraint<- data.frame(Time2, SigChange4a_Restraint, SigChange4b_Restraint)
      names(Change_Rep_Df4a_Restraint)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Restraint)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Restraint[4] > Rep_Df$CI_Upper_Lim_Restraint[3] | Rep_Df$Score_Restraint[4] < Rep_Df$CI_Lower_Lim_Restraint[3]) {
        SigChange4c_Restraint<- paste(Rep_Df$Change_Restraint[4], "**")
      } else if(Rep_Df$Score_Restraint[4] < Rep_Df$CI_Upper_Lim_Restraint[3] & Rep_Df$Score_Restraint[4] > Rep_Df$CI_Lower_Lim_Restraint[3]) {
        SigChange4c_Restraint<- paste(Rep_Df$Change_Restraint[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Restraint<- data.frame(Time3, SigChange4c_Restraint)
      names(Change_Rep_Df4b_Restraint)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Restraint[2] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[2] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2], "**")
      } else if(Rep_Df$Score_Restraint[2] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[2] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange2_Restraint<- paste(Rep_Df$Change_Restraint[2])
      }
      
      if(Rep_Df$Score_Restraint[3] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[3] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange3_Restraint<- paste((Rep_Df$Score_Restraint[3] - Rep_Df$Score_Restraint[1]), "**")
      } else if(Rep_Df$Score_Restraint[3] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[3] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange3_Restraint<- paste((Rep_Df$Score_Restraint[3] - Rep_Df$Score_Restraint[1]))
      }
      
      if(Rep_Df$Score_Restraint[4] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[4] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange4_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[1]), "**")
      } else if(Rep_Df$Score_Restraint[4] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[4] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange4_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[1]))
      }
      
      if(Rep_Df$Score_Restraint[5] > Rep_Df$CI_Upper_Lim_Restraint[1] | Rep_Df$Score_Restraint[5] < Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange5_Restraint<- paste((Rep_Df$Score_Restraint[5] - Rep_Df$Score_Restraint[1]), "**")
      } else if(Rep_Df$Score_Restraint[5] < Rep_Df$CI_Upper_Lim_Restraint[1] & Rep_Df$Score_Restraint[5] > Rep_Df$CI_Lower_Lim_Restraint[1]) {
        SigChange5_Restraint<- paste((Rep_Df$Score_Restraint[5] - Rep_Df$Score_Restraint[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Restraint<- data.frame(Time1, SigChange2_Restraint, SigChange3_Restraint, SigChange4_Restraint, SigChange5_Restraint)
      names(Change_Rep_Df5_Restraint)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Restraint)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Restraint)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Restraint)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Restraint[3] > Rep_Df$CI_Upper_Lim_Restraint[2] | Rep_Df$Score_Restraint[3] < Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange5a_Restraint<- paste(Rep_Df$Change_Restraint[3], "**")
      } else if(Rep_Df$Score_Restraint[3] < Rep_Df$CI_Upper_Lim_Restraint[2] & Rep_Df$Score_Restraint[3] > Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange5a_Restraint<- paste(Rep_Df$Change_Restraint[3])
      }
      
      if(Rep_Df$Score_Restraint[4] > Rep_Df$CI_Upper_Lim_Restraint[2] | Rep_Df$Score_Restraint[4] < Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange5b_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[2]), "**")
      } else if(Rep_Df$Score_Restraint[4] < Rep_Df$CI_Upper_Lim_Restraint[2] & Rep_Df$Score_Restraint[4] > Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange5b_Restraint<- paste((Rep_Df$Score_Restraint[4] - Rep_Df$Score_Restraint[2]))
      }
      
      if(Rep_Df$Score_Restraint[5] > Rep_Df$CI_Upper_Lim_Restraint[2] | Rep_Df$Score_Restraint[5] < Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange5c_Restraint<- paste((Rep_Df$Score_Restraint[5] - Rep_Df$Score_Restraint[2]), "**")
      } else if(Rep_Df$Score_Restraint[5] < Rep_Df$CI_Upper_Lim_Restraint[2] & Rep_Df$Score_Restraint[5] > Rep_Df$CI_Lower_Lim_Restraint[2]) {
        SigChange5c_Restraint<- paste((Rep_Df$Score_Restraint[5] - Rep_Df$Score_Restraint[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Restraint<- data.frame(Time2, SigChange5a_Restraint, SigChange5b_Restraint, SigChange5c_Restraint)
      names(Change_Rep_Df5a_Restraint)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Restraint)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Restraint)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Restraint[4] > Rep_Df$CI_Upper_Lim_Restraint[3] | Rep_Df$Score_Restraint[4] < Rep_Df$CI_Lower_Lim_Restraint[3]) {
        SigChange5d_Restraint<- paste(Rep_Df$Change_Restraint[4], "**")
      } else if(Rep_Df$Score_Restraint[4] < Rep_Df$CI_Upper_Lim_Restraint[3] & Rep_Df$Score_Restraint[4] > Rep_Df$CI_Lower_Lim_Restraint[3]) {
        SigChange5d_Restraint<- paste(Rep_Df$Change_Restraint[4])
      }
      
      if(Rep_Df$Score_Restraint[5] > Rep_Df$CI_Upper_Lim_Restraint[3] | Rep_Df$Score_Restraint[5] < Rep_Df$CI_Lower_Lim_Restraint[3]) {
        SigChange5e_Restraint<- paste((Rep_Df$Score_Restraint[5] - Rep_Df$Score_Restraint[3]), "**")
      } else if(Rep_Df$Score_Restraint[5] < Rep_Df$CI_Upper_Lim_Restraint[3] & Rep_Df$Score_Restraint[5] > Rep_Df$CI_Lower_Lim_Restraint[3]) {
        SigChange5e_Restraint<- paste((Rep_Df$Score_Restraint[5] - Rep_Df$Score_Restraint[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Restraint<- data.frame(Time3, SigChange5d_Restraint, SigChange5e_Restraint)
      names(Change_Rep_Df5b_Restraint)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Restraint)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Restraint[5] > Rep_Df$CI_Upper_Lim_Restraint[4] | Rep_Df$Score_Restraint[5] < Rep_Df$CI_Lower_Lim_Restraint[4]) {
        SigChange5f_Restraint<- paste(Rep_Df$Change_Restraint[5], "**")
      } else if(Rep_Df$Score_Restraint[5] < Rep_Df$CI_Upper_Lim_Restraint[4] & Rep_Df$Score_Restraint[5] > Rep_Df$CI_Lower_Lim_Restraint[4]) {
        SigChange5f_Restraint<- paste(Rep_Df$Change_Restraint[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Restraint<- data.frame(Time4, SigChange5f_Restraint)
      names(Change_Rep_Df5c_Restraint)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Restraint, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Eating Concern Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Eating_Concern<- Entered_Scores_Df[,c(1,24,25,26,27,28,29)]
names(Scores_Table_Eating_Concern)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Eating_Concern<- kable(Stats_Table_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Eating_Concern, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Rose et al. (2013)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p3<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Eating_Concern, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Eating_Concern_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Eating_Concern_1[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Eating_Concern_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Eating_Concern_2[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Eating_Concern_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Eating_Concern_3[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_3[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Eating_Concern_4[1], linetype = paste(Cutoff_Names$Cutoff_Name_Eating_Concern_4[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_4[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Eating_Concern_5[1], linetype = paste(Cutoff_Names$Cutoff_Name_Eating_Concern_5[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_5[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("ff","8f","1f","11","solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Eating_Concern_1[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Eating_Concern_2[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Eating_Concern_3[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_3[1]),
paste(Cutoff_Names$Cutoff_Name_Eating_Concern_4[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_4[1]),
paste(Cutoff_Names$Cutoff_Name_Eating_Concern_5[1],":",Entered_Scores_Df$Cutoff_Score_Eating_Concern_5[1])
)) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Eating_Concern, ymax=Entered_Scores_Df$CI_Upper_Lim_Eating_Concern), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change_Eating_Concern)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Eating_Concern)), size = 3, family = "AvantGarde") 
  
p3<- p3+labs(x="Date", y = "Eating Concern Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-2, 7), breaks = c(0,1,2,3,4,5), labels = c('0 Min','1','2','3','4','5 Max'))  + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p3)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[2], "**")
      } else if(Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Eating_Concern<- data.frame(Time1, SigChange2_Eating_Concern)
      names(Change_Rep_Df2_Eating_Concern)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[2], "**")
      } else if(Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[2])
      }
      
      if(Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange3_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[3] - Rep_Df$Score_Eating_Concern[1]), "**")
      } else if(Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange3_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[3] - Rep_Df$Score_Eating_Concern[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Eating_Concern<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Eating_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Eating_Concern)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Upper_Lim_Eating_Concern[2] | Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange3a_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[3], "**")
      } else if(Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Upper_Lim_Eating_Concern[2] & Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange3a_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Eating_Concern<- data.frame(Time2, SigChange3a_Eating_Concern)
      names(Change_Rep_Df3a_Eating_Concern)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[2], "**")
      } else if(Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[2])
      }
      
      if(Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange3_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[3] - Rep_Df$Score_Eating_Concern[1]), "**")
      } else if(Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange3_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[3] - Rep_Df$Score_Eating_Concern[1]))
      }
      
      if(Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange4_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[1]), "**")
      } else if(Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange4_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Eating_Concern<- data.frame(Time1, SigChange2_Eating_Concern, SigChange3_Eating_Concern, SigChange4_Eating_Concern)
      names(Change_Rep_Df4_Eating_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Eating_Concern)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Eating_Concern)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Upper_Lim_Eating_Concern[2] | Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange4a_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[3], "**")
      } else if(Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Upper_Lim_Eating_Concern[2] & Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange4a_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[3])
      }
      
      if(Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Upper_Lim_Eating_Concern[2] | Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange4b_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[2]), "**")
      } else if(Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Upper_Lim_Eating_Concern[2] & Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange4b_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Eating_Concern<- data.frame(Time2, SigChange4a_Eating_Concern, SigChange4b_Eating_Concern)
      names(Change_Rep_Df4a_Eating_Concern)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Eating_Concern)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Upper_Lim_Eating_Concern[3] | Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Lower_Lim_Eating_Concern[3]) {
        SigChange4c_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[4], "**")
      } else if(Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Upper_Lim_Eating_Concern[3] & Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Lower_Lim_Eating_Concern[3]) {
        SigChange4c_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Eating_Concern<- data.frame(Time3, SigChange4c_Eating_Concern)
      names(Change_Rep_Df4b_Eating_Concern)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Eating_Concern[2] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[2] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange2_Eating_Concern<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange3_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[3] - Rep_Df$Score_Eating_Concern[1]), "**")
      } else if(Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange3_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[3] - Rep_Df$Score_Eating_Concern[1]))
      }
      
      if(Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange4_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[1]), "**")
      } else if(Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange4_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[1]))
      }
      
      if(Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Upper_Lim_Eating_Concern[1] | Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange5_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[5] - Rep_Df$Score_Eating_Concern[1]), "**")
      } else if(Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Upper_Lim_Eating_Concern[1] & Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Lower_Lim_Eating_Concern[1]) {
        SigChange5_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[5] - Rep_Df$Score_Eating_Concern[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Eating_Concern<- data.frame(Time1, SigChange2_Eating_Concern, SigChange3_Eating_Concern, SigChange4_Eating_Concern, SigChange5_Eating_Concern)
      names(Change_Rep_Df5_Eating_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Eating_Concern)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Eating_Concern)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Eating_Concern)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Upper_Lim_Eating_Concern[2] | Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange5a_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[3], "**")
      } else if(Rep_Df$Score_Eating_Concern[3] < Rep_Df$CI_Upper_Lim_Eating_Concern[2] & Rep_Df$Score_Eating_Concern[3] > Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange5a_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[3])
      }
      
      if(Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Upper_Lim_Eating_Concern[2] | Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange5b_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[2]), "**")
      } else if(Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Upper_Lim_Eating_Concern[2] & Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange5b_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[4] - Rep_Df$Score_Eating_Concern[2]))
      }
      
      if(Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Upper_Lim_Eating_Concern[2] | Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange5c_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[5] - Rep_Df$Score_Eating_Concern[2]), "**")
      } else if(Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Upper_Lim_Eating_Concern[2] & Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Lower_Lim_Eating_Concern[2]) {
        SigChange5c_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[5] - Rep_Df$Score_Eating_Concern[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Eating_Concern<- data.frame(Time2, SigChange5a_Eating_Concern, SigChange5b_Eating_Concern, SigChange5c_Eating_Concern)
      names(Change_Rep_Df5a_Eating_Concern)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Eating_Concern)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Eating_Concern)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Upper_Lim_Eating_Concern[3] | Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Lower_Lim_Eating_Concern[3]) {
        SigChange5d_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[4], "**")
      } else if(Rep_Df$Score_Eating_Concern[4] < Rep_Df$CI_Upper_Lim_Eating_Concern[3] & Rep_Df$Score_Eating_Concern[4] > Rep_Df$CI_Lower_Lim_Eating_Concern[3]) {
        SigChange5d_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[4])
      }
      
      if(Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Upper_Lim_Eating_Concern[3] | Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Lower_Lim_Eating_Concern[3]) {
        SigChange5e_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[5] - Rep_Df$Score_Eating_Concern[3]), "**")
      } else if(Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Upper_Lim_Eating_Concern[3] & Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Lower_Lim_Eating_Concern[3]) {
        SigChange5e_Eating_Concern<- paste((Rep_Df$Score_Eating_Concern[5] - Rep_Df$Score_Eating_Concern[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Eating_Concern<- data.frame(Time3, SigChange5d_Eating_Concern, SigChange5e_Eating_Concern)
      names(Change_Rep_Df5b_Eating_Concern)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Eating_Concern)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Upper_Lim_Eating_Concern[4] | Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Lower_Lim_Eating_Concern[4]) {
        SigChange5f_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[5], "**")
      } else if(Rep_Df$Score_Eating_Concern[5] < Rep_Df$CI_Upper_Lim_Eating_Concern[4] & Rep_Df$Score_Eating_Concern[5] > Rep_Df$CI_Lower_Lim_Eating_Concern[4]) {
        SigChange5f_Eating_Concern<- paste(Rep_Df$Change_Eating_Concern[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Eating_Concern<- data.frame(Time4, SigChange5f_Eating_Concern)
      names(Change_Rep_Df5c_Eating_Concern)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Eating_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Shape Concern Subscale

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Shape_Concern<- Entered_Scores_Df[,c(1,35,36,37,38,39,40)]
names(Scores_Table_Shape_Concern)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Shape_Concern<- kable(Stats_Table_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Shape_Concern, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Rose et al. (2013)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p4<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Shape_Concern, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Shape_Concern_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Shape_Concern_1[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Shape_Concern_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Shape_Concern_2[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Shape_Concern_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Shape_Concern_3[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_3[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Shape_Concern_4[1], linetype = paste(Cutoff_Names$Cutoff_Name_Shape_Concern_4[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_4[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Shape_Concern_5[1], linetype = paste(Cutoff_Names$Cutoff_Name_Shape_Concern_5[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_5[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("ff","8f","1f","11","solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Shape_Concern_1[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Shape_Concern_2[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Shape_Concern_3[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_3[1]),
paste(Cutoff_Names$Cutoff_Name_Shape_Concern_4[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_4[1]),
paste(Cutoff_Names$Cutoff_Name_Shape_Concern_5[1],":",Entered_Scores_Df$Cutoff_Score_Shape_Concern_5[1])
           )) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Shape_Concern, ymax=Entered_Scores_Df$CI_Upper_Lim_Shape_Concern), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change_Shape_Concern)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Shape_Concern)), size = 3, family = "AvantGarde") 
  
p4<- p4+labs(x="Date", y = "Shape Concern Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-3, 11), breaks = c(0,2,4,6,8), labels = c('0 Min','2','4','6','8 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p4)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2], "**")
      } else if(Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Shape_Concern<- data.frame(Time1, SigChange2_Shape_Concern)
      names(Change_Rep_Df2_Shape_Concern)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2], "**")
      } else if(Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2])
      }
      
      if(Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange3_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[3] - Rep_Df$Score_Shape_Concern[1]), "**")
      } else if(Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange3_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[3] - Rep_Df$Score_Shape_Concern[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Shape_Concern<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Shape_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Shape_Concern)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Upper_Lim_Shape_Concern[2] | Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange3a_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[3], "**")
      } else if(Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Upper_Lim_Shape_Concern[2] & Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange3a_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Shape_Concern<- data.frame(Time2, SigChange3a_Shape_Concern)
      names(Change_Rep_Df3a_Shape_Concern)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2], "**")
      } else if(Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2])
      }
      
      if(Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange3_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[3] - Rep_Df$Score_Shape_Concern[1]), "**")
      } else if(Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange3_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[3] - Rep_Df$Score_Shape_Concern[1]))
      }
      
      if(Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange4_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[1]), "**")
      } else if(Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange4_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Shape_Concern<- data.frame(Time1, SigChange2_Shape_Concern, SigChange3_Shape_Concern, SigChange4_Shape_Concern)
      names(Change_Rep_Df4_Shape_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Shape_Concern)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Shape_Concern)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Upper_Lim_Shape_Concern[2] | Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange4a_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[3], "**")
      } else if(Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Upper_Lim_Shape_Concern[2] & Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange4a_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[3])
      }
      
      if(Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Upper_Lim_Shape_Concern[2] | Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange4b_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[2]), "**")
      } else if(Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Upper_Lim_Shape_Concern[2] & Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange4b_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Shape_Concern<- data.frame(Time2, SigChange4a_Shape_Concern, SigChange4b_Shape_Concern)
      names(Change_Rep_Df4a_Shape_Concern)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Shape_Concern)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Upper_Lim_Shape_Concern[3] | Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Lower_Lim_Shape_Concern[3]) {
        SigChange4c_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[4], "**")
      } else if(Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Upper_Lim_Shape_Concern[3] & Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Lower_Lim_Shape_Concern[3]) {
        SigChange4c_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Shape_Concern<- data.frame(Time3, SigChange4c_Shape_Concern)
      names(Change_Rep_Df4b_Shape_Concern)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2], "**")
      } else if(Rep_Df$Score_Shape_Concern[2] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[2] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange2_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[2])
      }
      
      if(Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange3_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[3] - Rep_Df$Score_Shape_Concern[1]), "**")
      } else if(Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange3_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[3] - Rep_Df$Score_Shape_Concern[1]))
      }
      
      if(Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange4_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[1]), "**")
      } else if(Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange4_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[1]))
      }
      
      if(Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Upper_Lim_Shape_Concern[1] | Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange5_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[5] - Rep_Df$Score_Shape_Concern[1]), "**")
      } else if(Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Upper_Lim_Shape_Concern[1] & Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Lower_Lim_Shape_Concern[1]) {
        SigChange5_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[5] - Rep_Df$Score_Shape_Concern[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Shape_Concern<- data.frame(Time1, SigChange2_Shape_Concern, SigChange3_Shape_Concern, SigChange4_Shape_Concern, SigChange5_Shape_Concern)
      names(Change_Rep_Df5_Shape_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Shape_Concern)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Shape_Concern)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Shape_Concern)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Upper_Lim_Shape_Concern[2] | Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange5a_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[3], "**")
      } else if(Rep_Df$Score_Shape_Concern[3] < Rep_Df$CI_Upper_Lim_Shape_Concern[2] & Rep_Df$Score_Shape_Concern[3] > Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange5a_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[3])
      }
      
      if(Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Upper_Lim_Shape_Concern[2] | Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange5b_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[2]), "**")
      } else if(Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Upper_Lim_Shape_Concern[2] & Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange5b_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[4] - Rep_Df$Score_Shape_Concern[2]))
      }
      
      if(Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Upper_Lim_Shape_Concern[2] | Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange5c_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[5] - Rep_Df$Score_Shape_Concern[2]), "**")
      } else if(Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Upper_Lim_Shape_Concern[2] & Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Lower_Lim_Shape_Concern[2]) {
        SigChange5c_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[5] - Rep_Df$Score_Shape_Concern[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Shape_Concern<- data.frame(Time2, SigChange5a_Shape_Concern, SigChange5b_Shape_Concern, SigChange5c_Shape_Concern)
      names(Change_Rep_Df5a_Shape_Concern)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Shape_Concern)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Shape_Concern)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Upper_Lim_Shape_Concern[3] | Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Lower_Lim_Shape_Concern[3]) {
        SigChange5d_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[4], "**")
      } else if(Rep_Df$Score_Shape_Concern[4] < Rep_Df$CI_Upper_Lim_Shape_Concern[3] & Rep_Df$Score_Shape_Concern[4] > Rep_Df$CI_Lower_Lim_Shape_Concern[3]) {
        SigChange5d_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[4])
      }
      
      if(Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Upper_Lim_Shape_Concern[3] | Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Lower_Lim_Shape_Concern[3]) {
        SigChange5e_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[5] - Rep_Df$Score_Shape_Concern[3]), "**")
      } else if(Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Upper_Lim_Shape_Concern[3] & Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Lower_Lim_Shape_Concern[3]) {
        SigChange5e_Shape_Concern<- paste((Rep_Df$Score_Shape_Concern[5] - Rep_Df$Score_Shape_Concern[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Shape_Concern<- data.frame(Time3, SigChange5d_Shape_Concern, SigChange5e_Shape_Concern)
      names(Change_Rep_Df5b_Shape_Concern)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Shape_Concern)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Upper_Lim_Shape_Concern[4] | Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Lower_Lim_Shape_Concern[4]) {
        SigChange5f_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[5], "**")
      } else if(Rep_Df$Score_Shape_Concern[5] < Rep_Df$CI_Upper_Lim_Shape_Concern[4] & Rep_Df$Score_Shape_Concern[5] > Rep_Df$CI_Lower_Lim_Shape_Concern[4]) {
        SigChange5f_Shape_Concern<- paste(Rep_Df$Change_Shape_Concern[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Shape_Concern<- data.frame(Time4, SigChange5f_Shape_Concern)
      names(Change_Rep_Df5c_Shape_Concern)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Shape_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Weight Concern Subscale

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Weight_Concern<- Entered_Scores_Df[,c(1,46,47,48,49,50,51)]
names(Scores_Table_Weight_Concern)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Weight_Concern<- kable(Stats_Table_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Weight_Concern, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Rose et al. (2013)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p5<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Weight_Concern, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Weight_Concern_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Weight_Concern_1[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Weight_Concern_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Weight_Concern_2[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Weight_Concern_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Weight_Concern_3[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_3[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Weight_Concern_4[1], linetype = paste(Cutoff_Names$Cutoff_Name_Weight_Concern_4[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_4[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Weight_Concern_5[1], linetype = paste(Cutoff_Names$Cutoff_Name_Weight_Concern_5[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_5[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("ff","8f","1f","11","solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Weight_Concern_1[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Weight_Concern_2[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Weight_Concern_3[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_3[1]),
paste(Cutoff_Names$Cutoff_Name_Weight_Concern_4[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_4[1]),
paste(Cutoff_Names$Cutoff_Name_Weight_Concern_5[1],":",Entered_Scores_Df$Cutoff_Score_Weight_Concern_5[1])
           )) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Weight_Concern, ymax=Entered_Scores_Df$CI_Upper_Lim_Weight_Concern), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change_Weight_Concern)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Weight_Concern)), size = 3, family = "AvantGarde") 
  
p5<- p5+labs(x="Date", y = "Weight Concern Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-2, 7), breaks = c(0,1,2,3,4,5), labels = c('0 Min','1','2','3','4','5 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p5)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2], "**")
      } else if(Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Weight_Concern<- data.frame(Time1, SigChange2_Weight_Concern)
      names(Change_Rep_Df2_Weight_Concern)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2], "**")
      } else if(Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2])
      }
      
      if(Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange3_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[3] - Rep_Df$Score_Weight_Concern[1]), "**")
      } else if(Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange3_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[3] - Rep_Df$Score_Weight_Concern[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Weight_Concern<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Weight_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Weight_Concern)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Upper_Lim_Weight_Concern[2] | Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange3a_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[3], "**")
      } else if(Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Upper_Lim_Weight_Concern[2] & Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange3a_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Weight_Concern<- data.frame(Time2, SigChange3a_Weight_Concern)
      names(Change_Rep_Df3a_Weight_Concern)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2], "**")
      } else if(Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2])
      }
      
      if(Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange3_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[3] - Rep_Df$Score_Weight_Concern[1]), "**")
      } else if(Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange3_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[3] - Rep_Df$Score_Weight_Concern[1]))
      }
      
      if(Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange4_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[1]), "**")
      } else if(Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange4_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Weight_Concern<- data.frame(Time1, SigChange2_Weight_Concern, SigChange3_Weight_Concern, SigChange4_Weight_Concern)
      names(Change_Rep_Df4_Weight_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Weight_Concern)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Weight_Concern)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Upper_Lim_Weight_Concern[2] | Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange4a_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[3], "**")
      } else if(Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Upper_Lim_Weight_Concern[2] & Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange4a_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[3])
      }
      
      if(Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Upper_Lim_Weight_Concern[2] | Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange4b_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[2]), "**")
      } else if(Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Upper_Lim_Weight_Concern[2] & Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange4b_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Weight_Concern<- data.frame(Time2, SigChange4a_Weight_Concern, SigChange4b_Weight_Concern)
      names(Change_Rep_Df4a_Weight_Concern)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Weight_Concern)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Upper_Lim_Weight_Concern[3] | Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Lower_Lim_Weight_Concern[3]) {
        SigChange4c_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[4], "**")
      } else if(Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Upper_Lim_Weight_Concern[3] & Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Lower_Lim_Weight_Concern[3]) {
        SigChange4c_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Weight_Concern<- data.frame(Time3, SigChange4c_Weight_Concern)
      names(Change_Rep_Df4b_Weight_Concern)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2], "**")
      } else if(Rep_Df$Score_Weight_Concern[2] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[2] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange2_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[2])
      }
      
      if(Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange3_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[3] - Rep_Df$Score_Weight_Concern[1]), "**")
      } else if(Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange3_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[3] - Rep_Df$Score_Weight_Concern[1]))
      }
      
      if(Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange4_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[1]), "**")
      } else if(Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange4_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[1]))
      }
      
      if(Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Upper_Lim_Weight_Concern[1] | Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange5_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[5] - Rep_Df$Score_Weight_Concern[1]), "**")
      } else if(Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Upper_Lim_Weight_Concern[1] & Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Lower_Lim_Weight_Concern[1]) {
        SigChange5_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[5] - Rep_Df$Score_Weight_Concern[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Weight_Concern<- data.frame(Time1, SigChange2_Weight_Concern, SigChange3_Weight_Concern, SigChange4_Weight_Concern, SigChange5_Weight_Concern)
      names(Change_Rep_Df5_Weight_Concern)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Weight_Concern)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Weight_Concern)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Weight_Concern)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Upper_Lim_Weight_Concern[2] | Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange5a_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[3], "**")
      } else if(Rep_Df$Score_Weight_Concern[3] < Rep_Df$CI_Upper_Lim_Weight_Concern[2] & Rep_Df$Score_Weight_Concern[3] > Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange5a_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[3])
      }
      
      if(Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Upper_Lim_Weight_Concern[2] | Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange5b_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[2]), "**")
      } else if(Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Upper_Lim_Weight_Concern[2] & Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange5b_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[4] - Rep_Df$Score_Weight_Concern[2]))
      }
      
      if(Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Upper_Lim_Weight_Concern[2] | Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange5c_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[5] - Rep_Df$Score_Weight_Concern[2]), "**")
      } else if(Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Upper_Lim_Weight_Concern[2] & Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Lower_Lim_Weight_Concern[2]) {
        SigChange5c_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[5] - Rep_Df$Score_Weight_Concern[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Weight_Concern<- data.frame(Time2, SigChange5a_Weight_Concern, SigChange5b_Weight_Concern, SigChange5c_Weight_Concern)
      names(Change_Rep_Df5a_Weight_Concern)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Weight_Concern)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Weight_Concern)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Upper_Lim_Weight_Concern[3] | Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Lower_Lim_Weight_Concern[3]) {
        SigChange5d_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[4], "**")
      } else if(Rep_Df$Score_Weight_Concern[4] < Rep_Df$CI_Upper_Lim_Weight_Concern[3] & Rep_Df$Score_Weight_Concern[4] > Rep_Df$CI_Lower_Lim_Weight_Concern[3]) {
        SigChange5d_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[4])
      }
      
      if(Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Upper_Lim_Weight_Concern[3] | Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Lower_Lim_Weight_Concern[3]) {
        SigChange5e_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[5] - Rep_Df$Score_Weight_Concern[3]), "**")
      } else if(Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Upper_Lim_Weight_Concern[3] & Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Lower_Lim_Weight_Concern[3]) {
        SigChange5e_Weight_Concern<- paste((Rep_Df$Score_Weight_Concern[5] - Rep_Df$Score_Weight_Concern[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Weight_Concern<- data.frame(Time3, SigChange5d_Weight_Concern, SigChange5e_Weight_Concern)
      names(Change_Rep_Df5b_Weight_Concern)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Weight_Concern)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Upper_Lim_Weight_Concern[4] | Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Lower_Lim_Weight_Concern[4]) {
        SigChange5f_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[5], "**")
      } else if(Rep_Df$Score_Weight_Concern[5] < Rep_Df$CI_Upper_Lim_Weight_Concern[4] & Rep_Df$Score_Weight_Concern[5] > Rep_Df$CI_Lower_Lim_Weight_Concern[4]) {
        SigChange5f_Weight_Concern<- paste(Rep_Df$Change_Weight_Concern[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Weight_Concern<- data.frame(Time4, SigChange5f_Weight_Concern)
      names(Change_Rep_Df5c_Weight_Concern)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Weight_Concern, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


#Most Recent Item Scores

#`r Scores_Table[nrow(Scores_Table),1]`

```{r,echo=FALSE,warning=FALSE,comment=NA}

kable(Item_Df, format = "latex", booktabs = T) %>% kable_styling(position = "left", full_width = T, font_size = 10, latex_options = "striped") %>% row_spec(0, bold = T)
```

\newpage 

#Binge Eating Item Responses

* Over the past 28 days, how many times have you eaten what other people would regard as an unusually large amount of food (given the circumstances)? `r Binge_Info[1]`

* ....On how many of these times did you have a sense of having lost control over your eating (at the time that you were eating)?
`r Binge_Info[2]`

* Over the past 28 days, on how many DAYS have such episodes of overeating occurred (i.e. you have eaten an unusually large amount of food and have had a sense of loss of control at the time)?
`r Binge_Info[3]`

* Over the past 28 days, how many times have you made yourself sick (vomit) as a means of controlling your shape or weight?
`r Binge_Info[4]`

* Over the past 28 days, how many times have you taken laxatives as a means of controlling your shape or weight? 
`r Binge_Info[5]` 

* Over the past 28 days, how many times have you exercised in a driven or compulsive way as a means of controlling your weight, shape or amount of fat or to burn off calories?
`r Binge_Info[6]` 

# Additional Patient Information

* What is your weight at present? (Please give your best estimate)
`r Basic_Info[1]` 

* What is your height? (Please give your best estimate)
`r Basic_Info[2]`

* If female: Over the past three-to-four months have you missed any menstrual periods?
`r Basic_Info[3]`

* If so, how many?
`r Basic_Info[4]`

* Have you been taking the pill?
`r Basic_Info[5]`

\newpage 

\begingroup\Large

\begin{center} \textbf{Information about the Eating Disorder Examination Questionnaire (EDE-Q)} \end{center} 

#What it Measures: 

* The frequency of important eating disorder behaviours, including restriction of eating **(Restraint)**, and thoughts/preoccupations related to eating **(Eating Concern)**, body-shape **(Shape Concern)**, and weight **(Weight Concern)**. 

* The EDE-Q is the self-report form of the Eating Disorder Examination (EDE), a structured, clinician-administered interview that is considered the gold standard in assessment of eating disorder symptomatology. 

* The EDE-Q also contains items assessing binge eating symptoms, however these items are not included in the subscale or total scale scores. 


#What Higher Scores Mean:

* Greater frequency of eating disorder symptomatology. 

#Scale Quality:

* The EDE-Q is one of the most frequently-used measures of eating disorder symptomatology. The scale has been critiqued on the grounds of having an irreplicable factor structure and being emotionnally-triggering for respondents. However, systematic review supported and found that it performed similarly to the EDE in important respects (Berg, Peterson, Frazier & Crow, 2013). 

#Scale Structure: 

* The original 4-factor structure of the EDE-Q (Fairburn & Beglin, 1994) has generally not been supported by subsequent research. A recent confirmatory factor analysis and assessment of measurement invariance (based on sex) evalutated 12 different models proposed by previous studies (Rand-Giovannetti, Cicero, Mond & Latner, 2017). The authors found the strongest support for the model of Friborg et al. (2013), a 4-factor model comprising (1) dietary restraint, (2) preoccupation and restriction, (3) weight and shape concern, and (4) eating shame. 

\endgroup
