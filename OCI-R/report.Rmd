---
title: "Obsessive Compulsive Inventory - Revised (OCI-R)"
author: "Report generated by PsychlytX"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
PN: 'NULL' 
CN: 'NULL'
Tab_Reference: 'NULL'
Stats_Table_Fullscale: 'NULL'
Stats_Table_Washing: 'NULL'
Stats_Table_Checking: 'NULL'
Stats_Table_Ordering: 'NULL'
Stats_Table_Obsessing: 'NULL'
Stats_Table_Hoarding: 'NULL'
Stats_Table_Neutralizing: 'NULL'
Entered_Scores_Df: 'NULL'
Cutoff_Names: 'NULL'
Item_Df: 'NULL'
subtitle: '**Patient:** `r PN` **|** **Clinician:** `r CN`'
---

```{r,echo = FALSE,warning=FALSE,comment = NA}
knitr::opts_chunk$set(fig.width=7,fig.height=3) 

```

#OCI-R Total Scale 

##Response Summary

```{r,echo=FALSE,warning=FALSE,comment=NA}
Scores_Table<- Entered_Scores_Df[,c(1,2,3,4,5,6,7)]
names(Scores_Table)<- c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```


##Data Employed in Reliable Change Analyses

```{r,echo=FALSE,warning=FALSE,comment=NA}

Stats_Table_Fullscale<- kable(Stats_Table_Fullscale, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Fullscale, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```


##Trend

```{r,echo=FALSE,warning=FALSE,comment=FALSE,message=FALSE, fig.width=8}
 p1<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1]),
                                                   paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1]),
                                                   paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim, ymax=Entered_Scores_Df$CI_Upper_Lim), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde", face = "bold") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score)), size = 3, family = "AvantGarde", face = "bold")   
                        
p1<- p1+labs(x="Date", y = "Total OCI-R Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-10, 82), breaks = c(0,8,16,24,32,40,48,56,64,72), labels = c('0 Min', '8','16','24','32','40','48', '56','64','72 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde"))
print(p1) 
```

##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by ** 
```{r, echo = FALSE, warning = FALSE,comment=NA, message=FALSE}

if(length(Entered_Scores_Df$Date) == 2) {  

Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2<- data.frame(Time1, SigChange2)
      names(Change_Rep_Df2)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a<- data.frame(Time2, SigChange3a)
      names(Change_Rep_Df3a)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4<- data.frame(Time1, SigChange2, SigChange3, SigChange4)
      names(Change_Rep_Df4)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a<- data.frame(Time2, SigChange4a, SigChange4b)
      names(Change_Rep_Df4a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b<- data.frame(Time3, SigChange4c)
      names(Change_Rep_Df4b)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE, comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5<- data.frame(Time1, SigChange2, SigChange3, SigChange4, SigChange5)
      names(Change_Rep_Df5)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a<- data.frame(Time2, SigChange5a, SigChange5b, SigChange5c)
      names(Change_Rep_Df5a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4])
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b<- data.frame(Time3, SigChange5d, SigChange5e)
      names(Change_Rep_Df5b)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[4] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5], "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[4] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c<- data.frame(Time4, SigChange5f)
      names(Change_Rep_Df5c)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Washing Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Washing<- Entered_Scores_Df[,c(1,11,12,13,14,15,16)]
names(Scores_Table_Washing)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Washing<- kable(Stats_Table_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Washing, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p2<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Washing, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Washing_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Washing_1[1],":",Entered_Scores_Df$Cutoff_Score_Washing_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Washing_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Washing_2[1],":",Entered_Scores_Df$Cutoff_Score_Washing_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Washing_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Washing_3[1],":",Entered_Scores_Df$Cutoff_Score_Washing_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Washing_1[1],":",Entered_Scores_Df$Cutoff_Score_Washing_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Washing_2[1],":",Entered_Scores_Df$Cutoff_Score_Washing_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Washing_3[1],":",Entered_Scores_Df$Cutoff_Score_Washing_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Washing, ymax=Entered_Scores_Df$CI_Upper_Lim_Washing), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Washing)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Washing)), size = 3, family = "AvantGarde")  
  
p2<- p2+labs(x="Date", y = "Washing Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 17), breaks = c(0,2,4,6,8,10,12), labels = c('0 Min','2','4','6','8','10','12 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p2)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Washing[2] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[2] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2], "**")
      } else if(Rep_Df$Score_Washing[2] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[2] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Washing<- data.frame(Time1, SigChange2_Washing)
      names(Change_Rep_Df2_Washing)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Washing[2] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[2] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2], "**")
      } else if(Rep_Df$Score_Washing[2] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[2] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2])
      }
      
      if(Rep_Df$Score_Washing[3] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[3] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange3_Washing<- paste((Rep_Df$Score_Washing[3] - Rep_Df$Score_Washing[1]), "**")
      } else if(Rep_Df$Score_Washing[3] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[3] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange3_Washing<- paste((Rep_Df$Score_Washing[3] - Rep_Df$Score_Washing[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Washing<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Washing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Washing)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Washing[3] > Rep_Df$CI_Upper_Lim_Washing[2] | Rep_Df$Score_Washing[3] < Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange3a_Washing<- paste(Rep_Df$Change_Washing[3], "**")
      } else if(Rep_Df$Score_Washing[3] < Rep_Df$CI_Upper_Lim_Washing[2] & Rep_Df$Score_Washing[3] > Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange3a_Washing<- paste(Rep_Df$Change_Washing[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Washing<- data.frame(Time2, SigChange3a_Washing)
      names(Change_Rep_Df3a_Washing)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Washing[2] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[2] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2], "**")
      } else if(Rep_Df$Score_Washing[2] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[2] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2])
      }
      
      if(Rep_Df$Score_Washing[3] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[3] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange3_Washing<- paste((Rep_Df$Score_Washing[3] - Rep_Df$Score_Washing[1]), "**")
      } else if(Rep_Df$Score_Washing[3] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[3] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange3_Washing<- paste((Rep_Df$Score_Washing[3] - Rep_Df$Score_Washing[1]))
      }
      
      if(Rep_Df$Score_Washing[4] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[4] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange4_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[1]), "**")
      } else if(Rep_Df$Score_Washing[4] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[4] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange4_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Washing<- data.frame(Time1, SigChange2_Washing, SigChange3_Washing, SigChange4_Washing)
      names(Change_Rep_Df4_Washing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Washing)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Washing)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Washing[3] > Rep_Df$CI_Upper_Lim_Washing[2] | Rep_Df$Score_Washing[3] < Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange4a_Washing<- paste(Rep_Df$Change_Washing[3], "**")
      } else if(Rep_Df$Score_Washing[3] < Rep_Df$CI_Upper_Lim_Washing[2] & Rep_Df$Score_Washing[3] > Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange4a_Washing<- paste(Rep_Df$Change_Washing[3])
      }
      
      if(Rep_Df$Score_Washing[4] > Rep_Df$CI_Upper_Lim_Washing[2] | Rep_Df$Score_Washing[4] < Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange4b_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[2]), "**")
      } else if(Rep_Df$Score_Washing[4] < Rep_Df$CI_Upper_Lim_Washing[2] & Rep_Df$Score_Washing[4] > Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange4b_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Washing<- data.frame(Time2, SigChange4a_Washing, SigChange4b_Washing)
      names(Change_Rep_Df4a_Washing)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Washing)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Washing[4] > Rep_Df$CI_Upper_Lim_Washing[3] | Rep_Df$Score_Washing[4] < Rep_Df$CI_Lower_Lim_Washing[3]) {
        SigChange4c_Washing<- paste(Rep_Df$Change_Washing[4], "**")
      } else if(Rep_Df$Score_Washing[4] < Rep_Df$CI_Upper_Lim_Washing[3] & Rep_Df$Score_Washing[4] > Rep_Df$CI_Lower_Lim_Washing[3]) {
        SigChange4c_Washing<- paste(Rep_Df$Change_Washing[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Washing<- data.frame(Time3, SigChange4c_Washing)
      names(Change_Rep_Df4b_Washing)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Washing[2] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[2] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2], "**")
      } else if(Rep_Df$Score_Washing[2] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[2] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange2_Washing<- paste(Rep_Df$Change_Washing[2])
      }
      
      if(Rep_Df$Score_Washing[3] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[3] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange3_Washing<- paste((Rep_Df$Score_Washing[3] - Rep_Df$Score_Washing[1]), "**")
      } else if(Rep_Df$Score_Washing[3] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[3] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange3_Washing<- paste((Rep_Df$Score_Washing[3] - Rep_Df$Score_Washing[1]))
      }
      
      if(Rep_Df$Score_Washing[4] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[4] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange4_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[1]), "**")
      } else if(Rep_Df$Score_Washing[4] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[4] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange4_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[1]))
      }
      
      if(Rep_Df$Score_Washing[5] > Rep_Df$CI_Upper_Lim_Washing[1] | Rep_Df$Score_Washing[5] < Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange5_Washing<- paste((Rep_Df$Score_Washing[5] - Rep_Df$Score_Washing[1]), "**")
      } else if(Rep_Df$Score_Washing[5] < Rep_Df$CI_Upper_Lim_Washing[1] & Rep_Df$Score_Washing[5] > Rep_Df$CI_Lower_Lim_Washing[1]) {
        SigChange5_Washing<- paste((Rep_Df$Score_Washing[5] - Rep_Df$Score_Washing[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Washing<- data.frame(Time1, SigChange2_Washing, SigChange3_Washing, SigChange4_Washing, SigChange5_Washing)
      names(Change_Rep_Df5_Washing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Washing)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Washing)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Washing)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Washing[3] > Rep_Df$CI_Upper_Lim_Washing[2] | Rep_Df$Score_Washing[3] < Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange5a_Washing<- paste(Rep_Df$Change_Washing[3], "**")
      } else if(Rep_Df$Score_Washing[3] < Rep_Df$CI_Upper_Lim_Washing[2] & Rep_Df$Score_Washing[3] > Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange5a_Washing<- paste(Rep_Df$Change_Washing[3])
      }
      
      if(Rep_Df$Score_Washing[4] > Rep_Df$CI_Upper_Lim_Washing[2] | Rep_Df$Score_Washing[4] < Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange5b_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[2]), "**")
      } else if(Rep_Df$Score_Washing[4] < Rep_Df$CI_Upper_Lim_Washing[2] & Rep_Df$Score_Washing[4] > Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange5b_Washing<- paste((Rep_Df$Score_Washing[4] - Rep_Df$Score_Washing[2]))
      }
      
      if(Rep_Df$Score_Washing[5] > Rep_Df$CI_Upper_Lim_Washing[2] | Rep_Df$Score_Washing[5] < Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange5c_Washing<- paste((Rep_Df$Score_Washing[5] - Rep_Df$Score_Washing[2]), "**")
      } else if(Rep_Df$Score_Washing[5] < Rep_Df$CI_Upper_Lim_Washing[2] & Rep_Df$Score_Washing[5] > Rep_Df$CI_Lower_Lim_Washing[2]) {
        SigChange5c_Washing<- paste((Rep_Df$Score_Washing[5] - Rep_Df$Score_Washing[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Washing<- data.frame(Time2, SigChange5a_Washing, SigChange5b_Washing, SigChange5c_Washing)
      names(Change_Rep_Df5a_Washing)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Washing)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Washing)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Washing[4] > Rep_Df$CI_Upper_Lim_Washing[3] | Rep_Df$Score_Washing[4] < Rep_Df$CI_Lower_Lim_Washing[3]) {
        SigChange5d_Washing<- paste(Rep_Df$Change_Washing[4], "**")
      } else if(Rep_Df$Score_Washing[4] < Rep_Df$CI_Upper_Lim_Washing[3] & Rep_Df$Score_Washing[4] > Rep_Df$CI_Lower_Lim_Washing[3]) {
        SigChange5d_Washing<- paste(Rep_Df$Change_Washing[4])
      }
      
      if(Rep_Df$Score_Washing[5] > Rep_Df$CI_Upper_Lim_Washing[3] | Rep_Df$Score_Washing[5] < Rep_Df$CI_Lower_Lim_Washing[3]) {
        SigChange5e_Washing<- paste((Rep_Df$Score_Washing[5] - Rep_Df$Score_Washing[3]), "**")
      } else if(Rep_Df$Score_Washing[5] < Rep_Df$CI_Upper_Lim_Washing[3] & Rep_Df$Score_Washing[5] > Rep_Df$CI_Lower_Lim_Washing[3]) {
        SigChange5e_Washing<- paste((Rep_Df$Score_Washing[5] - Rep_Df$Score_Washing[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Washing<- data.frame(Time3, SigChange5d_Washing, SigChange5e_Washing)
      names(Change_Rep_Df5b_Washing)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Washing)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Washing[5] > Rep_Df$CI_Upper_Lim_Washing[4] | Rep_Df$Score_Washing[5] < Rep_Df$CI_Lower_Lim_Washing[4]) {
        SigChange5f_Washing<- paste(Rep_Df$Change_Washing[5], "**")
      } else if(Rep_Df$Score_Washing[5] < Rep_Df$CI_Upper_Lim_Washing[4] & Rep_Df$Score_Washing[5] > Rep_Df$CI_Lower_Lim_Washing[4]) {
        SigChange5f_Washing<- paste(Rep_Df$Change_Washing[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Washing<- data.frame(Time4, SigChange5f_Washing)
      names(Change_Rep_Df5c_Washing)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Washing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Checking Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Checking<- Entered_Scores_Df[,c(1,20,21,22,23,24,25)]
names(Scores_Table_Checking)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Checking<- kable(Stats_Table_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Checking, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p3<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Checking, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Checking_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Checking_1[1],":",Entered_Scores_Df$Cutoff_Score_Checking_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Checking_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Checking_2[1],":",Entered_Scores_Df$Cutoff_Score_Checking_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Checking_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Checking_3[1],":",Entered_Scores_Df$Cutoff_Score_Checking_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Checking_1[1],":",Entered_Scores_Df$Cutoff_Score_Checking_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Checking_2[1],":",Entered_Scores_Df$Cutoff_Score_Checking_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Checking_3[1],":",Entered_Scores_Df$Cutoff_Score_Checking_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Checking, ymax=Entered_Scores_Df$CI_Upper_Lim_Checking), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Checking)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Checking)), size = 3, family = "AvantGarde") 
  
p3<- p3+labs(x="Date", y = "Checking Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 17), breaks = c(0,2,4,6,8,10,12),
                             labels = c('0 Min','2','4','6','8','10','12 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p3)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Checking[2] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[2] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change_Checking[2], "**")
      } else if(Rep_Df$Score_Checking[2] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[2] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change_Checking[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Checking<- data.frame(Time1, SigChange2_Checking)
      names(Change_Rep_Df2_Checking)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Checking[2] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[2] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change_Checking[2], "**")
      } else if(Rep_Df$Score_Checking[2] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[2] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change_Checking[2])
      }
      
      if(Rep_Df$Score_Checking[3] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[3] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange3_Checking<- paste((Rep_Df$Score_Checking[3] - Rep_Df$Score_Checking[1]), "**")
      } else if(Rep_Df$Score_Checking[3] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[3] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange3_Checking<- paste((Rep_Df$Score_Checking[3] - Rep_Df$Score_Checking[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Checking<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Checking)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Checking)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Checking[3] > Rep_Df$CI_Upper_Lim_Checking[2] | Rep_Df$Score_Checking[3] < Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange3a_Checking<- paste(Rep_Df$Change_Checking[3], "**")
      } else if(Rep_Df$Score_Checking[3] < Rep_Df$CI_Upper_Lim_Checking[2] & Rep_Df$Score_Checking[3] > Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange3a_Checking<- paste(Rep_Df$Change_Checking[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Checking<- data.frame(Time2, SigChange3a_Checking)
      names(Change_Rep_Df3a_Checking)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Checking[2] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[2] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change_Checking[2], "**")
      } else if(Rep_Df$Score_Checking[2] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[2] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change_Checking[2])
      }
      
      if(Rep_Df$Score_Checking[3] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[3] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange3_Checking<- paste((Rep_Df$Score_Checking[3] - Rep_Df$Score_Checking[1]), "**")
      } else if(Rep_Df$Score_Checking[3] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[3] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange3_Checking<- paste((Rep_Df$Score_Checking[3] - Rep_Df$Score_Checking[1]))
      }
      
      if(Rep_Df$Score_Checking[4] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[4] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange4_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[1]), "**")
      } else if(Rep_Df$Score_Checking[4] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[4] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange4_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Checking<- data.frame(Time1, SigChange2_Checking, SigChange3_Checking, SigChange4_Checking)
      names(Change_Rep_Df4_Checking)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Checking)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Checking)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Checking[3] > Rep_Df$CI_Upper_Lim_Checking[2] | Rep_Df$Score_Checking[3] < Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange4a_Checking<- paste(Rep_Df$Change_Checking[3], "**")
      } else if(Rep_Df$Score_Checking[3] < Rep_Df$CI_Upper_Lim_Checking[2] & Rep_Df$Score_Checking[3] > Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange4a_Checking<- paste(Rep_Df$Change_Checking[3])
      }
      
      if(Rep_Df$Score_Checking[4] > Rep_Df$CI_Upper_Lim_Checking[2] | Rep_Df$Score_Checking[4] < Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange4b_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[2]), "**")
      } else if(Rep_Df$Score_Checking[4] < Rep_Df$CI_Upper_Lim_Checking[2] & Rep_Df$Score_Checking[4] > Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange4b_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Checking<- data.frame(Time2, SigChange4a_Checking, SigChange4b_Checking)
      names(Change_Rep_Df4a_Checking)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Checking)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Checking[4] > Rep_Df$CI_Upper_Lim_Checking[3] | Rep_Df$Score_Checking[4] < Rep_Df$CI_Lower_Lim_Checking[3]) {
        SigChange4c_Checking<- paste(Rep_Df$Change_Checking[4], "**")
      } else if(Rep_Df$Score_Checking[4] < Rep_Df$CI_Upper_Lim_Checking[3] & Rep_Df$Score_Checking[4] > Rep_Df$CI_Lower_Lim_Checking[3]) {
        SigChange4c_Checking<- paste(Rep_Df$Change_Checking[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Checking<- data.frame(Time3, SigChange4c_Checking)
      names(Change_Rep_Df4b_Checking)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Checking[2] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[2] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Checking[2] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[2] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange2_Checking<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Checking[3] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[3] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange3_Checking<- paste((Rep_Df$Score_Checking[3] - Rep_Df$Score_Checking[1]), "**")
      } else if(Rep_Df$Score_Checking[3] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[3] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange3_Checking<- paste((Rep_Df$Score_Checking[3] - Rep_Df$Score_Checking[1]))
      }
      
      if(Rep_Df$Score_Checking[4] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[4] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange4_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[1]), "**")
      } else if(Rep_Df$Score_Checking[4] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[4] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange4_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[1]))
      }
      
      if(Rep_Df$Score_Checking[5] > Rep_Df$CI_Upper_Lim_Checking[1] | Rep_Df$Score_Checking[5] < Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange5_Checking<- paste((Rep_Df$Score_Checking[5] - Rep_Df$Score_Checking[1]), "**")
      } else if(Rep_Df$Score_Checking[5] < Rep_Df$CI_Upper_Lim_Checking[1] & Rep_Df$Score_Checking[5] > Rep_Df$CI_Lower_Lim_Checking[1]) {
        SigChange5_Checking<- paste((Rep_Df$Score_Checking[5] - Rep_Df$Score_Checking[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Checking<- data.frame(Time1, SigChange2_Checking, SigChange3_Checking, SigChange4_Checking, SigChange5_Checking)
      names(Change_Rep_Df5_Checking)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Checking)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Checking)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Checking)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Checking[3] > Rep_Df$CI_Upper_Lim_Checking[2] | Rep_Df$Score_Checking[3] < Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange5a_Checking<- paste(Rep_Df$Change_Checking[3], "**")
      } else if(Rep_Df$Score_Checking[3] < Rep_Df$CI_Upper_Lim_Checking[2] & Rep_Df$Score_Checking[3] > Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange5a_Checking<- paste(Rep_Df$Change_Checking[3])
      }
      
      if(Rep_Df$Score_Checking[4] > Rep_Df$CI_Upper_Lim_Checking[2] | Rep_Df$Score_Checking[4] < Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange5b_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[2]), "**")
      } else if(Rep_Df$Score_Checking[4] < Rep_Df$CI_Upper_Lim_Checking[2] & Rep_Df$Score_Checking[4] > Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange5b_Checking<- paste((Rep_Df$Score_Checking[4] - Rep_Df$Score_Checking[2]))
      }
      
      if(Rep_Df$Score_Checking[5] > Rep_Df$CI_Upper_Lim_Checking[2] | Rep_Df$Score_Checking[5] < Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange5c_Checking<- paste((Rep_Df$Score_Checking[5] - Rep_Df$Score_Checking[2]), "**")
      } else if(Rep_Df$Score_Checking[5] < Rep_Df$CI_Upper_Lim_Checking[2] & Rep_Df$Score_Checking[5] > Rep_Df$CI_Lower_Lim_Checking[2]) {
        SigChange5c_Checking<- paste((Rep_Df$Score_Checking[5] - Rep_Df$Score_Checking[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Checking<- data.frame(Time2, SigChange5a_Checking, SigChange5b_Checking, SigChange5c_Checking)
      names(Change_Rep_Df5a_Checking)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Checking)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Checking)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Checking[4] > Rep_Df$CI_Upper_Lim_Checking[3] | Rep_Df$Score_Checking[4] < Rep_Df$CI_Lower_Lim_Checking[3]) {
        SigChange5d_Checking<- paste(Rep_Df$Change_Checking[4], "**")
      } else if(Rep_Df$Score_Checking[4] < Rep_Df$CI_Upper_Lim_Checking[3] & Rep_Df$Score_Checking[4] > Rep_Df$CI_Lower_Lim_Checking[3]) {
        SigChange5d_Checking<- paste(Rep_Df$Change_Checking[4])
      }
      
      if(Rep_Df$Score_Checking[5] > Rep_Df$CI_Upper_Lim_Checking[3] | Rep_Df$Score_Checking[5] < Rep_Df$CI_Lower_Lim_Checking[3]) {
        SigChange5e_Checking<- paste((Rep_Df$Score_Checking[5] - Rep_Df$Score_Checking[3]), "**")
      } else if(Rep_Df$Score_Checking[5] < Rep_Df$CI_Upper_Lim_Checking[3] & Rep_Df$Score_Checking[5] > Rep_Df$CI_Lower_Lim_Checking[3]) {
        SigChange5e_Checking<- paste((Rep_Df$Score_Checking[5] - Rep_Df$Score_Checking[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Checking<- data.frame(Time3, SigChange5d_Checking, SigChange5e_Checking)
      names(Change_Rep_Df5b_Checking)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Checking)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Checking[5] > Rep_Df$CI_Upper_Lim_Checking[4] | Rep_Df$Score_Checking[5] < Rep_Df$CI_Lower_Lim_Checking[4]) {
        SigChange5f_Checking<- paste(Rep_Df$Change_Checking[5], "**")
      } else if(Rep_Df$Score_Checking[5] < Rep_Df$CI_Upper_Lim_Checking[4] & Rep_Df$Score_Checking[5] > Rep_Df$CI_Lower_Lim_Checking[4]) {
        SigChange5f_Checking<- paste(Rep_Df$Change_Checking[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Checking<- data.frame(Time4, SigChange5f_Checking)
      names(Change_Rep_Df5c_Checking)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Checking, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Ordering Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Ordering<- Entered_Scores_Df[,c(1,29,30,31,32,33,34)]
names(Scores_Table_Ordering)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Ordering<- kable(Stats_Table_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Ordering, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p4<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Ordering, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Ordering_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Ordering_1[1],":",Entered_Scores_Df$Cutoff_Score_Ordering_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Ordering_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Ordering_2[1],":",Entered_Scores_Df$Cutoff_Score_Ordering_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Ordering_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Ordering_3[1],":",Entered_Scores_Df$Cutoff_Score_Ordering_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Ordering_1[1],":",Entered_Scores_Df$Cutoff_Score_Ordering_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Ordering_2[1],":",Entered_Scores_Df$Cutoff_Score_Ordering_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Ordering_3[1],":",Entered_Scores_Df$Cutoff_Score_Ordering_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Ordering, ymax=Entered_Scores_Df$CI_Upper_Lim_Ordering), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Ordering)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Ordering)), size = 3, family = "AvantGarde") 
  
p4<- p4+labs(x="Date", y = "Ordering Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 17), breaks = c(0,2,4,6,8,10,12), labels = c('0 Min','2','4','6','8', '10','12 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p4)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Ordering[2] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[2] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2], "**")
      } else if(Rep_Df$Score_Ordering[2] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[2] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Ordering<- data.frame(Time1, SigChange2_Ordering)
      names(Change_Rep_Df2_Ordering)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Ordering[2] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[2] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2], "**")
      } else if(Rep_Df$Score_Ordering[2] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[2] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2])
      }
      
      if(Rep_Df$Score_Ordering[3] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[3] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange3_Ordering<- paste((Rep_Df$Score_Ordering[3] - Rep_Df$Score_Ordering[1]), "**")
      } else if(Rep_Df$Score_Ordering[3] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[3] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange3_Ordering<- paste((Rep_Df$Score_Ordering[3] - Rep_Df$Score_Ordering[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Ordering<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Ordering)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Ordering)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Ordering[3] > Rep_Df$CI_Upper_Lim_Ordering[2] | Rep_Df$Score_Ordering[3] < Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange3a_Ordering<- paste(Rep_Df$Change_Ordering[3], "**")
      } else if(Rep_Df$Score_Ordering[3] < Rep_Df$CI_Upper_Lim_Ordering[2] & Rep_Df$Score_Ordering[3] > Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange3a_Ordering<- paste(Rep_Df$Change_Ordering[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Ordering<- data.frame(Time2, SigChange3a_Ordering)
      names(Change_Rep_Df3a_Ordering)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Ordering[2] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[2] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2], "**")
      } else if(Rep_Df$Score_Ordering[2] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[2] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2])
      }
      
      if(Rep_Df$Score_Ordering[3] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[3] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange3_Ordering<- paste((Rep_Df$Score_Ordering[3] - Rep_Df$Score_Ordering[1]), "**")
      } else if(Rep_Df$Score_Ordering[3] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[3] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange3_Ordering<- paste((Rep_Df$Score_Ordering[3] - Rep_Df$Score_Ordering[1]))
      }
      
      if(Rep_Df$Score_Ordering[4] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[4] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange4_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[1]), "**")
      } else if(Rep_Df$Score_Ordering[4] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[4] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange4_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Ordering<- data.frame(Time1, SigChange2_Ordering, SigChange3_Ordering, SigChange4_Ordering)
      names(Change_Rep_Df4_Ordering)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Ordering)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Ordering)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Ordering[3] > Rep_Df$CI_Upper_Lim_Ordering[2] | Rep_Df$Score_Ordering[3] < Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange4a_Ordering<- paste(Rep_Df$Change_Ordering[3], "**")
      } else if(Rep_Df$Score_Ordering[3] < Rep_Df$CI_Upper_Lim_Ordering[2] & Rep_Df$Score_Ordering[3] > Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange4a_Ordering<- paste(Rep_Df$Change_Ordering[3])
      }
      
      if(Rep_Df$Score_Ordering[4] > Rep_Df$CI_Upper_Lim_Ordering[2] | Rep_Df$Score_Ordering[4] < Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange4b_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[2]), "**")
      } else if(Rep_Df$Score_Ordering[4] < Rep_Df$CI_Upper_Lim_Ordering[2] & Rep_Df$Score_Ordering[4] > Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange4b_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Ordering<- data.frame(Time2, SigChange4a_Ordering, SigChange4b_Ordering)
      names(Change_Rep_Df4a_Ordering)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Ordering)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Ordering[4] > Rep_Df$CI_Upper_Lim_Ordering[3] | Rep_Df$Score_Ordering[4] < Rep_Df$CI_Lower_Lim_Ordering[3]) {
        SigChange4c_Ordering<- paste(Rep_Df$Change_Ordering[4], "**")
      } else if(Rep_Df$Score_Ordering[4] < Rep_Df$CI_Upper_Lim_Ordering[3] & Rep_Df$Score_Ordering[4] > Rep_Df$CI_Lower_Lim_Ordering[3]) {
        SigChange4c_Ordering<- paste(Rep_Df$Change_Ordering[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Ordering<- data.frame(Time3, SigChange4c_Ordering)
      names(Change_Rep_Df4b_Ordering)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Ordering[2] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[2] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2], "**")
      } else if(Rep_Df$Score_Ordering[2] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[2] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange2_Ordering<- paste(Rep_Df$Change_Ordering[2])
      }
      
      if(Rep_Df$Score_Ordering[3] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[3] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange3_Ordering<- paste((Rep_Df$Score_Ordering[3] - Rep_Df$Score_Ordering[1]), "**")
      } else if(Rep_Df$Score_Ordering[3] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[3] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange3_Ordering<- paste((Rep_Df$Score_Ordering[3] - Rep_Df$Score_Ordering[1]))
      }
      
      if(Rep_Df$Score_Ordering[4] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[4] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange4_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[1]), "**")
      } else if(Rep_Df$Score_Ordering[4] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[4] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange4_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[1]))
      }
      
      if(Rep_Df$Score_Ordering[5] > Rep_Df$CI_Upper_Lim_Ordering[1] | Rep_Df$Score_Ordering[5] < Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange5_Ordering<- paste((Rep_Df$Score_Ordering[5] - Rep_Df$Score_Ordering[1]), "**")
      } else if(Rep_Df$Score_Ordering[5] < Rep_Df$CI_Upper_Lim_Ordering[1] & Rep_Df$Score_Ordering[5] > Rep_Df$CI_Lower_Lim_Ordering[1]) {
        SigChange5_Ordering<- paste((Rep_Df$Score_Ordering[5] - Rep_Df$Score_Ordering[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Ordering<- data.frame(Time1, SigChange2_Ordering, SigChange3_Ordering, SigChange4_Ordering, SigChange5_Ordering)
      names(Change_Rep_Df5_Ordering)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Ordering)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Ordering)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Ordering)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Ordering[3] > Rep_Df$CI_Upper_Lim_Ordering[2] | Rep_Df$Score_Ordering[3] < Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange5a_Ordering<- paste(Rep_Df$Change_Ordering[3], "**")
      } else if(Rep_Df$Score_Ordering[3] < Rep_Df$CI_Upper_Lim_Ordering[2] & Rep_Df$Score_Ordering[3] > Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange5a_Ordering<- paste(Rep_Df$Change_Ordering[3])
      }
      
      if(Rep_Df$Score_Ordering[4] > Rep_Df$CI_Upper_Lim_Ordering[2] | Rep_Df$Score_Ordering[4] < Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange5b_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[2]), "**")
      } else if(Rep_Df$Score_Ordering[4] < Rep_Df$CI_Upper_Lim_Ordering[2] & Rep_Df$Score_Ordering[4] > Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange5b_Ordering<- paste((Rep_Df$Score_Ordering[4] - Rep_Df$Score_Ordering[2]))
      }
      
      if(Rep_Df$Score_Ordering[5] > Rep_Df$CI_Upper_Lim_Ordering[2] | Rep_Df$Score_Ordering[5] < Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange5c_Ordering<- paste((Rep_Df$Score_Ordering[5] - Rep_Df$Score_Ordering[2]), "**")
      } else if(Rep_Df$Score_Ordering[5] < Rep_Df$CI_Upper_Lim_Ordering[2] & Rep_Df$Score_Ordering[5] > Rep_Df$CI_Lower_Lim_Ordering[2]) {
        SigChange5c_Ordering<- paste((Rep_Df$Score_Ordering[5] - Rep_Df$Score_Ordering[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Ordering<- data.frame(Time2, SigChange5a_Ordering, SigChange5b_Ordering, SigChange5c_Ordering)
      names(Change_Rep_Df5a_Ordering)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Ordering)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Ordering)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Ordering[4] > Rep_Df$CI_Upper_Lim_Ordering[3] | Rep_Df$Score_Ordering[4] < Rep_Df$CI_Lower_Lim_Ordering[3]) {
        SigChange5d_Ordering<- paste(Rep_Df$Change_Ordering[4], "**")
      } else if(Rep_Df$Score_Ordering[4] < Rep_Df$CI_Upper_Lim_Ordering[3] & Rep_Df$Score_Ordering[4] > Rep_Df$CI_Lower_Lim_Ordering[3]) {
        SigChange5d_Ordering<- paste(Rep_Df$Change_Ordering[4])
      }
      
      if(Rep_Df$Score_Ordering[5] > Rep_Df$CI_Upper_Lim_Ordering[3] | Rep_Df$Score_Ordering[5] < Rep_Df$CI_Lower_Lim_Ordering[3]) {
        SigChange5e_Ordering<- paste((Rep_Df$Score_Ordering[5] - Rep_Df$Score_Ordering[3]), "**")
      } else if(Rep_Df$Score_Ordering[5] < Rep_Df$CI_Upper_Lim_Ordering[3] & Rep_Df$Score_Ordering[5] > Rep_Df$CI_Lower_Lim_Ordering[3]) {
        SigChange5e_Ordering<- paste((Rep_Df$Score_Ordering[5] - Rep_Df$Score_Ordering[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Ordering<- data.frame(Time3, SigChange5d_Ordering, SigChange5e_Ordering)
      names(Change_Rep_Df5b_Ordering)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Ordering)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Ordering[5] > Rep_Df$CI_Upper_Lim_Ordering[4] | Rep_Df$Score_Ordering[5] < Rep_Df$CI_Lower_Lim_Ordering[4]) {
        SigChange5f_Ordering<- paste(Rep_Df$Change_Ordering[5], "**")
      } else if(Rep_Df$Score_Ordering[5] < Rep_Df$CI_Upper_Lim_Ordering[4] & Rep_Df$Score_Ordering[5] > Rep_Df$CI_Lower_Lim_Ordering[4]) {
        SigChange5f_Ordering<- paste(Rep_Df$Change_Ordering[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Ordering<- data.frame(Time4, SigChange5f_Ordering)
      names(Change_Rep_Df5c_Ordering)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Ordering, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Obsessing Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Obsessing<- Entered_Scores_Df[,c(1,38,39,40,41,42,43)]
names(Scores_Table_Obsessing)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Obsessing<- kable(Stats_Table_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Obsessing, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p6<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Obsessing, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Obsessing_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Obsessing_1[1],":",Entered_Scores_Df$Cutoff_Score_Obsessing_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Obsessing_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Obsessing_2[1],":",Entered_Scores_Df$Cutoff_Score_Obsessing_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Obsessing_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Obsessing_3[1],":",Entered_Scores_Df$Cutoff_Score_Obsessing_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Obsessing_1[1],":",Entered_Scores_Df$Cutoff_Score_Obsessing_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Obsessing_2[1],":",Entered_Scores_Df$Cutoff_Score_Obsessing_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Obsessing_3[1],":",Entered_Scores_Df$Cutoff_Score_Obsessing_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Obsessing, ymax=Entered_Scores_Df$CI_Upper_Lim_Obsessing), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Obsessing)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Obsessing)), size = 3, family = "AvantGarde")
  
p6<- p6+labs(x="Date", y = "Obsessing Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 17), breaks = c(0,2,4,6,8,10,12), labels = c('0 Min','2','4','6','8','10','12')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p6)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2], "**")
      } else if(Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Obsessing<- data.frame(Time1, SigChange2_Obsessing)
      names(Change_Rep_Df2_Obsessing)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2], "**")
      } else if(Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2])
      }
      
      if(Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange3_Obsessing<- paste((Rep_Df$Score_Obsessing[3] - Rep_Df$Score_Obsessing[1]), "**")
      } else if(Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange3_Obsessing<- paste((Rep_Df$Score_Obsessing[3] - Rep_Df$Score_Obsessing[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Obsessing<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Obsessing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Obsessing)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Upper_Lim_Obsessing[2] | Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange3a_Obsessing<- paste(Rep_Df$Change_Obsessing[3], "**")
      } else if(Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Upper_Lim_Obsessing[2] & Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange3a_Obsessing<- paste(Rep_Df$Change_Obsessing[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Obsessing<- data.frame(Time2, SigChange3a_Obsessing)
      names(Change_Rep_Df3a_Obsessing)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2], "**")
      } else if(Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2])
      }
      
      if(Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange3_Obsessing<- paste((Rep_Df$Score_Obsessing[3] - Rep_Df$Score_Obsessing[1]), "**")
      } else if(Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange3_Obsessing<- paste((Rep_Df$Score_Obsessing[3] - Rep_Df$Score_Obsessing[1]))
      }
      
      if(Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange4_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[1]), "**")
      } else if(Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange4_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Obsessing<- data.frame(Time1, SigChange2_Obsessing, SigChange3_Obsessing, SigChange4_Obsessing)
      names(Change_Rep_Df4_Obsessing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Obsessing)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Obsessing)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Upper_Lim_Obsessing[2] | Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange4a_Obsessing<- paste(Rep_Df$Change_Obsessing[3], "**")
      } else if(Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Upper_Lim_Obsessing[2] & Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange4a_Obsessing<- paste(Rep_Df$Change_Obsessing[3])
      }
      
      if(Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Upper_Lim_Obsessing[2] | Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange4b_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[2]), "**")
      } else if(Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Upper_Lim_Obsessing[2] & Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange4b_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Obsessing<- data.frame(Time2, SigChange4a_Obsessing, SigChange4b_Obsessing)
      names(Change_Rep_Df4a_Obsessing)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Obsessing)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Upper_Lim_Obsessing[3] | Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Lower_Lim_Obsessing[3]) {
        SigChange4c_Obsessing<- paste(Rep_Df$Change_Obsessing[4], "**")
      } else if(Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Upper_Lim_Obsessing[3] & Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Lower_Lim_Obsessing[3]) {
        SigChange4c_Obsessing<- paste(Rep_Df$Change_Obsessing[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Obsessing<- data.frame(Time3, SigChange4c_Obsessing)
      names(Change_Rep_Df4b_Obsessing)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2], "**")
      } else if(Rep_Df$Score_Obsessing[2] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[2] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange2_Obsessing<- paste(Rep_Df$Change_Obsessing[2])
      }
      
      if(Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange3_Obsessing<- paste((Rep_Df$Score_Obsessing[3] - Rep_Df$Score_Obsessing[1]), "**")
      } else if(Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange3_Obsessing<- paste((Rep_Df$Score_Obsessing[3] - Rep_Df$Score_Obsessing[1]))
      }
      
      if(Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange4_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[1]), "**")
      } else if(Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange4_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[1]))
      }
      
      if(Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Upper_Lim_Obsessing[1] | Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange5_Obsessing<- paste((Rep_Df$Score_Obsessing[5] - Rep_Df$Score_Obsessing[1]), "**")
      } else if(Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Upper_Lim_Obsessing[1] & Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Lower_Lim_Obsessing[1]) {
        SigChange5_Obsessing<- paste((Rep_Df$Score_Obsessing[5] - Rep_Df$Score_Obsessing[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Obsessing<- data.frame(Time1, SigChange2_Obsessing, SigChange3_Obsessing, SigChange4_Obsessing, SigChange5_Obsessing)
      names(Change_Rep_Df5_Obsessing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Obsessing)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Obsessing)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Obsessing)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Upper_Lim_Obsessing[2] | Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange5a_Obsessing<- paste(Rep_Df$Change_Obsessing[3], "**")
      } else if(Rep_Df$Score_Obsessing[3] < Rep_Df$CI_Upper_Lim_Obsessing[2] & Rep_Df$Score_Obsessing[3] > Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange5a_Obsessing<- paste(Rep_Df$Change_Obsessing[3])
      }
      
      if(Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Upper_Lim_Obsessing[2] | Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange5b_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[2]), "**")
      } else if(Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Upper_Lim_Obsessing[2] & Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange5b_Obsessing<- paste((Rep_Df$Score_Obsessing[4] - Rep_Df$Score_Obsessing[2]))
      }
      
      if(Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Upper_Lim_Obsessing[2] | Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange5c_Obsessing<- paste((Rep_Df$Score_Obsessing[5] - Rep_Df$Score_Obsessing[2]), "**")
      } else if(Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Upper_Lim_Obsessing[2] & Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Lower_Lim_Obsessing[2]) {
        SigChange5c_Obsessing<- paste((Rep_Df$Score_Obsessing[5] - Rep_Df$Score_Obsessing[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Obsessing<- data.frame(Time2, SigChange5a_Obsessing, SigChange5b_Obsessing, SigChange5c_Obsessing)
      names(Change_Rep_Df5a_Obsessing)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Obsessing)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Obsessing)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Upper_Lim_Obsessing[3] | Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Lower_Lim_Obsessing[3]) {
        SigChange5d_Obsessing<- paste(Rep_Df$Change_Obsessing[4], "**")
      } else if(Rep_Df$Score_Obsessing[4] < Rep_Df$CI_Upper_Lim_Obsessing[3] & Rep_Df$Score_Obsessing[4] > Rep_Df$CI_Lower_Lim_Obsessing[3]) {
        SigChange5d_Obsessing<- paste(Rep_Df$Change_Obsessing[4])
      }
      
      if(Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Upper_Lim_Obsessing[3] | Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Lower_Lim_Obsessing[3]) {
        SigChange5e_Obsessing<- paste((Rep_Df$Score_Obsessing[5] - Rep_Df$Score_Obsessing[3]), "**")
      } else if(Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Upper_Lim_Obsessing[3] & Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Lower_Lim_Obsessing[3]) {
        SigChange5e_Obsessing<- paste((Rep_Df$Score_Obsessing[5] - Rep_Df$Score_Obsessing[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Obsessing<- data.frame(Time3, SigChange5d_Obsessing, SigChange5e_Obsessing)
      names(Change_Rep_Df5b_Obsessing)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Obsessing)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Upper_Lim_Obsessing[4] | Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Lower_Lim_Obsessing[4]) {
        SigChange5f_Obsessing<- paste(Rep_Df$Change_Obsessing[5], "**")
      } else if(Rep_Df$Score_Obsessing[5] < Rep_Df$CI_Upper_Lim_Obsessing[4] & Rep_Df$Score_Obsessing[5] > Rep_Df$CI_Lower_Lim_Obsessing[4]) {
        SigChange5f_Obsessing<- paste(Rep_Df$Change_Obsessing[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Obsessing<- data.frame(Time4, SigChange5f_Obsessing)
      names(Change_Rep_Df5c_Obsessing)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Obsessing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Hoarding Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Hoarding<- Entered_Scores_Df[,c(1,47,48,49,50,51,52)]
names(Scores_Table_Hoarding)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA, fig.width=8}

Stats_Table_Hoarding<- kable(Stats_Table_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Hoarding, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p7<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Hoarding, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Hoarding_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Hoarding_1[1],":",Entered_Scores_Df$Cutoff_Score_Hoarding_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Hoarding_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Hoarding_2[1],":",Entered_Scores_Df$Cutoff_Score_Hoarding_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Hoarding_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Hoarding_3[1],":",Entered_Scores_Df$Cutoff_Score_Hoarding_3[1])), color = "#827717", size = 0.4)  + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Hoarding_1[1],":",Entered_Scores_Df$Cutoff_Score_Hoarding_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Hoarding_2[1],":",Entered_Scores_Df$Cutoff_Score_Hoarding_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Hoarding_3[1],":",Entered_Scores_Df$Cutoff_Score_Hoarding_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Hoarding, ymax=Entered_Scores_Df$CI_Upper_Lim_Hoarding), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Hoarding)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Hoarding)), size = 3, family = "AvantGarde") 
  
p7<- p7+labs(x="Date", y = "Hoarding Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 17), breaks = c(0,2,4,6,8,10,12),
                             labels = c('0 Min','2','4','6','8','10','12')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p7)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change_Hoarding[2], "**")
      } else if(Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change_Hoarding[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Hoarding<- data.frame(Time1, SigChange2_Hoarding)
      names(Change_Rep_Df2_Hoarding)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change_Hoarding[2], "**")
      } else if(Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change_Hoarding[2])
      }
      
      if(Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange3_Hoarding<- paste((Rep_Df$Score_Hoarding[3] - Rep_Df$Score_Hoarding[1]), "**")
      } else if(Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange3_Hoarding<- paste((Rep_Df$Score_Hoarding[3] - Rep_Df$Score_Hoarding[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Hoarding<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Hoarding)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Hoarding)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Upper_Lim_Hoarding[2] | Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange3a_Hoarding<- paste(Rep_Df$Change_Hoarding[3], "**")
      } else if(Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Upper_Lim_Hoarding[2] & Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange3a_Hoarding<- paste(Rep_Df$Change_Hoarding[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Hoarding<- data.frame(Time2, SigChange3a_Hoarding)
      names(Change_Rep_Df3a_Hoarding)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change_Hoarding[2], "**")
      } else if(Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change_Hoarding[2])
      }
      
      if(Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange3_Hoarding<- paste((Rep_Df$Score_Hoarding[3] - Rep_Df$Score_Hoarding[1]), "**")
      } else if(Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange3_Hoarding<- paste((Rep_Df$Score_Hoarding[3] - Rep_Df$Score_Hoarding[1]))
      }
      
      if(Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange4_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[1]), "**")
      } else if(Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange4_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Hoarding<- data.frame(Time1, SigChange2_Hoarding, SigChange3_Hoarding, SigChange4_Hoarding)
      names(Change_Rep_Df4_Hoarding)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Hoarding)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Hoarding)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Upper_Lim_Hoarding[2] | Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange4a_Hoarding<- paste(Rep_Df$Change_Hoarding[3], "**")
      } else if(Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Upper_Lim_Hoarding[2] & Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange4a_Hoarding<- paste(Rep_Df$Change_Hoarding[3])
      }
      
      if(Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Upper_Lim_Hoarding[2] | Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange4b_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[2]), "**")
      } else if(Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Upper_Lim_Hoarding[2] & Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange4b_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Hoarding<- data.frame(Time2, SigChange4a_Hoarding, SigChange4b_Hoarding)
      names(Change_Rep_Df4a_Hoarding)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Hoarding)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Upper_Lim_Hoarding[3] | Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Lower_Lim_Hoarding[3]) {
        SigChange4c_Hoarding<- paste(Rep_Df$Change_Hoarding[4], "**")
      } else if(Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Upper_Lim_Hoarding[3] & Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Lower_Lim_Hoarding[3]) {
        SigChange4c_Hoarding<- paste(Rep_Df$Change_Hoarding[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Hoarding<- data.frame(Time3, SigChange4c_Hoarding)
      names(Change_Rep_Df4b_Hoarding)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Hoarding[2] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[2] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange2_Hoarding<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange3_Hoarding<- paste((Rep_Df$Score_Hoarding[3] - Rep_Df$Score_Hoarding[1]), "**")
      } else if(Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange3_Hoarding<- paste((Rep_Df$Score_Hoarding[3] - Rep_Df$Score_Hoarding[1]))
      }
      
      if(Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange4_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[1]), "**")
      } else if(Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange4_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[1]))
      }
      
      if(Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Upper_Lim_Hoarding[1] | Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange5_Hoarding<- paste((Rep_Df$Score_Hoarding[5] - Rep_Df$Score_Hoarding[1]), "**")
      } else if(Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Upper_Lim_Hoarding[1] & Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Lower_Lim_Hoarding[1]) {
        SigChange5_Hoarding<- paste((Rep_Df$Score_Hoarding[5] - Rep_Df$Score_Hoarding[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Hoarding<- data.frame(Time1, SigChange2_Hoarding, SigChange3_Hoarding, SigChange4_Hoarding, SigChange5_Hoarding)
      names(Change_Rep_Df5_Hoarding)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Hoarding)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Hoarding)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Hoarding)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Upper_Lim_Hoarding[2] | Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange5a_Hoarding<- paste(Rep_Df$Change_Hoarding[3], "**")
      } else if(Rep_Df$Score_Hoarding[3] < Rep_Df$CI_Upper_Lim_Hoarding[2] & Rep_Df$Score_Hoarding[3] > Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange5a_Hoarding<- paste(Rep_Df$Change_Hoarding[3])
      }
      
      if(Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Upper_Lim_Hoarding[2] | Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange5b_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[2]), "**")
      } else if(Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Upper_Lim_Hoarding[2] & Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange5b_Hoarding<- paste((Rep_Df$Score_Hoarding[4] - Rep_Df$Score_Hoarding[2]))
      }
      
      if(Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Upper_Lim_Hoarding[2] | Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange5c_Hoarding<- paste((Rep_Df$Score_Hoarding[5] - Rep_Df$Score_Hoarding[2]), "**")
      } else if(Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Upper_Lim_Hoarding[2] & Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Lower_Lim_Hoarding[2]) {
        SigChange5c_Hoarding<- paste((Rep_Df$Score_Hoarding[5] - Rep_Df$Score_Hoarding[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Hoarding<- data.frame(Time2, SigChange5a_Hoarding, SigChange5b_Hoarding, SigChange5c_Hoarding)
      names(Change_Rep_Df5a_Hoarding)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Hoarding)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Hoarding)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Upper_Lim_Hoarding[3] | Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Lower_Lim_Hoarding[3]) {
        SigChange5d_Hoarding<- paste(Rep_Df$Change_Hoarding[4], "**")
      } else if(Rep_Df$Score_Hoarding[4] < Rep_Df$CI_Upper_Lim_Hoarding[3] & Rep_Df$Score_Hoarding[4] > Rep_Df$CI_Lower_Lim_Hoarding[3]) {
        SigChange5d_Hoarding<- paste(Rep_Df$Change_Hoarding[4])
      }
      
      if(Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Upper_Lim_Hoarding[3] | Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Lower_Lim_Hoarding[3]) {
        SigChange5e_Hoarding<- paste((Rep_Df$Score_Hoarding[5] - Rep_Df$Score_Hoarding[3]), "**")
      } else if(Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Upper_Lim_Hoarding[3] & Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Lower_Lim_Hoarding[3]) {
        SigChange5e_Hoarding<- paste((Rep_Df$Score_Hoarding[5] - Rep_Df$Score_Hoarding[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Hoarding<- data.frame(Time3, SigChange5d_Hoarding, SigChange5e_Hoarding)
      names(Change_Rep_Df5b_Hoarding)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Hoarding)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Upper_Lim_Hoarding[4] | Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Lower_Lim_Hoarding[4]) {
        SigChange5f_Hoarding<- paste(Rep_Df$Change_Hoarding[5], "**")
      } else if(Rep_Df$Score_Hoarding[5] < Rep_Df$CI_Upper_Lim_Hoarding[4] & Rep_Df$Score_Hoarding[5] > Rep_Df$CI_Lower_Lim_Hoarding[4]) {
        SigChange5f_Hoarding<- paste(Rep_Df$Change_Hoarding[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Hoarding<- data.frame(Time4, SigChange5f_Hoarding)
      names(Change_Rep_Df5c_Hoarding)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Hoarding, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Neutralizing Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Neutralizing<- Entered_Scores_Df[,c(1,56,57,58,59,60,61)]
names(Scores_Table_Neutralizing)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Neutralizing<- kable(Stats_Table_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Neutralizing, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Foa, Huppert, Leiberg, Langner, Kichic et al. (2002)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p8<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Neutralizing, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Neutralizing_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Neutralizing_1[1],":",Entered_Scores_Df$Cutoff_Score_Neutralizing_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Neutralizing_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Neutralizing_2[1],":",Entered_Scores_Df$Cutoff_Score_Neutralizing_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Neutralizing_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Neutralizing_3[1],":",Entered_Scores_Df$Cutoff_Score_Neutralizing_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Neutralizing_1[1],":",Entered_Scores_Df$Cutoff_Score_Neutralizing_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Neutralizing_2[1],":",Entered_Scores_Df$Cutoff_Score_Neutralizing_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Neutralizing_3[1],":",Entered_Scores_Df$Cutoff_Score_Neutralizing_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Neutralizing, ymax=Entered_Scores_Df$CI_Upper_Lim_Neutralizing), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Neutralizing)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Neutralizing)), size = 3, family = "AvantGarde")
  
p8<- p8+labs(x="Date", y = "Neutralizing Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 17), breaks = c(0,2,4,6,8,10,12), labels = c('0 Min','2','4','6','8','10','12 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p8)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2], "**")
      } else if(Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Neutralizing<- data.frame(Time1, SigChange2_Neutralizing)
      names(Change_Rep_Df2_Neutralizing)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2], "**")
      } else if(Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2])
      }
      
      if(Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange3_Neutralizing<- paste((Rep_Df$Score_Neutralizing[3] - Rep_Df$Score_Neutralizing[1]), "**")
      } else if(Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange3_Neutralizing<- paste((Rep_Df$Score_Neutralizing[3] - Rep_Df$Score_Neutralizing[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Neutralizing<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Neutralizing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Neutralizing)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Upper_Lim_Neutralizing[2] | Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange3a_Neutralizing<- paste(Rep_Df$Change_Neutralizing[3], "**")
      } else if(Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Upper_Lim_Neutralizing[2] & Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange3a_Neutralizing<- paste(Rep_Df$Change_Neutralizing[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Neutralizing<- data.frame(Time2, SigChange3a_Neutralizing)
      names(Change_Rep_Df3a_Neutralizing)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2], "**")
      } else if(Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2])
      }
      
      if(Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange3_Neutralizing<- paste((Rep_Df$Score_Neutralizing[3] - Rep_Df$Score_Neutralizing[1]), "**")
      } else if(Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange3_Neutralizing<- paste((Rep_Df$Score_Neutralizing[3] - Rep_Df$Score_Neutralizing[1]))
      }
      
      if(Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange4_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[1]), "**")
      } else if(Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange4_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Neutralizing<- data.frame(Time1, SigChange2_Neutralizing, SigChange3_Neutralizing, SigChange4_Neutralizing)
      names(Change_Rep_Df4_Neutralizing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Neutralizing)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Neutralizing)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Upper_Lim_Neutralizing[2] | Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange4a_Neutralizing<- paste(Rep_Df$Change_Neutralizing[3], "**")
      } else if(Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Upper_Lim_Neutralizing[2] & Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange4a_Neutralizing<- paste(Rep_Df$Change_Neutralizing[3])
      }
      
      if(Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Upper_Lim_Neutralizing[2] | Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange4b_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[2]), "**")
      } else if(Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Upper_Lim_Neutralizing[2] & Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange4b_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Neutralizing<- data.frame(Time2, SigChange4a_Neutralizing, SigChange4b_Neutralizing)
      names(Change_Rep_Df4a_Neutralizing)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Neutralizing)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Upper_Lim_Neutralizing[3] | Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Lower_Lim_Neutralizing[3]) {
        SigChange4c_Neutralizing<- paste(Rep_Df$Change_Neutralizing[4], "**")
      } else if(Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Upper_Lim_Neutralizing[3] & Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Lower_Lim_Neutralizing[3]) {
        SigChange4c_Neutralizing<- paste(Rep_Df$Change_Neutralizing[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Neutralizing<- data.frame(Time3, SigChange4c_Neutralizing)
      names(Change_Rep_Df4b_Neutralizing)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2], "**")
      } else if(Rep_Df$Score_Neutralizing[2] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[2] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange2_Neutralizing<- paste(Rep_Df$Change_Neutralizing[2])
      }
      
      if(Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange3_Neutralizing<- paste((Rep_Df$Score_Neutralizing[3] - Rep_Df$Score_Neutralizing[1]), "**")
      } else if(Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange3_Neutralizing<- paste((Rep_Df$Score_Neutralizing[3] - Rep_Df$Score_Neutralizing[1]))
      }
      
      if(Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange4_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[1]), "**")
      } else if(Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange4_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[1]))
      }
      
      if(Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Upper_Lim_Neutralizing[1] | Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange5_Neutralizing<- paste((Rep_Df$Score_Neutralizing[5] - Rep_Df$Score_Neutralizing[1]), "**")
      } else if(Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Upper_Lim_Neutralizing[1] & Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Lower_Lim_Neutralizing[1]) {
        SigChange5_Neutralizing<- paste((Rep_Df$Score_Neutralizing[5] - Rep_Df$Score_Neutralizing[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Neutralizing<- data.frame(Time1, SigChange2_Neutralizing, SigChange3_Neutralizing, SigChange4_Neutralizing, SigChange5_Neutralizing)
      names(Change_Rep_Df5_Neutralizing)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Neutralizing)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Neutralizing)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Neutralizing)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Upper_Lim_Neutralizing[2] | Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange5a_Neutralizing<- paste(Rep_Df$Change_Neutralizing[3], "**")
      } else if(Rep_Df$Score_Neutralizing[3] < Rep_Df$CI_Upper_Lim_Neutralizing[2] & Rep_Df$Score_Neutralizing[3] > Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange5a_Neutralizing<- paste(Rep_Df$Change_Neutralizing[3])
      }
      
      if(Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Upper_Lim_Neutralizing[2] | Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange5b_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[2]), "**")
      } else if(Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Upper_Lim_Neutralizing[2] & Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange5b_Neutralizing<- paste((Rep_Df$Score_Neutralizing[4] - Rep_Df$Score_Neutralizing[2]))
      }
      
      if(Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Upper_Lim_Neutralizing[2] | Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange5c_Neutralizing<- paste((Rep_Df$Score_Neutralizing[5] - Rep_Df$Score_Neutralizing[2]), "**")
      } else if(Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Upper_Lim_Neutralizing[2] & Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Lower_Lim_Neutralizing[2]) {
        SigChange5c_Neutralizing<- paste((Rep_Df$Score_Neutralizing[5] - Rep_Df$Score_Neutralizing[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Neutralizing<- data.frame(Time2, SigChange5a_Neutralizing, SigChange5b_Neutralizing, SigChange5c_Neutralizing)
      names(Change_Rep_Df5a_Neutralizing)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Neutralizing)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Neutralizing)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Upper_Lim_Neutralizing[3] | Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Lower_Lim_Neutralizing[3]) {
        SigChange5d_Neutralizing<- paste(Rep_Df$Change_Neutralizing[4], "**")
      } else if(Rep_Df$Score_Neutralizing[4] < Rep_Df$CI_Upper_Lim_Neutralizing[3] & Rep_Df$Score_Neutralizing[4] > Rep_Df$CI_Lower_Lim_Neutralizing[3]) {
        SigChange5d_Neutralizing<- paste(Rep_Df$Change_Neutralizing[4])
      }
      
      if(Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Upper_Lim_Neutralizing[3] | Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Lower_Lim_Neutralizing[3]) {
        SigChange5e_Neutralizing<- paste((Rep_Df$Score_Neutralizing[5] - Rep_Df$Score_Neutralizing[3]), "**")
      } else if(Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Upper_Lim_Neutralizing[3] & Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Lower_Lim_Neutralizing[3]) {
        SigChange5e_Neutralizing<- paste((Rep_Df$Score_Neutralizing[5] - Rep_Df$Score_Neutralizing[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Neutralizing<- data.frame(Time3, SigChange5d_Neutralizing, SigChange5e_Neutralizing)
      names(Change_Rep_Df5b_Neutralizing)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Neutralizing)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Upper_Lim_Neutralizing[4] | Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Lower_Lim_Neutralizing[4]) {
        SigChange5f_Neutralizing<- paste(Rep_Df$Change_Neutralizing[5], "**")
      } else if(Rep_Df$Score_Neutralizing[5] < Rep_Df$CI_Upper_Lim_Neutralizing[4] & Rep_Df$Score_Neutralizing[5] > Rep_Df$CI_Lower_Lim_Neutralizing[4]) {
        SigChange5f_Neutralizing<- paste(Rep_Df$Change_Neutralizing[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Neutralizing<- data.frame(Time4, SigChange5f_Neutralizing)
      names(Change_Rep_Df5c_Neutralizing)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Neutralizing, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Most Recent Item Scores

#`r Scores_Table[nrow(Scores_Table),1]`

```{r,echo=FALSE,warning=FALSE,comment=NA}

kable(Item_Df, format = "latex", booktabs = T) %>% kable_styling(position = "left", full_width = T, font_size = 12, latex_options = "striped") %>% row_spec(0, bold = T)
```

\newpage

\begingroup\Large

\begin{center} \textbf{Information About the Obsessive Compulsive Inventory - Revised (OCI-R)} \end{center} 

#What it Measures: 

* Emotional, cognitive and behavioural symptoms of Obsessive Compulsive Disorder (OCD). The seven symptom-categories of the scale are described below (subscale names appear bold in parentheses).

* Concerns about contamination and self-cleaning compulsions **(Washing)**. 

* Compulsions involving checking, such as verifying that electical devices have been turned off **(Checking)**,

* Distress about objects being inproperly arranged **(Ordering)**.

* Difficulty with intrusive, negative thoughts **(Obsessing)**. 

* Hoarding behaviours **(Hoarding)**. 

* Attaching significance to certain numbers or feeling compelled to use numeric repetition/counting to alleviate fears/anxiety during activities **(Neutralizing)**. 


#What Higher Scores Mean:

* More severe OCD symptomatology. 

* An elevated total score may occur because the patient has scored highly within a single symptom-category (e.g. washing). Thus, a higher total score **does not** necessarily indicate the presence of OCD symptoms across multiple symptom-categories. 

* An elevated total score **does not** necessarily imply high levels of functional impairment. 

* The scale's developers have recommended a cut-off score of **21** to indicate the likely presence of Obsessive Compulsive Disorder. 

* A cut-off score of **7** on the Hoarding subscale has been advocated to indicate the likely presence of Hoarding Disorder (Wooton et al., 2015). 


#Scale Quality:

* Reviews comparing self-report measures for OCD have strongly endorsed the use of the OCI-R as a screening and treatment-monitoring instrument (see Rapp, Bergman, Piacentini & McGuire, 2016; Storch, Benito & Goodman, 2011). 

* The OCI-R has performed well in several psychometric validation studies (Huppert et al., 2007; Wooton et al., 2015). 

#Scale Structure:

* Contains 18 items spread across 7 subscales.

* 5-point Likert scale.

* Respondents rate how much they have been bothered or distressed by each symptom during the past month (0 = "Not at all"; 4 = "Extremely"). 

* Psychometric evaluations have suggested that the OCI-R displays a 6-factor structure, corresponding to the 6 subscales listed above (Foa et al., 2002; Huppert et al., 2007). 

\endgroup