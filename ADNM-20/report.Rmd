---
title: "Adjustment Disorder New Module - 20 (ADNM-20)"
author: "Report generated by PsychlytX"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
PN: 'NULL' 
CN: 'NULL'
Tab_Reference: 'NULL'
Stats_Table_Fullscale: 'NULL'
Stats_Table_Preoccupations: 'NULL'
Stats_Table_Failure_To_Adapt: 'NULL'
Stats_Table_Depressive_Mood: 'NULL'
Stats_Table_Anxiety: 'NULL'
Stats_Table_Impulse_Control: 'NULL'
Stats_Table_Avoidance: 'NULL'
Entered_Scores_Df: 'NULL'
Cutoff_Names: 'NULL'
Item_Df: 'NULL'
Event_Df: 'NULL'
Straining_Event: 'NULL'
subtitle: '**Patient:** `r PN` **|** **Clinician:** `r CN`'
---

```{r,echo = FALSE,warning=FALSE,comment = NA}
knitr::opts_chunk$set(fig.width=7,fig.height=3) 

```

#ADNM-20 Total Scale 

##Response Summary

```{r,echo=FALSE,warning=FALSE,comment=NA}
Scores_Table<- Entered_Scores_Df[,c(1,2,3,4,5,6,7)]
names(Scores_Table)<- c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```


##Data Employed in Reliable Change Analyses

```{r,echo=FALSE,warning=FALSE,comment=NA}

Stats_Table_Fullscale<- kable(Stats_Table_Fullscale, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Fullscale, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Bachem & Maercker (2016)")), notation = "number")
```


##Trend

```{r,echo=FALSE,warning=FALSE,comment=FALSE,message=FALSE, fig.width=8}
 p1<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_4[1], linetype = paste(Cutoff_Names$Cutoff_Name_4[1],":",Entered_Scores_Df$Cutoff_Score_4[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("8f","1f","11","solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1]),
          paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1]),
          paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1]),
           paste(Cutoff_Names$Cutoff_Name_4[1],":",Entered_Scores_Df$Cutoff_Score_4[1])
          )) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim, ymax=Entered_Scores_Df$CI_Upper_Lim), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde", face = "bold") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score)), size = 3, family = "AvantGarde", face = "bold") 
                        
p1<- p1+labs(x="Date", y = "Total ADNM-20 Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-10, 90), breaks = c(20,30,40,50,60,70,80), labels = c('20 Min','30','40','50','60','70','80 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde"))
print(p1)
```

##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by ** 
```{r, echo = FALSE, warning = FALSE,comment=NA, message=FALSE}

if(length(Entered_Scores_Df$Date) == 2) {  

Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2<- data.frame(Time1, SigChange2)
      names(Change_Rep_Df2)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a<- data.frame(Time2, SigChange3a)
      names(Change_Rep_Df3a)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4<- data.frame(Time1, SigChange2, SigChange3, SigChange4)
      names(Change_Rep_Df4)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a<- data.frame(Time2, SigChange4a, SigChange4b)
      names(Change_Rep_Df4a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b<- data.frame(Time3, SigChange4c)
      names(Change_Rep_Df4b)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE, comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5<- data.frame(Time1, SigChange2, SigChange3, SigChange4, SigChange5)
      names(Change_Rep_Df5)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a<- data.frame(Time2, SigChange5a, SigChange5b, SigChange5c)
      names(Change_Rep_Df5a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4])
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b<- data.frame(Time3, SigChange5d, SigChange5e)
      names(Change_Rep_Df5b)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[4] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5], "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[4] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c<- data.frame(Time4, SigChange5f)
      names(Change_Rep_Df5c)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Preoccupations Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Preoccupations<- Entered_Scores_Df[,c(1,11,12,13,14,15,16)]
names(Scores_Table_Preoccupations)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Preoccupations<- kable(Stats_Table_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Preoccupations, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Bachem & Maercker (2016)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p2<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Preoccupations, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Preoccupations_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Preoccupations_1[1],":",Entered_Scores_Df$Cutoff_Score_Preoccupations_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Preoccupations_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Preoccupations_2[1],":",Entered_Scores_Df$Cutoff_Score_Preoccupations_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Preoccupations_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Preoccupations_3[1],":",Entered_Scores_Df$Cutoff_Score_Preoccupations_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Preoccupations_1[1],":",Entered_Scores_Df$Cutoff_Score_Preoccupations_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Preoccupations_2[1],":",Entered_Scores_Df$Cutoff_Score_Preoccupations_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Preoccupations_3[1],":",Entered_Scores_Df$Cutoff_Score_Preoccupations_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Preoccupations, ymax=Entered_Scores_Df$CI_Upper_Lim_Preoccupations), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Preoccupations)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Preoccupations)), size = 3, family = "AvantGarde")  
  
p2<- p2+labs(x="Date", y = "Preoccupations Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-6, 26), breaks = c(4,6,8,10,12,14,16), labels = c('4 Min','6','8','10','12','14','16 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p2)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2], "**")
      } else if(Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Preoccupations<- data.frame(Time1, SigChange2_Preoccupations)
      names(Change_Rep_Df2_Preoccupations)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2], "**")
      } else if(Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2])
      }
      
      if(Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange3_Preoccupations<- paste((Rep_Df$Score_Preoccupations[3] - Rep_Df$Score_Preoccupations[1]), "**")
      } else if(Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange3_Preoccupations<- paste((Rep_Df$Score_Preoccupations[3] - Rep_Df$Score_Preoccupations[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Preoccupations<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Preoccupations)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Preoccupations)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Upper_Lim_Preoccupations[2] | Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange3a_Preoccupations<- paste(Rep_Df$Change_Preoccupations[3], "**")
      } else if(Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Upper_Lim_Preoccupations[2] & Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange3a_Preoccupations<- paste(Rep_Df$Change_Preoccupations[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Preoccupations<- data.frame(Time2, SigChange3a_Preoccupations)
      names(Change_Rep_Df3a_Preoccupations)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2], "**")
      } else if(Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2])
      }
      
      if(Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange3_Preoccupations<- paste((Rep_Df$Score_Preoccupations[3] - Rep_Df$Score_Preoccupations[1]), "**")
      } else if(Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange3_Preoccupations<- paste((Rep_Df$Score_Preoccupations[3] - Rep_Df$Score_Preoccupations[1]))
      }
      
      if(Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange4_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[1]), "**")
      } else if(Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange4_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Preoccupations<- data.frame(Time1, SigChange2_Preoccupations, SigChange3_Preoccupations, SigChange4_Preoccupations)
      names(Change_Rep_Df4_Preoccupations)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Preoccupations)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Preoccupations)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Upper_Lim_Preoccupations[2] | Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange4a_Preoccupations<- paste(Rep_Df$Change_Preoccupations[3], "**")
      } else if(Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Upper_Lim_Preoccupations[2] & Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange4a_Preoccupations<- paste(Rep_Df$Change_Preoccupations[3])
      }
      
      if(Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Upper_Lim_Preoccupations[2] | Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange4b_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[2]), "**")
      } else if(Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Upper_Lim_Preoccupations[2] & Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange4b_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Preoccupations<- data.frame(Time2, SigChange4a_Preoccupations, SigChange4b_Preoccupations)
      names(Change_Rep_Df4a_Preoccupations)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Preoccupations)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Upper_Lim_Preoccupations[3] | Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Lower_Lim_Preoccupations[3]) {
        SigChange4c_Preoccupations<- paste(Rep_Df$Change_Preoccupations[4], "**")
      } else if(Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Upper_Lim_Preoccupations[3] & Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Lower_Lim_Preoccupations[3]) {
        SigChange4c_Preoccupations<- paste(Rep_Df$Change_Preoccupations[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Preoccupations<- data.frame(Time3, SigChange4c_Preoccupations)
      names(Change_Rep_Df4b_Preoccupations)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2], "**")
      } else if(Rep_Df$Score_Preoccupations[2] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[2] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange2_Preoccupations<- paste(Rep_Df$Change_Preoccupations[2])
      }
      
      if(Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange3_Preoccupations<- paste((Rep_Df$Score_Preoccupations[3] - Rep_Df$Score_Preoccupations[1]), "**")
      } else if(Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange3_Preoccupations<- paste((Rep_Df$Score_Preoccupations[3] - Rep_Df$Score_Preoccupations[1]))
      }
      
      if(Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange4_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[1]), "**")
      } else if(Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange4_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[1]))
      }
      
      if(Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Upper_Lim_Preoccupations[1] | Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange5_Preoccupations<- paste((Rep_Df$Score_Preoccupations[5] - Rep_Df$Score_Preoccupations[1]), "**")
      } else if(Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Upper_Lim_Preoccupations[1] & Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Lower_Lim_Preoccupations[1]) {
        SigChange5_Preoccupations<- paste((Rep_Df$Score_Preoccupations[5] - Rep_Df$Score_Preoccupations[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Preoccupations<- data.frame(Time1, SigChange2_Preoccupations, SigChange3_Preoccupations, SigChange4_Preoccupations, SigChange5_Preoccupations)
      names(Change_Rep_Df5_Preoccupations)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Preoccupations)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Preoccupations)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Preoccupations)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Upper_Lim_Preoccupations[2] | Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange5a_Preoccupations<- paste(Rep_Df$Change_Preoccupations[3], "**")
      } else if(Rep_Df$Score_Preoccupations[3] < Rep_Df$CI_Upper_Lim_Preoccupations[2] & Rep_Df$Score_Preoccupations[3] > Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange5a_Preoccupations<- paste(Rep_Df$Change_Preoccupations[3])
      }
      
      if(Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Upper_Lim_Preoccupations[2] | Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange5b_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[2]), "**")
      } else if(Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Upper_Lim_Preoccupations[2] & Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange5b_Preoccupations<- paste((Rep_Df$Score_Preoccupations[4] - Rep_Df$Score_Preoccupations[2]))
      }
      
      if(Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Upper_Lim_Preoccupations[2] | Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange5c_Preoccupations<- paste((Rep_Df$Score_Preoccupations[5] - Rep_Df$Score_Preoccupations[2]), "**")
      } else if(Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Upper_Lim_Preoccupations[2] & Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Lower_Lim_Preoccupations[2]) {
        SigChange5c_Preoccupations<- paste((Rep_Df$Score_Preoccupations[5] - Rep_Df$Score_Preoccupations[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Preoccupations<- data.frame(Time2, SigChange5a_Preoccupations, SigChange5b_Preoccupations, SigChange5c_Preoccupations)
      names(Change_Rep_Df5a_Preoccupations)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Preoccupations)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Preoccupations)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Upper_Lim_Preoccupations[3] | Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Lower_Lim_Preoccupations[3]) {
        SigChange5d_Preoccupations<- paste(Rep_Df$Change_Preoccupations[4], "**")
      } else if(Rep_Df$Score_Preoccupations[4] < Rep_Df$CI_Upper_Lim_Preoccupations[3] & Rep_Df$Score_Preoccupations[4] > Rep_Df$CI_Lower_Lim_Preoccupations[3]) {
        SigChange5d_Preoccupations<- paste(Rep_Df$Change_Preoccupations[4])
      }
      
      if(Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Upper_Lim_Preoccupations[3] | Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Lower_Lim_Preoccupations[3]) {
        SigChange5e_Preoccupations<- paste((Rep_Df$Score_Preoccupations[5] - Rep_Df$Score_Preoccupations[3]), "**")
      } else if(Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Upper_Lim_Preoccupations[3] & Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Lower_Lim_Preoccupations[3]) {
        SigChange5e_Preoccupations<- paste((Rep_Df$Score_Preoccupations[5] - Rep_Df$Score_Preoccupations[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Preoccupations<- data.frame(Time3, SigChange5d_Preoccupations, SigChange5e_Preoccupations)
      names(Change_Rep_Df5b_Preoccupations)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Preoccupations)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Upper_Lim_Preoccupations[4] | Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Lower_Lim_Preoccupations[4]) {
        SigChange5f_Preoccupations<- paste(Rep_Df$Change_Preoccupations[5], "**")
      } else if(Rep_Df$Score_Preoccupations[5] < Rep_Df$CI_Upper_Lim_Preoccupations[4] & Rep_Df$Score_Preoccupations[5] > Rep_Df$CI_Lower_Lim_Preoccupations[4]) {
        SigChange5f_Preoccupations<- paste(Rep_Df$Change_Preoccupations[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Preoccupations<- data.frame(Time4, SigChange5f_Preoccupations)
      names(Change_Rep_Df5c_Preoccupations)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Preoccupations, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Failure To Adapt Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Failure_To_Adapt<- Entered_Scores_Df[,c(1,20,21,22,23,24,25)]
names(Scores_Table_Failure_To_Adapt)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Failure_To_Adapt<- kable(Stats_Table_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Failure_To_Adapt, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Bachem & Maercker (2016)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p3<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Failure_To_Adapt, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Failure_To_Adapt_1[1],":",Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Failure_To_Adapt_2[1],":",Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Failure_To_Adapt_3[1],":",Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Failure_To_Adapt_1[1],":",Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Failure_To_Adapt_2[1],":",Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Failure_To_Adapt_3[1],":",Entered_Scores_Df$Cutoff_Score_Failure_To_Adapt_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Failure_To_Adapt, ymax=Entered_Scores_Df$CI_Upper_Lim_Failure_To_Adapt), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Failure_To_Adapt)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Failure_To_Adapt)), size = 3, family = "AvantGarde") 
  
p3<- p3+labs(x="Date", y = "Failure To Adapt Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-6, 26), breaks = c(4,6,8,10,12,14,16), labels = c('4 Min','6','8','10','12','14','16 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p3)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[2], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Failure_To_Adapt<- data.frame(Time1, SigChange2_Failure_To_Adapt)
      names(Change_Rep_Df2_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[2], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[2])
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange3_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[3] - Rep_Df$Score_Failure_To_Adapt[1]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange3_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[3] - Rep_Df$Score_Failure_To_Adapt[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Failure_To_Adapt<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Failure_To_Adapt)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] | Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange3a_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[3], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] & Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange3a_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Failure_To_Adapt<- data.frame(Time2, SigChange3a_Failure_To_Adapt)
      names(Change_Rep_Df3a_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[2], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[2])
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange3_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[3] - Rep_Df$Score_Failure_To_Adapt[1]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange3_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[3] - Rep_Df$Score_Failure_To_Adapt[1]))
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange4_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[1]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange4_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Failure_To_Adapt<- data.frame(Time1, SigChange2_Failure_To_Adapt, SigChange3_Failure_To_Adapt, SigChange4_Failure_To_Adapt)
      names(Change_Rep_Df4_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Failure_To_Adapt)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Failure_To_Adapt)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] | Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange4a_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[3], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] & Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange4a_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[3])
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] | Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange4b_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[2]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] & Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange4b_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Failure_To_Adapt<- data.frame(Time2, SigChange4a_Failure_To_Adapt, SigChange4b_Failure_To_Adapt)
      names(Change_Rep_Df4a_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Failure_To_Adapt)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[3] | Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[3]) {
        SigChange4c_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[4], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[3] & Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[3]) {
        SigChange4c_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Failure_To_Adapt<- data.frame(Time3, SigChange4c_Failure_To_Adapt)
      names(Change_Rep_Df4b_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[2] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[2] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange2_Failure_To_Adapt<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange3_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[3] - Rep_Df$Score_Failure_To_Adapt[1]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange3_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[3] - Rep_Df$Score_Failure_To_Adapt[1]))
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange4_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[1]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange4_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[1]))
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] | Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange5_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[5] - Rep_Df$Score_Failure_To_Adapt[1]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[1] & Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[1]) {
        SigChange5_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[5] - Rep_Df$Score_Failure_To_Adapt[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Failure_To_Adapt<- data.frame(Time1, SigChange2_Failure_To_Adapt, SigChange3_Failure_To_Adapt, SigChange4_Failure_To_Adapt, SigChange5_Failure_To_Adapt)
      names(Change_Rep_Df5_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Failure_To_Adapt)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Failure_To_Adapt)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Failure_To_Adapt)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] | Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange5a_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[3], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[3] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] & Rep_Df$Score_Failure_To_Adapt[3] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange5a_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[3])
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] | Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange5b_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[2]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] & Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange5b_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[4] - Rep_Df$Score_Failure_To_Adapt[2]))
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] | Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange5c_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[5] - Rep_Df$Score_Failure_To_Adapt[2]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[2] & Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[2]) {
        SigChange5c_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[5] - Rep_Df$Score_Failure_To_Adapt[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Failure_To_Adapt<- data.frame(Time2, SigChange5a_Failure_To_Adapt, SigChange5b_Failure_To_Adapt, SigChange5c_Failure_To_Adapt)
      names(Change_Rep_Df5a_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Failure_To_Adapt)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Failure_To_Adapt)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[3] | Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[3]) {
        SigChange5d_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[4], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[4] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[3] & Rep_Df$Score_Failure_To_Adapt[4] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[3]) {
        SigChange5d_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[4])
      }
      
      if(Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[3] | Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[3]) {
        SigChange5e_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[5] - Rep_Df$Score_Failure_To_Adapt[3]), "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[3] & Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[3]) {
        SigChange5e_Failure_To_Adapt<- paste((Rep_Df$Score_Failure_To_Adapt[5] - Rep_Df$Score_Failure_To_Adapt[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Failure_To_Adapt<- data.frame(Time3, SigChange5d_Failure_To_Adapt, SigChange5e_Failure_To_Adapt)
      names(Change_Rep_Df5b_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Failure_To_Adapt)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Upper_Lim_Failure_To_Adapt[4] | Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Lower_Lim_Failure_To_Adapt[4]) {
        SigChange5f_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[5], "**")
      } else if(Rep_Df$Score_Failure_To_Adapt[5] < Rep_Df$CI_Upper_Lim_Failure_To_Adapt[4] & Rep_Df$Score_Failure_To_Adapt[5] > Rep_Df$CI_Lower_Lim_Failure_To_Adapt[4]) {
        SigChange5f_Failure_To_Adapt<- paste(Rep_Df$Change_Failure_To_Adapt[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Failure_To_Adapt<- data.frame(Time4, SigChange5f_Failure_To_Adapt)
      names(Change_Rep_Df5c_Failure_To_Adapt)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Failure_To_Adapt, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Depressive Mood Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Depressive_Mood<- Entered_Scores_Df[,c(1,29,30,31,32,33,34)]
names(Scores_Table_Depressive_Mood)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Depressive_Mood<- kable(Stats_Table_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Depressive_Mood, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Einsle, Köllner, Dannermann & Maercker (2010)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p4<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Depressive_Mood, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Depressive_Mood_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Depressive_Mood_1[1],":",Entered_Scores_Df$Cutoff_Score_Depressive_Mood_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Depressive_Mood_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Depressive_Mood_2[1],":",Entered_Scores_Df$Cutoff_Score_Depressive_Mood_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Depressive_Mood_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Depressive_Mood_3[1],":",Entered_Scores_Df$Cutoff_Score_Depressive_Mood_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Depressive_Mood_1[1],":",Entered_Scores_Df$Cutoff_Score_Depressive_Mood_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Depressive_Mood_2[1],":",Entered_Scores_Df$Cutoff_Score_Depressive_Mood_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Depressive_Mood_3[1],":",Entered_Scores_Df$Cutoff_Score_Depressive_Mood_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Depressive_Mood, ymax=Entered_Scores_Df$CI_Upper_Lim_Depressive_Mood), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Depressive_Mood)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Depressive_Mood)), size = 3, family = "AvantGarde") 
  
p4<- p4+labs(x="Date", y = "Depressive Mood Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-6, 22), breaks = c(4,6,8,10,12), labels = c('4 Min','6','8','10','12 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p4)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2], "**")
      } else if(Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Depressive_Mood<- data.frame(Time1, SigChange2_Depressive_Mood)
      names(Change_Rep_Df2_Depressive_Mood)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2], "**")
      } else if(Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2])
      }
      
      if(Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange3_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[3] - Rep_Df$Score_Depressive_Mood[1]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange3_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[3] - Rep_Df$Score_Depressive_Mood[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Depressive_Mood<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Depressive_Mood)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Depressive_Mood)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Upper_Lim_Depressive_Mood[2] | Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange3a_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[3], "**")
      } else if(Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Upper_Lim_Depressive_Mood[2] & Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange3a_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Depressive_Mood<- data.frame(Time2, SigChange3a_Depressive_Mood)
      names(Change_Rep_Df3a_Depressive_Mood)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2], "**")
      } else if(Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2])
      }
      
      if(Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange3_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[3] - Rep_Df$Score_Depressive_Mood[1]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange3_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[3] - Rep_Df$Score_Depressive_Mood[1]))
      }
      
      if(Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange4_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[1]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange4_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Depressive_Mood<- data.frame(Time1, SigChange2_Depressive_Mood, SigChange3_Depressive_Mood, SigChange4_Depressive_Mood)
      names(Change_Rep_Df4_Depressive_Mood)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Depressive_Mood)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Depressive_Mood)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Upper_Lim_Depressive_Mood[2] | Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange4a_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[3], "**")
      } else if(Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Upper_Lim_Depressive_Mood[2] & Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange4a_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[3])
      }
      
      if(Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Upper_Lim_Depressive_Mood[2] | Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange4b_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[2]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Upper_Lim_Depressive_Mood[2] & Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange4b_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Depressive_Mood<- data.frame(Time2, SigChange4a_Depressive_Mood, SigChange4b_Depressive_Mood)
      names(Change_Rep_Df4a_Depressive_Mood)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Depressive_Mood)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Upper_Lim_Depressive_Mood[3] | Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Lower_Lim_Depressive_Mood[3]) {
        SigChange4c_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[4], "**")
      } else if(Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Upper_Lim_Depressive_Mood[3] & Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Lower_Lim_Depressive_Mood[3]) {
        SigChange4c_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Depressive_Mood<- data.frame(Time3, SigChange4c_Depressive_Mood)
      names(Change_Rep_Df4b_Depressive_Mood)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2], "**")
      } else if(Rep_Df$Score_Depressive_Mood[2] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[2] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange2_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[2])
      }
      
      if(Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange3_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[3] - Rep_Df$Score_Depressive_Mood[1]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange3_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[3] - Rep_Df$Score_Depressive_Mood[1]))
      }
      
      if(Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange4_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[1]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange4_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[1]))
      }
      
      if(Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Upper_Lim_Depressive_Mood[1] | Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange5_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[5] - Rep_Df$Score_Depressive_Mood[1]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Upper_Lim_Depressive_Mood[1] & Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Lower_Lim_Depressive_Mood[1]) {
        SigChange5_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[5] - Rep_Df$Score_Depressive_Mood[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Depressive_Mood<- data.frame(Time1, SigChange2_Depressive_Mood, SigChange3_Depressive_Mood, SigChange4_Depressive_Mood, SigChange5_Depressive_Mood)
      names(Change_Rep_Df5_Depressive_Mood)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Depressive_Mood)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Depressive_Mood)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Depressive_Mood)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Upper_Lim_Depressive_Mood[2] | Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange5a_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[3], "**")
      } else if(Rep_Df$Score_Depressive_Mood[3] < Rep_Df$CI_Upper_Lim_Depressive_Mood[2] & Rep_Df$Score_Depressive_Mood[3] > Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange5a_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[3])
      }
      
      if(Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Upper_Lim_Depressive_Mood[2] | Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange5b_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[2]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Upper_Lim_Depressive_Mood[2] & Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange5b_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[4] - Rep_Df$Score_Depressive_Mood[2]))
      }
      
      if(Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Upper_Lim_Depressive_Mood[2] | Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange5c_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[5] - Rep_Df$Score_Depressive_Mood[2]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Upper_Lim_Depressive_Mood[2] & Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Lower_Lim_Depressive_Mood[2]) {
        SigChange5c_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[5] - Rep_Df$Score_Depressive_Mood[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Depressive_Mood<- data.frame(Time2, SigChange5a_Depressive_Mood, SigChange5b_Depressive_Mood, SigChange5c_Depressive_Mood)
      names(Change_Rep_Df5a_Depressive_Mood)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Depressive_Mood)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Depressive_Mood)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Upper_Lim_Depressive_Mood[3] | Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Lower_Lim_Depressive_Mood[3]) {
        SigChange5d_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[4], "**")
      } else if(Rep_Df$Score_Depressive_Mood[4] < Rep_Df$CI_Upper_Lim_Depressive_Mood[3] & Rep_Df$Score_Depressive_Mood[4] > Rep_Df$CI_Lower_Lim_Depressive_Mood[3]) {
        SigChange5d_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[4])
      }
      
      if(Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Upper_Lim_Depressive_Mood[3] | Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Lower_Lim_Depressive_Mood[3]) {
        SigChange5e_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[5] - Rep_Df$Score_Depressive_Mood[3]), "**")
      } else if(Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Upper_Lim_Depressive_Mood[3] & Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Lower_Lim_Depressive_Mood[3]) {
        SigChange5e_Depressive_Mood<- paste((Rep_Df$Score_Depressive_Mood[5] - Rep_Df$Score_Depressive_Mood[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Depressive_Mood<- data.frame(Time3, SigChange5d_Depressive_Mood, SigChange5e_Depressive_Mood)
      names(Change_Rep_Df5b_Depressive_Mood)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Depressive_Mood)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Upper_Lim_Depressive_Mood[4] | Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Lower_Lim_Depressive_Mood[4]) {
        SigChange5f_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[5], "**")
      } else if(Rep_Df$Score_Depressive_Mood[5] < Rep_Df$CI_Upper_Lim_Depressive_Mood[4] & Rep_Df$Score_Depressive_Mood[5] > Rep_Df$CI_Lower_Lim_Depressive_Mood[4]) {
        SigChange5f_Depressive_Mood<- paste(Rep_Df$Change_Depressive_Mood[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Depressive_Mood<- data.frame(Time4, SigChange5f_Depressive_Mood)
      names(Change_Rep_Df5c_Depressive_Mood)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Depressive_Mood, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Anxiety Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Anxiety<- Entered_Scores_Df[,c(1,38,39,40,41,42,43)]
names(Scores_Table_Anxiety)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Anxiety<- kable(Stats_Table_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Anxiety, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Einsle, Köllner, Dannermann & Maercker (2010)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p6<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Anxiety, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Anxiety_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Anxiety_1[1],":",Entered_Scores_Df$Cutoff_Score_Anxiety_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Anxiety_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Anxiety_2[1],":",Entered_Scores_Df$Cutoff_Score_Anxiety_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Anxiety_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Anxiety_3[1],":",Entered_Scores_Df$Cutoff_Score_Anxiety_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Anxiety_1[1],":",Entered_Scores_Df$Cutoff_Score_Anxiety_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Anxiety_2[1],":",Entered_Scores_Df$Cutoff_Score_Anxiety_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Anxiety_3[1],":",Entered_Scores_Df$Cutoff_Score_Anxiety_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Anxiety, ymax=Entered_Scores_Df$CI_Upper_Lim_Anxiety), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Anxiety)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Anxiety)), size = 3, family = "AvantGarde")
  
p6<- p6+labs(x="Date", y = "Anxiety Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-4, 12), breaks = c(4,5,6,7,8), labels = c('4 Min','5','6','7','8 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p6)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2], "**")
      } else if(Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Anxiety<- data.frame(Time1, SigChange2_Anxiety)
      names(Change_Rep_Df2_Anxiety)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2], "**")
      } else if(Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2])
      }
      
      if(Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange3_Anxiety<- paste((Rep_Df$Score_Anxiety[3] - Rep_Df$Score_Anxiety[1]), "**")
      } else if(Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange3_Anxiety<- paste((Rep_Df$Score_Anxiety[3] - Rep_Df$Score_Anxiety[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Anxiety<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Anxiety)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Anxiety)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Upper_Lim_Anxiety[2] | Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange3a_Anxiety<- paste(Rep_Df$Change_Anxiety[3], "**")
      } else if(Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Upper_Lim_Anxiety[2] & Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange3a_Anxiety<- paste(Rep_Df$Change_Anxiety[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Anxiety<- data.frame(Time2, SigChange3a_Anxiety)
      names(Change_Rep_Df3a_Anxiety)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2], "**")
      } else if(Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2])
      }
      
      if(Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange3_Anxiety<- paste((Rep_Df$Score_Anxiety[3] - Rep_Df$Score_Anxiety[1]), "**")
      } else if(Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange3_Anxiety<- paste((Rep_Df$Score_Anxiety[3] - Rep_Df$Score_Anxiety[1]))
      }
      
      if(Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange4_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[1]), "**")
      } else if(Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange4_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Anxiety<- data.frame(Time1, SigChange2_Anxiety, SigChange3_Anxiety, SigChange4_Anxiety)
      names(Change_Rep_Df4_Anxiety)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Anxiety)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Anxiety)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Upper_Lim_Anxiety[2] | Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange4a_Anxiety<- paste(Rep_Df$Change_Anxiety[3], "**")
      } else if(Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Upper_Lim_Anxiety[2] & Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange4a_Anxiety<- paste(Rep_Df$Change_Anxiety[3])
      }
      
      if(Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Upper_Lim_Anxiety[2] | Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange4b_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[2]), "**")
      } else if(Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Upper_Lim_Anxiety[2] & Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange4b_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Anxiety<- data.frame(Time2, SigChange4a_Anxiety, SigChange4b_Anxiety)
      names(Change_Rep_Df4a_Anxiety)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Anxiety)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Upper_Lim_Anxiety[3] | Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Lower_Lim_Anxiety[3]) {
        SigChange4c_Anxiety<- paste(Rep_Df$Change_Anxiety[4], "**")
      } else if(Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Upper_Lim_Anxiety[3] & Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Lower_Lim_Anxiety[3]) {
        SigChange4c_Anxiety<- paste(Rep_Df$Change_Anxiety[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Anxiety<- data.frame(Time3, SigChange4c_Anxiety)
      names(Change_Rep_Df4b_Anxiety)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2], "**")
      } else if(Rep_Df$Score_Anxiety[2] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[2] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange2_Anxiety<- paste(Rep_Df$Change_Anxiety[2])
      }
      
      if(Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange3_Anxiety<- paste((Rep_Df$Score_Anxiety[3] - Rep_Df$Score_Anxiety[1]), "**")
      } else if(Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange3_Anxiety<- paste((Rep_Df$Score_Anxiety[3] - Rep_Df$Score_Anxiety[1]))
      }
      
      if(Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange4_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[1]), "**")
      } else if(Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange4_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[1]))
      }
      
      if(Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Upper_Lim_Anxiety[1] | Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange5_Anxiety<- paste((Rep_Df$Score_Anxiety[5] - Rep_Df$Score_Anxiety[1]), "**")
      } else if(Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Upper_Lim_Anxiety[1] & Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Lower_Lim_Anxiety[1]) {
        SigChange5_Anxiety<- paste((Rep_Df$Score_Anxiety[5] - Rep_Df$Score_Anxiety[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Anxiety<- data.frame(Time1, SigChange2_Anxiety, SigChange3_Anxiety, SigChange4_Anxiety, SigChange5_Anxiety)
      names(Change_Rep_Df5_Anxiety)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Anxiety)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Anxiety)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Anxiety)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Upper_Lim_Anxiety[2] | Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange5a_Anxiety<- paste(Rep_Df$Change_Anxiety[3], "**")
      } else if(Rep_Df$Score_Anxiety[3] < Rep_Df$CI_Upper_Lim_Anxiety[2] & Rep_Df$Score_Anxiety[3] > Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange5a_Anxiety<- paste(Rep_Df$Change_Anxiety[3])
      }
      
      if(Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Upper_Lim_Anxiety[2] | Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange5b_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[2]), "**")
      } else if(Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Upper_Lim_Anxiety[2] & Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange5b_Anxiety<- paste((Rep_Df$Score_Anxiety[4] - Rep_Df$Score_Anxiety[2]))
      }
      
      if(Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Upper_Lim_Anxiety[2] | Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange5c_Anxiety<- paste((Rep_Df$Score_Anxiety[5] - Rep_Df$Score_Anxiety[2]), "**")
      } else if(Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Upper_Lim_Anxiety[2] & Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Lower_Lim_Anxiety[2]) {
        SigChange5c_Anxiety<- paste((Rep_Df$Score_Anxiety[5] - Rep_Df$Score_Anxiety[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Anxiety<- data.frame(Time2, SigChange5a_Anxiety, SigChange5b_Anxiety, SigChange5c_Anxiety)
      names(Change_Rep_Df5a_Anxiety)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Anxiety)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Anxiety)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Upper_Lim_Anxiety[3] | Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Lower_Lim_Anxiety[3]) {
        SigChange5d_Anxiety<- paste(Rep_Df$Change_Anxiety[4], "**")
      } else if(Rep_Df$Score_Anxiety[4] < Rep_Df$CI_Upper_Lim_Anxiety[3] & Rep_Df$Score_Anxiety[4] > Rep_Df$CI_Lower_Lim_Anxiety[3]) {
        SigChange5d_Anxiety<- paste(Rep_Df$Change_Anxiety[4])
      }
      
      if(Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Upper_Lim_Anxiety[3] | Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Lower_Lim_Anxiety[3]) {
        SigChange5e_Anxiety<- paste((Rep_Df$Score_Anxiety[5] - Rep_Df$Score_Anxiety[3]), "**")
      } else if(Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Upper_Lim_Anxiety[3] & Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Lower_Lim_Anxiety[3]) {
        SigChange5e_Anxiety<- paste((Rep_Df$Score_Anxiety[5] - Rep_Df$Score_Anxiety[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Anxiety<- data.frame(Time3, SigChange5d_Anxiety, SigChange5e_Anxiety)
      names(Change_Rep_Df5b_Anxiety)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Anxiety)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Upper_Lim_Anxiety[4] | Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Lower_Lim_Anxiety[4]) {
        SigChange5f_Anxiety<- paste(Rep_Df$Change_Anxiety[5], "**")
      } else if(Rep_Df$Score_Anxiety[5] < Rep_Df$CI_Upper_Lim_Anxiety[4] & Rep_Df$Score_Anxiety[5] > Rep_Df$CI_Lower_Lim_Anxiety[4]) {
        SigChange5f_Anxiety<- paste(Rep_Df$Change_Anxiety[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Anxiety<- data.frame(Time4, SigChange5f_Anxiety)
      names(Change_Rep_Df5c_Anxiety)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Anxiety, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Impulse Control Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Impulse_Control<- Entered_Scores_Df[,c(1,47,48,49,50,51,52)]
names(Scores_Table_Impulse_Control)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA, fig.width=8}

Stats_Table_Impulse_Control<- kable(Stats_Table_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Impulse_Control, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Einsle, Köllner, Dannermann & Maercker (2010)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p7<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Impulse_Control, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Impulse_Control_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Impulse_Control_1[1],":",Entered_Scores_Df$Cutoff_Score_Impulse_Control_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Impulse_Control_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Impulse_Control_2[1],":",Entered_Scores_Df$Cutoff_Score_Impulse_Control_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Impulse_Control_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Impulse_Control_3[1],":",Entered_Scores_Df$Cutoff_Score_Impulse_Control_3[1])), color = "#827717", size = 0.4)  + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Impulse_Control_1[1],":",Entered_Scores_Df$Cutoff_Score_Impulse_Control_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Impulse_Control_2[1],":",Entered_Scores_Df$Cutoff_Score_Impulse_Control_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Impulse_Control_3[1],":",Entered_Scores_Df$Cutoff_Score_Impulse_Control_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Impulse_Control, ymax=Entered_Scores_Df$CI_Upper_Lim_Impulse_Control), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Impulse_Control)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Impulse_Control)), size = 3, family = "AvantGarde") 
  
p7<- p7+labs(x="Date", y = "Impulse Control Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-6, 22), breaks = c(4,6,8,10,12), labels = c('4 Min','6','8','10','12 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p7)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[2], "**")
      } else if(Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Impulse_Control<- data.frame(Time1, SigChange2_Impulse_Control)
      names(Change_Rep_Df2_Impulse_Control)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[2], "**")
      } else if(Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[2])
      }
      
      if(Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange3_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[3] - Rep_Df$Score_Impulse_Control[1]), "**")
      } else if(Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange3_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[3] - Rep_Df$Score_Impulse_Control[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Impulse_Control<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Impulse_Control)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Impulse_Control)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Upper_Lim_Impulse_Control[2] | Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange3a_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[3], "**")
      } else if(Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Upper_Lim_Impulse_Control[2] & Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange3a_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Impulse_Control<- data.frame(Time2, SigChange3a_Impulse_Control)
      names(Change_Rep_Df3a_Impulse_Control)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[2], "**")
      } else if(Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[2])
      }
      
      if(Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange3_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[3] - Rep_Df$Score_Impulse_Control[1]), "**")
      } else if(Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange3_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[3] - Rep_Df$Score_Impulse_Control[1]))
      }
      
      if(Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange4_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[1]), "**")
      } else if(Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange4_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Impulse_Control<- data.frame(Time1, SigChange2_Impulse_Control, SigChange3_Impulse_Control, SigChange4_Impulse_Control)
      names(Change_Rep_Df4_Impulse_Control)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Impulse_Control)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Impulse_Control)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Upper_Lim_Impulse_Control[2] | Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange4a_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[3], "**")
      } else if(Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Upper_Lim_Impulse_Control[2] & Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange4a_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[3])
      }
      
      if(Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Upper_Lim_Impulse_Control[2] | Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange4b_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[2]), "**")
      } else if(Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Upper_Lim_Impulse_Control[2] & Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange4b_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Impulse_Control<- data.frame(Time2, SigChange4a_Impulse_Control, SigChange4b_Impulse_Control)
      names(Change_Rep_Df4a_Impulse_Control)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Impulse_Control)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Upper_Lim_Impulse_Control[3] | Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Lower_Lim_Impulse_Control[3]) {
        SigChange4c_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[4], "**")
      } else if(Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Upper_Lim_Impulse_Control[3] & Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Lower_Lim_Impulse_Control[3]) {
        SigChange4c_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Impulse_Control<- data.frame(Time3, SigChange4c_Impulse_Control)
      names(Change_Rep_Df4b_Impulse_Control)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Impulse_Control[2] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[2] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange2_Impulse_Control<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange3_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[3] - Rep_Df$Score_Impulse_Control[1]), "**")
      } else if(Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange3_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[3] - Rep_Df$Score_Impulse_Control[1]))
      }
      
      if(Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange4_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[1]), "**")
      } else if(Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange4_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[1]))
      }
      
      if(Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Upper_Lim_Impulse_Control[1] | Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange5_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[5] - Rep_Df$Score_Impulse_Control[1]), "**")
      } else if(Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Upper_Lim_Impulse_Control[1] & Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Lower_Lim_Impulse_Control[1]) {
        SigChange5_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[5] - Rep_Df$Score_Impulse_Control[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Impulse_Control<- data.frame(Time1, SigChange2_Impulse_Control, SigChange3_Impulse_Control, SigChange4_Impulse_Control, SigChange5_Impulse_Control)
      names(Change_Rep_Df5_Impulse_Control)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Impulse_Control)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Impulse_Control)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Impulse_Control)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Upper_Lim_Impulse_Control[2] | Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange5a_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[3], "**")
      } else if(Rep_Df$Score_Impulse_Control[3] < Rep_Df$CI_Upper_Lim_Impulse_Control[2] & Rep_Df$Score_Impulse_Control[3] > Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange5a_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[3])
      }
      
      if(Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Upper_Lim_Impulse_Control[2] | Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange5b_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[2]), "**")
      } else if(Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Upper_Lim_Impulse_Control[2] & Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange5b_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[4] - Rep_Df$Score_Impulse_Control[2]))
      }
      
      if(Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Upper_Lim_Impulse_Control[2] | Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange5c_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[5] - Rep_Df$Score_Impulse_Control[2]), "**")
      } else if(Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Upper_Lim_Impulse_Control[2] & Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Lower_Lim_Impulse_Control[2]) {
        SigChange5c_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[5] - Rep_Df$Score_Impulse_Control[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Impulse_Control<- data.frame(Time2, SigChange5a_Impulse_Control, SigChange5b_Impulse_Control, SigChange5c_Impulse_Control)
      names(Change_Rep_Df5a_Impulse_Control)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Impulse_Control)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Impulse_Control)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Upper_Lim_Impulse_Control[3] | Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Lower_Lim_Impulse_Control[3]) {
        SigChange5d_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[4], "**")
      } else if(Rep_Df$Score_Impulse_Control[4] < Rep_Df$CI_Upper_Lim_Impulse_Control[3] & Rep_Df$Score_Impulse_Control[4] > Rep_Df$CI_Lower_Lim_Impulse_Control[3]) {
        SigChange5d_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[4])
      }
      
      if(Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Upper_Lim_Impulse_Control[3] | Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Lower_Lim_Impulse_Control[3]) {
        SigChange5e_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[5] - Rep_Df$Score_Impulse_Control[3]), "**")
      } else if(Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Upper_Lim_Impulse_Control[3] & Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Lower_Lim_Impulse_Control[3]) {
        SigChange5e_Impulse_Control<- paste((Rep_Df$Score_Impulse_Control[5] - Rep_Df$Score_Impulse_Control[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Impulse_Control<- data.frame(Time3, SigChange5d_Impulse_Control, SigChange5e_Impulse_Control)
      names(Change_Rep_Df5b_Impulse_Control)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Impulse_Control)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Upper_Lim_Impulse_Control[4] | Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Lower_Lim_Impulse_Control[4]) {
        SigChange5f_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[5], "**")
      } else if(Rep_Df$Score_Impulse_Control[5] < Rep_Df$CI_Upper_Lim_Impulse_Control[4] & Rep_Df$Score_Impulse_Control[5] > Rep_Df$CI_Lower_Lim_Impulse_Control[4]) {
        SigChange5f_Impulse_Control<- paste(Rep_Df$Change_Impulse_Control[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Impulse_Control<- data.frame(Time4, SigChange5f_Impulse_Control)
      names(Change_Rep_Df5c_Impulse_Control)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Impulse_Control, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Avoidance Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Avoidance<- Entered_Scores_Df[,c(1,56,57,58,59,60,61)]
names(Scores_Table_Avoidance)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Avoidance<- kable(Stats_Table_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Avoidance, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Einsle, Köllner, Dannermann & Maercker (2010)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p8<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Avoidance, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Avoidance_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Avoidance_1[1],":",Entered_Scores_Df$Cutoff_Score_Avoidance_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Avoidance_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Avoidance_2[1],":",Entered_Scores_Df$Cutoff_Score_Avoidance_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Avoidance_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Avoidance_3[1],":",Entered_Scores_Df$Cutoff_Score_Avoidance_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Avoidance_1[1],":",Entered_Scores_Df$Cutoff_Score_Avoidance_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Avoidance_2[1],":",Entered_Scores_Df$Cutoff_Score_Avoidance_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Avoidance_3[1],":",Entered_Scores_Df$Cutoff_Score_Avoidance_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Avoidance, ymax=Entered_Scores_Df$CI_Upper_Lim_Avoidance), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Avoidance)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Avoidance)), size = 3, family = "AvantGarde")
  
p8<- p8+labs(x="Date", y = "Avoidance Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-6, 26), breaks = c(4,6,8,10,12,14,16), labels = c('4 Min','6','8','10','12','14','16 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p8)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2], "**")
      } else if(Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Avoidance<- data.frame(Time1, SigChange2_Avoidance)
      names(Change_Rep_Df2_Avoidance)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2], "**")
      } else if(Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2])
      }
      
      if(Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange3_Avoidance<- paste((Rep_Df$Score_Avoidance[3] - Rep_Df$Score_Avoidance[1]), "**")
      } else if(Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange3_Avoidance<- paste((Rep_Df$Score_Avoidance[3] - Rep_Df$Score_Avoidance[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Avoidance<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Avoidance)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Avoidance)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Upper_Lim_Avoidance[2] | Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange3a_Avoidance<- paste(Rep_Df$Change_Avoidance[3], "**")
      } else if(Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Upper_Lim_Avoidance[2] & Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange3a_Avoidance<- paste(Rep_Df$Change_Avoidance[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Avoidance<- data.frame(Time2, SigChange3a_Avoidance)
      names(Change_Rep_Df3a_Avoidance)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2], "**")
      } else if(Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2])
      }
      
      if(Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange3_Avoidance<- paste((Rep_Df$Score_Avoidance[3] - Rep_Df$Score_Avoidance[1]), "**")
      } else if(Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange3_Avoidance<- paste((Rep_Df$Score_Avoidance[3] - Rep_Df$Score_Avoidance[1]))
      }
      
      if(Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange4_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[1]), "**")
      } else if(Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange4_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Avoidance<- data.frame(Time1, SigChange2_Avoidance, SigChange3_Avoidance, SigChange4_Avoidance)
      names(Change_Rep_Df4_Avoidance)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Avoidance)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Avoidance)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Upper_Lim_Avoidance[2] | Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange4a_Avoidance<- paste(Rep_Df$Change_Avoidance[3], "**")
      } else if(Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Upper_Lim_Avoidance[2] & Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange4a_Avoidance<- paste(Rep_Df$Change_Avoidance[3])
      }
      
      if(Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Upper_Lim_Avoidance[2] | Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange4b_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[2]), "**")
      } else if(Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Upper_Lim_Avoidance[2] & Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange4b_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Avoidance<- data.frame(Time2, SigChange4a_Avoidance, SigChange4b_Avoidance)
      names(Change_Rep_Df4a_Avoidance)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Avoidance)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Upper_Lim_Avoidance[3] | Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Lower_Lim_Avoidance[3]) {
        SigChange4c_Avoidance<- paste(Rep_Df$Change_Avoidance[4], "**")
      } else if(Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Upper_Lim_Avoidance[3] & Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Lower_Lim_Avoidance[3]) {
        SigChange4c_Avoidance<- paste(Rep_Df$Change_Avoidance[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Avoidance<- data.frame(Time3, SigChange4c_Avoidance)
      names(Change_Rep_Df4b_Avoidance)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2], "**")
      } else if(Rep_Df$Score_Avoidance[2] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[2] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange2_Avoidance<- paste(Rep_Df$Change_Avoidance[2])
      }
      
      if(Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange3_Avoidance<- paste((Rep_Df$Score_Avoidance[3] - Rep_Df$Score_Avoidance[1]), "**")
      } else if(Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange3_Avoidance<- paste((Rep_Df$Score_Avoidance[3] - Rep_Df$Score_Avoidance[1]))
      }
      
      if(Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange4_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[1]), "**")
      } else if(Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange4_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[1]))
      }
      
      if(Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Upper_Lim_Avoidance[1] | Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange5_Avoidance<- paste((Rep_Df$Score_Avoidance[5] - Rep_Df$Score_Avoidance[1]), "**")
      } else if(Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Upper_Lim_Avoidance[1] & Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Lower_Lim_Avoidance[1]) {
        SigChange5_Avoidance<- paste((Rep_Df$Score_Avoidance[5] - Rep_Df$Score_Avoidance[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Avoidance<- data.frame(Time1, SigChange2_Avoidance, SigChange3_Avoidance, SigChange4_Avoidance, SigChange5_Avoidance)
      names(Change_Rep_Df5_Avoidance)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Avoidance)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Avoidance)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Avoidance)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Upper_Lim_Avoidance[2] | Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange5a_Avoidance<- paste(Rep_Df$Change_Avoidance[3], "**")
      } else if(Rep_Df$Score_Avoidance[3] < Rep_Df$CI_Upper_Lim_Avoidance[2] & Rep_Df$Score_Avoidance[3] > Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange5a_Avoidance<- paste(Rep_Df$Change_Avoidance[3])
      }
      
      if(Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Upper_Lim_Avoidance[2] | Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange5b_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[2]), "**")
      } else if(Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Upper_Lim_Avoidance[2] & Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange5b_Avoidance<- paste((Rep_Df$Score_Avoidance[4] - Rep_Df$Score_Avoidance[2]))
      }
      
      if(Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Upper_Lim_Avoidance[2] | Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange5c_Avoidance<- paste((Rep_Df$Score_Avoidance[5] - Rep_Df$Score_Avoidance[2]), "**")
      } else if(Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Upper_Lim_Avoidance[2] & Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Lower_Lim_Avoidance[2]) {
        SigChange5c_Avoidance<- paste((Rep_Df$Score_Avoidance[5] - Rep_Df$Score_Avoidance[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Avoidance<- data.frame(Time2, SigChange5a_Avoidance, SigChange5b_Avoidance, SigChange5c_Avoidance)
      names(Change_Rep_Df5a_Avoidance)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Avoidance)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Avoidance)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Upper_Lim_Avoidance[3] | Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Lower_Lim_Avoidance[3]) {
        SigChange5d_Avoidance<- paste(Rep_Df$Change_Avoidance[4], "**")
      } else if(Rep_Df$Score_Avoidance[4] < Rep_Df$CI_Upper_Lim_Avoidance[3] & Rep_Df$Score_Avoidance[4] > Rep_Df$CI_Lower_Lim_Avoidance[3]) {
        SigChange5d_Avoidance<- paste(Rep_Df$Change_Avoidance[4])
      }
      
      if(Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Upper_Lim_Avoidance[3] | Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Lower_Lim_Avoidance[3]) {
        SigChange5e_Avoidance<- paste((Rep_Df$Score_Avoidance[5] - Rep_Df$Score_Avoidance[3]), "**")
      } else if(Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Upper_Lim_Avoidance[3] & Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Lower_Lim_Avoidance[3]) {
        SigChange5e_Avoidance<- paste((Rep_Df$Score_Avoidance[5] - Rep_Df$Score_Avoidance[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Avoidance<- data.frame(Time3, SigChange5d_Avoidance, SigChange5e_Avoidance)
      names(Change_Rep_Df5b_Avoidance)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Avoidance)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Upper_Lim_Avoidance[4] | Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Lower_Lim_Avoidance[4]) {
        SigChange5f_Avoidance<- paste(Rep_Df$Change_Avoidance[5], "**")
      } else if(Rep_Df$Score_Avoidance[5] < Rep_Df$CI_Upper_Lim_Avoidance[4] & Rep_Df$Score_Avoidance[5] > Rep_Df$CI_Lower_Lim_Avoidance[4]) {
        SigChange5f_Avoidance<- paste(Rep_Df$Change_Avoidance[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Avoidance<- data.frame(Time4, SigChange5f_Avoidance)
      names(Change_Rep_Df5c_Avoidance)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Avoidance, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Stressful Events Endorsed

```{r,echo=FALSE,warning=FALSE,comment=NA}

kable(Event_Df, format = "latex", booktabs = T) %>% kable_styling(position = "left", full_width = T, font_size = 12, latex_options = "striped") %>% row_spec(0, bold = T)
```

#Most Straining Event(s)

#`r Straining_Event`

#Most Recent Item Scores

#`r Scores_Table[nrow(Scores_Table),1]`

```{r,echo=FALSE,warning=FALSE,comment=NA}

kable(Item_Df, format = "latex", booktabs = T) %>% kable_styling(position = "left", full_width = T, font_size = 12, latex_options = "striped") %>% row_spec(0, bold = T)
```

\newpage

\begingroup\Large

\begin{center} \textbf{Information About The Adjustment Disorder New Module - 20 (ADNM-20)} \end{center} 

#What it Measures: 




#What Higher Scores Mean:




#Scale Quality:



#Scale Structure:



\endgroup