---
title: "Borderline Personality Questionnaire (BPQ)"
author: "Report generated by PsychlytX"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
PN: 'NULL' 
CN: 'NULL'
Tab_Reference: 'NULL'
Stats_Table_Fullscale: 'NULL'
Stats_Table_Impulsivity: 'NULL'
Stats_Table_Affective_Instability: 'NULL'
Stats_Table_Abandonment: 'NULL'
Stats_Table_Relationships: 'NULL'
Stats_Table_Self_Image: 'NULL'
Stats_Table_Suicide_Mutilation: 'NULL'
Stats_Table_Emptiness: 'NULL'
Stats_Table_Anger: 'NULL'
Stats_Table_Quasi_Psychotic: 'NULL'
Entered_Scores_Df: 'NULL'
Cutoff_Names: 'NULL'
Item_Df: 'NULL'
subtitle: '**Patient:** `r PN` **|** **Clinician:** `r CN`'
---

```{r,echo = FALSE,warning=FALSE,comment = NA}
knitr::opts_chunk$set(fig.width=7,fig.height=3) 

```

#BPQ Total Scale 

##Response Summary

```{r,echo=FALSE,warning=FALSE,comment=NA}
Scores_Table<- Entered_Scores_Df[,c(1,2,3,4,5,6,7)]
names(Scores_Table)<- c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```


##Data Employed in Reliable Change Analyses

```{r,echo=FALSE,warning=FALSE,comment=NA}

Stats_Table_Fullscale<- kable(Stats_Table_Fullscale, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Fullscale, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```


##Trend

```{r,echo=FALSE,warning=FALSE,comment=FALSE,message=FALSE, fig.width=8}
 p1<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_1[1],":",Entered_Scores_Df$Cutoff_Score_1[1]),
                                                   paste(Cutoff_Names$Cutoff_Name_2[1],":",Entered_Scores_Df$Cutoff_Score_2[1]),
                                                   paste(Cutoff_Names$Cutoff_Name_3[1],":",Entered_Scores_Df$Cutoff_Score_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim, ymax=Entered_Scores_Df$CI_Upper_Lim), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change = ", Entered_Scores_Df$Change)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde", face = "bold") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score)), size = 3, family = "AvantGarde", face = "bold")   
                        
p1<- p1+labs(x="Date", y = "Total BPQ Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-10, 90), breaks = c(0,8,16,24,32,40,48,56,64,72,80), labels = c('0 Min', '8','16','24','32','40','48', '56','64','72','80 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde"))
print(p1) 
```

##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by ** 
```{r, echo = FALSE, warning = FALSE,comment=NA, message=FALSE}

if(length(Entered_Scores_Df$Date) == 2) {  

Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2<- data.frame(Time1, SigChange2)
      names(Change_Rep_Df2)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange3a<- paste(Rep_Df$Change[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a<- data.frame(Time2, SigChange3a)
      names(Change_Rep_Df3a)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4<- data.frame(Time1, SigChange2, SigChange3, SigChange4)
      names(Change_Rep_Df4)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange4b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a<- data.frame(Time2, SigChange4a, SigChange4b)
      names(Change_Rep_Df4a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange4c<- paste(Rep_Df$Change[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b<- data.frame(Time3, SigChange4c)
      names(Change_Rep_Df4b)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE, comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score[2] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[2] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score[2] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[2] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange2<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange3<- paste((Rep_Df$Score[3] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange4<- paste((Rep_Df$Score[4] - Rep_Df$Score[1]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[1] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[1] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[1]) {
        SigChange5<- paste((Rep_Df$Score[5] - Rep_Df$Score[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5<- data.frame(Time1, SigChange2, SigChange3, SigChange4, SigChange5)
      names(Change_Rep_Df5)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[3] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[3] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3], "**")
      } else if(Rep_Df$Score[3] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[3] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5a<- paste(Rep_Df$Change[3])
      }
      
      if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5b<- paste((Rep_Df$Score[4] - Rep_Df$Score[2]))
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[2] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[2] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[2]) {
        SigChange5c<- paste((Rep_Df$Score[5] - Rep_Df$Score[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a<- data.frame(Time2, SigChange5a, SigChange5b, SigChange5c)
      names(Change_Rep_Df5a)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score[4] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[4] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4], "**")
      } else if(Rep_Df$Score[4] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[4] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5d<- paste(Rep_Df$Change[4])
      }
      
      if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[3] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]), "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[3] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[3]) {
        SigChange5e<- paste((Rep_Df$Score[5] - Rep_Df$Score[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b<- data.frame(Time3, SigChange5d, SigChange5e)
      names(Change_Rep_Df5b)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score[5] > Rep_Df$CI_Upper_Lim[4] | Rep_Df$Score[5] < Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5], "**")
      } else if(Rep_Df$Score[5] < Rep_Df$CI_Upper_Lim[4] & Rep_Df$Score[5] > Rep_Df$CI_Lower_Lim[4]) {
        SigChange5f<- paste(Rep_Df$Change[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c<- data.frame(Time4, SigChange5f)
      names(Change_Rep_Df5c)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#Impulsivity Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Impulsivity<- Entered_Scores_Df[,c(1,11,12,13,14,15,16)]
names(Scores_Table_Impulsivity)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Impulsivity<- kable(Stats_Table_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Impulsivity, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p2<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Impulsivity, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Impulsivity_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Impulsivity_1[1],":",Entered_Scores_Df$Cutoff_Score_Impulsivity_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Impulsivity_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Impulsivity_2[1],":",Entered_Scores_Df$Cutoff_Score_Impulsivity_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Impulsivity_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Impulsivity_3[1],":",Entered_Scores_Df$Cutoff_Score_Impulsivity_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Impulsivity_1[1],":",Entered_Scores_Df$Cutoff_Score_Impulsivity_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Impulsivity_2[1],":",Entered_Scores_Df$Cutoff_Score_Impulsivity_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Impulsivity_3[1],":",Entered_Scores_Df$Cutoff_Score_Impulsivity_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Impulsivity, ymax=Entered_Scores_Df$CI_Upper_Lim_Impulsivity), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Impulsivity)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Impulsivity)), size = 3, family = "AvantGarde")  
  
p2<- p2+labs(x="Date", y = "Impulsivity Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-4, 13), breaks = c(0,3,6,9), labels = c('0 Min','3','6','9 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p2)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2], "**")
      } else if(Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Impulsivity<- data.frame(Time1, SigChange2_Impulsivity)
      names(Change_Rep_Df2_Impulsivity)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2], "**")
      } else if(Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2])
      }
      
      if(Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange3_Impulsivity<- paste((Rep_Df$Score_Impulsivity[3] - Rep_Df$Score_Impulsivity[1]), "**")
      } else if(Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange3_Impulsivity<- paste((Rep_Df$Score_Impulsivity[3] - Rep_Df$Score_Impulsivity[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Impulsivity<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Impulsivity)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Impulsivity)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Upper_Lim_Impulsivity[2] | Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange3a_Impulsivity<- paste(Rep_Df$Change_Impulsivity[3], "**")
      } else if(Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Upper_Lim_Impulsivity[2] & Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange3a_Impulsivity<- paste(Rep_Df$Change_Impulsivity[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Impulsivity<- data.frame(Time2, SigChange3a_Impulsivity)
      names(Change_Rep_Df3a_Impulsivity)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2], "**")
      } else if(Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2])
      }
      
      if(Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange3_Impulsivity<- paste((Rep_Df$Score_Impulsivity[3] - Rep_Df$Score_Impulsivity[1]), "**")
      } else if(Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange3_Impulsivity<- paste((Rep_Df$Score_Impulsivity[3] - Rep_Df$Score_Impulsivity[1]))
      }
      
      if(Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange4_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[1]), "**")
      } else if(Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange4_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Impulsivity<- data.frame(Time1, SigChange2_Impulsivity, SigChange3_Impulsivity, SigChange4_Impulsivity)
      names(Change_Rep_Df4_Impulsivity)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Impulsivity)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Impulsivity)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Upper_Lim_Impulsivity[2] | Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange4a_Impulsivity<- paste(Rep_Df$Change_Impulsivity[3], "**")
      } else if(Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Upper_Lim_Impulsivity[2] & Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange4a_Impulsivity<- paste(Rep_Df$Change_Impulsivity[3])
      }
      
      if(Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Upper_Lim_Impulsivity[2] | Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange4b_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[2]), "**")
      } else if(Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Upper_Lim_Impulsivity[2] & Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange4b_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Impulsivity<- data.frame(Time2, SigChange4a_Impulsivity, SigChange4b_Impulsivity)
      names(Change_Rep_Df4a_Impulsivity)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Impulsivity)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Upper_Lim_Impulsivity[3] | Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Lower_Lim_Impulsivity[3]) {
        SigChange4c_Impulsivity<- paste(Rep_Df$Change_Impulsivity[4], "**")
      } else if(Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Upper_Lim_Impulsivity[3] & Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Lower_Lim_Impulsivity[3]) {
        SigChange4c_Impulsivity<- paste(Rep_Df$Change_Impulsivity[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Impulsivity<- data.frame(Time3, SigChange4c_Impulsivity)
      names(Change_Rep_Df4b_Impulsivity)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2], "**")
      } else if(Rep_Df$Score_Impulsivity[2] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[2] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange2_Impulsivity<- paste(Rep_Df$Change_Impulsivity[2])
      }
      
      if(Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange3_Impulsivity<- paste((Rep_Df$Score_Impulsivity[3] - Rep_Df$Score_Impulsivity[1]), "**")
      } else if(Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange3_Impulsivity<- paste((Rep_Df$Score_Impulsivity[3] - Rep_Df$Score_Impulsivity[1]))
      }
      
      if(Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange4_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[1]), "**")
      } else if(Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange4_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[1]))
      }
      
      if(Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Upper_Lim_Impulsivity[1] | Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange5_Impulsivity<- paste((Rep_Df$Score_Impulsivity[5] - Rep_Df$Score_Impulsivity[1]), "**")
      } else if(Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Upper_Lim_Impulsivity[1] & Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Lower_Lim_Impulsivity[1]) {
        SigChange5_Impulsivity<- paste((Rep_Df$Score_Impulsivity[5] - Rep_Df$Score_Impulsivity[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Impulsivity<- data.frame(Time1, SigChange2_Impulsivity, SigChange3_Impulsivity, SigChange4_Impulsivity, SigChange5_Impulsivity)
      names(Change_Rep_Df5_Impulsivity)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Impulsivity)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Impulsivity)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Impulsivity)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Upper_Lim_Impulsivity[2] | Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange5a_Impulsivity<- paste(Rep_Df$Change_Impulsivity[3], "**")
      } else if(Rep_Df$Score_Impulsivity[3] < Rep_Df$CI_Upper_Lim_Impulsivity[2] & Rep_Df$Score_Impulsivity[3] > Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange5a_Impulsivity<- paste(Rep_Df$Change_Impulsivity[3])
      }
      
      if(Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Upper_Lim_Impulsivity[2] | Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange5b_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[2]), "**")
      } else if(Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Upper_Lim_Impulsivity[2] & Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange5b_Impulsivity<- paste((Rep_Df$Score_Impulsivity[4] - Rep_Df$Score_Impulsivity[2]))
      }
      
      if(Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Upper_Lim_Impulsivity[2] | Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange5c_Impulsivity<- paste((Rep_Df$Score_Impulsivity[5] - Rep_Df$Score_Impulsivity[2]), "**")
      } else if(Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Upper_Lim_Impulsivity[2] & Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Lower_Lim_Impulsivity[2]) {
        SigChange5c_Impulsivity<- paste((Rep_Df$Score_Impulsivity[5] - Rep_Df$Score_Impulsivity[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Impulsivity<- data.frame(Time2, SigChange5a_Impulsivity, SigChange5b_Impulsivity, SigChange5c_Impulsivity)
      names(Change_Rep_Df5a_Impulsivity)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Impulsivity)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Impulsivity)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Upper_Lim_Impulsivity[3] | Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Lower_Lim_Impulsivity[3]) {
        SigChange5d_Impulsivity<- paste(Rep_Df$Change_Impulsivity[4], "**")
      } else if(Rep_Df$Score_Impulsivity[4] < Rep_Df$CI_Upper_Lim_Impulsivity[3] & Rep_Df$Score_Impulsivity[4] > Rep_Df$CI_Lower_Lim_Impulsivity[3]) {
        SigChange5d_Impulsivity<- paste(Rep_Df$Change_Impulsivity[4])
      }
      
      if(Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Upper_Lim_Impulsivity[3] | Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Lower_Lim_Impulsivity[3]) {
        SigChange5e_Impulsivity<- paste((Rep_Df$Score_Impulsivity[5] - Rep_Df$Score_Impulsivity[3]), "**")
      } else if(Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Upper_Lim_Impulsivity[3] & Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Lower_Lim_Impulsivity[3]) {
        SigChange5e_Impulsivity<- paste((Rep_Df$Score_Impulsivity[5] - Rep_Df$Score_Impulsivity[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Impulsivity<- data.frame(Time3, SigChange5d_Impulsivity, SigChange5e_Impulsivity)
      names(Change_Rep_Df5b_Impulsivity)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Impulsivity)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Upper_Lim_Impulsivity[4] | Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Lower_Lim_Impulsivity[4]) {
        SigChange5f_Impulsivity<- paste(Rep_Df$Change_Impulsivity[5], "**")
      } else if(Rep_Df$Score_Impulsivity[5] < Rep_Df$CI_Upper_Lim_Impulsivity[4] & Rep_Df$Score_Impulsivity[5] > Rep_Df$CI_Lower_Lim_Impulsivity[4]) {
        SigChange5f_Impulsivity<- paste(Rep_Df$Change_Impulsivity[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Impulsivity<- data.frame(Time4, SigChange5f_Impulsivity)
      names(Change_Rep_Df5c_Impulsivity)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Impulsivity, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Affective Instability Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Affective_Instability<- Entered_Scores_Df[,c(1,20,21,22,23,24,25)]
names(Scores_Table_Affective_Instability)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Affective_Instability<- kable(Stats_Table_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Affective_Instability, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p3<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Affective_Instability, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Affective_Instability_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Affective_Instability_1[1],":",Entered_Scores_Df$Cutoff_Score_Affective_Instability_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Affective_Instability_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Affective_Instability_2[1],":",Entered_Scores_Df$Cutoff_Score_Affective_Instability_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Affective_Instability_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Affective_Instability_3[1],":",Entered_Scores_Df$Cutoff_Score_Affective_Instability_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Affective_Instability_1[1],":",Entered_Scores_Df$Cutoff_Score_Affective_Instability_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Affective_Instability_2[1],":",Entered_Scores_Df$Cutoff_Score_Affective_Instability_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Affective_Instability_3[1],":",Entered_Scores_Df$Cutoff_Score_Affective_Instability_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Affective_Instability, ymax=Entered_Scores_Df$CI_Upper_Lim_Affective_Instability), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Affective_Instability)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Affective_Instability)), size = 3, family = "AvantGarde") 
  
p3<- p3+labs(x="Date", y = "Affective Instability Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 15), breaks = c(0,2,4,6,8,10),
                             labels = c('0 Min','2','4','6','8','10 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p3)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[2], "**")
      } else if(Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Affective_Instability<- data.frame(Time1, SigChange2_Affective_Instability)
      names(Change_Rep_Df2_Affective_Instability)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[2], "**")
      } else if(Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[2])
      }
      
      if(Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange3_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[3] - Rep_Df$Score_Affective_Instability[1]), "**")
      } else if(Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange3_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[3] - Rep_Df$Score_Affective_Instability[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Affective_Instability<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Affective_Instability)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Affective_Instability)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Upper_Lim_Affective_Instability[2] | Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange3a_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[3], "**")
      } else if(Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Upper_Lim_Affective_Instability[2] & Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange3a_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Affective_Instability<- data.frame(Time2, SigChange3a_Affective_Instability)
      names(Change_Rep_Df3a_Affective_Instability)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[2], "**")
      } else if(Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[2])
      }
      
      if(Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange3_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[3] - Rep_Df$Score_Affective_Instability[1]), "**")
      } else if(Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange3_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[3] - Rep_Df$Score_Affective_Instability[1]))
      }
      
      if(Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange4_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[1]), "**")
      } else if(Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange4_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Affective_Instability<- data.frame(Time1, SigChange2_Affective_Instability, SigChange3_Affective_Instability, SigChange4_Affective_Instability)
      names(Change_Rep_Df4_Affective_Instability)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Affective_Instability)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Affective_Instability)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Upper_Lim_Affective_Instability[2] | Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange4a_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[3], "**")
      } else if(Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Upper_Lim_Affective_Instability[2] & Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange4a_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[3])
      }
      
      if(Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Upper_Lim_Affective_Instability[2] | Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange4b_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[2]), "**")
      } else if(Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Upper_Lim_Affective_Instability[2] & Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange4b_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Affective_Instability<- data.frame(Time2, SigChange4a_Affective_Instability, SigChange4b_Affective_Instability)
      names(Change_Rep_Df4a_Affective_Instability)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Affective_Instability)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Upper_Lim_Affective_Instability[3] | Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Lower_Lim_Affective_Instability[3]) {
        SigChange4c_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[4], "**")
      } else if(Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Upper_Lim_Affective_Instability[3] & Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Lower_Lim_Affective_Instability[3]) {
        SigChange4c_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Affective_Instability<- data.frame(Time3, SigChange4c_Affective_Instability)
      names(Change_Rep_Df4b_Affective_Instability)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Affective_Instability[2] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[2] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange2_Affective_Instability<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange3_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[3] - Rep_Df$Score_Affective_Instability[1]), "**")
      } else if(Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange3_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[3] - Rep_Df$Score_Affective_Instability[1]))
      }
      
      if(Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange4_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[1]), "**")
      } else if(Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange4_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[1]))
      }
      
      if(Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Upper_Lim_Affective_Instability[1] | Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange5_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[5] - Rep_Df$Score_Affective_Instability[1]), "**")
      } else if(Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Upper_Lim_Affective_Instability[1] & Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Lower_Lim_Affective_Instability[1]) {
        SigChange5_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[5] - Rep_Df$Score_Affective_Instability[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Affective_Instability<- data.frame(Time1, SigChange2_Affective_Instability, SigChange3_Affective_Instability, SigChange4_Affective_Instability, SigChange5_Affective_Instability)
      names(Change_Rep_Df5_Affective_Instability)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Affective_Instability)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Affective_Instability)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Affective_Instability)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Upper_Lim_Affective_Instability[2] | Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange5a_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[3], "**")
      } else if(Rep_Df$Score_Affective_Instability[3] < Rep_Df$CI_Upper_Lim_Affective_Instability[2] & Rep_Df$Score_Affective_Instability[3] > Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange5a_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[3])
      }
      
      if(Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Upper_Lim_Affective_Instability[2] | Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange5b_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[2]), "**")
      } else if(Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Upper_Lim_Affective_Instability[2] & Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange5b_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[4] - Rep_Df$Score_Affective_Instability[2]))
      }
      
      if(Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Upper_Lim_Affective_Instability[2] | Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange5c_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[5] - Rep_Df$Score_Affective_Instability[2]), "**")
      } else if(Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Upper_Lim_Affective_Instability[2] & Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Lower_Lim_Affective_Instability[2]) {
        SigChange5c_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[5] - Rep_Df$Score_Affective_Instability[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Affective_Instability<- data.frame(Time2, SigChange5a_Affective_Instability, SigChange5b_Affective_Instability, SigChange5c_Affective_Instability)
      names(Change_Rep_Df5a_Affective_Instability)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Affective_Instability)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Affective_Instability)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Upper_Lim_Affective_Instability[3] | Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Lower_Lim_Affective_Instability[3]) {
        SigChange5d_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[4], "**")
      } else if(Rep_Df$Score_Affective_Instability[4] < Rep_Df$CI_Upper_Lim_Affective_Instability[3] & Rep_Df$Score_Affective_Instability[4] > Rep_Df$CI_Lower_Lim_Affective_Instability[3]) {
        SigChange5d_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[4])
      }
      
      if(Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Upper_Lim_Affective_Instability[3] | Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Lower_Lim_Affective_Instability[3]) {
        SigChange5e_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[5] - Rep_Df$Score_Affective_Instability[3]), "**")
      } else if(Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Upper_Lim_Affective_Instability[3] & Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Lower_Lim_Affective_Instability[3]) {
        SigChange5e_Affective_Instability<- paste((Rep_Df$Score_Affective_Instability[5] - Rep_Df$Score_Affective_Instability[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Affective_Instability<- data.frame(Time3, SigChange5d_Affective_Instability, SigChange5e_Affective_Instability)
      names(Change_Rep_Df5b_Affective_Instability)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Affective_Instability)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Upper_Lim_Affective_Instability[4] | Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Lower_Lim_Affective_Instability[4]) {
        SigChange5f_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[5], "**")
      } else if(Rep_Df$Score_Affective_Instability[5] < Rep_Df$CI_Upper_Lim_Affective_Instability[4] & Rep_Df$Score_Affective_Instability[5] > Rep_Df$CI_Lower_Lim_Affective_Instability[4]) {
        SigChange5f_Affective_Instability<- paste(Rep_Df$Change_Affective_Instability[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Affective_Instability<- data.frame(Time4, SigChange5f_Affective_Instability)
      names(Change_Rep_Df5c_Affective_Instability)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Affective_Instability, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Abandonment Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Abandonment<- Entered_Scores_Df[,c(1,29,30,31,32,33,34)]
names(Scores_Table_Abandonment)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Abandonment<- kable(Stats_Table_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Abandonment, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p4<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Abandonment, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Abandonment_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Abandonment_1[1],":",Entered_Scores_Df$Cutoff_Score_Abandonment_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Abandonment_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Abandonment_2[1],":",Entered_Scores_Df$Cutoff_Score_Abandonment_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Abandonment_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Abandonment_3[1],":",Entered_Scores_Df$Cutoff_Score_Abandonment_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Abandonment_1[1],":",Entered_Scores_Df$Cutoff_Score_Abandonment_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Abandonment_2[1],":",Entered_Scores_Df$Cutoff_Score_Abandonment_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Abandonment_3[1],":",Entered_Scores_Df$Cutoff_Score_Abandonment_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Abandonment, ymax=Entered_Scores_Df$CI_Upper_Lim_Abandonment), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Abandonment)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Abandonment)), size = 3, family = "AvantGarde") 
  
p4<- p4+labs(x="Date", y = "Abandonment Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 15), breaks = c(0,2,4,6,8,10), labels = c('0 Min','2','4','6','8','10 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p4)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2], "**")
      } else if(Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Abandonment<- data.frame(Time1, SigChange2_Abandonment)
      names(Change_Rep_Df2_Abandonment)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2], "**")
      } else if(Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2])
      }
      
      if(Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange3_Abandonment<- paste((Rep_Df$Score_Abandonment[3] - Rep_Df$Score_Abandonment[1]), "**")
      } else if(Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange3_Abandonment<- paste((Rep_Df$Score_Abandonment[3] - Rep_Df$Score_Abandonment[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Abandonment<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Abandonment)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Abandonment)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Upper_Lim_Abandonment[2] | Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange3a_Abandonment<- paste(Rep_Df$Change_Abandonment[3], "**")
      } else if(Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Upper_Lim_Abandonment[2] & Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange3a_Abandonment<- paste(Rep_Df$Change_Abandonment[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Abandonment<- data.frame(Time2, SigChange3a_Abandonment)
      names(Change_Rep_Df3a_Abandonment)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2], "**")
      } else if(Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2])
      }
      
      if(Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange3_Abandonment<- paste((Rep_Df$Score_Abandonment[3] - Rep_Df$Score_Abandonment[1]), "**")
      } else if(Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange3_Abandonment<- paste((Rep_Df$Score_Abandonment[3] - Rep_Df$Score_Abandonment[1]))
      }
      
      if(Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange4_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[1]), "**")
      } else if(Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange4_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Abandonment<- data.frame(Time1, SigChange2_Abandonment, SigChange3_Abandonment, SigChange4_Abandonment)
      names(Change_Rep_Df4_Abandonment)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Abandonment)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Abandonment)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Upper_Lim_Abandonment[2] | Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange4a_Abandonment<- paste(Rep_Df$Change_Abandonment[3], "**")
      } else if(Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Upper_Lim_Abandonment[2] & Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange4a_Abandonment<- paste(Rep_Df$Change_Abandonment[3])
      }
      
      if(Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Upper_Lim_Abandonment[2] | Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange4b_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[2]), "**")
      } else if(Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Upper_Lim_Abandonment[2] & Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange4b_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Abandonment<- data.frame(Time2, SigChange4a_Abandonment, SigChange4b_Abandonment)
      names(Change_Rep_Df4a_Abandonment)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Abandonment)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Upper_Lim_Abandonment[3] | Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Lower_Lim_Abandonment[3]) {
        SigChange4c_Abandonment<- paste(Rep_Df$Change_Abandonment[4], "**")
      } else if(Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Upper_Lim_Abandonment[3] & Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Lower_Lim_Abandonment[3]) {
        SigChange4c_Abandonment<- paste(Rep_Df$Change_Abandonment[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Abandonment<- data.frame(Time3, SigChange4c_Abandonment)
      names(Change_Rep_Df4b_Abandonment)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2], "**")
      } else if(Rep_Df$Score_Abandonment[2] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[2] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange2_Abandonment<- paste(Rep_Df$Change_Abandonment[2])
      }
      
      if(Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange3_Abandonment<- paste((Rep_Df$Score_Abandonment[3] - Rep_Df$Score_Abandonment[1]), "**")
      } else if(Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange3_Abandonment<- paste((Rep_Df$Score_Abandonment[3] - Rep_Df$Score_Abandonment[1]))
      }
      
      if(Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange4_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[1]), "**")
      } else if(Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange4_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[1]))
      }
      
      if(Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Upper_Lim_Abandonment[1] | Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange5_Abandonment<- paste((Rep_Df$Score_Abandonment[5] - Rep_Df$Score_Abandonment[1]), "**")
      } else if(Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Upper_Lim_Abandonment[1] & Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Lower_Lim_Abandonment[1]) {
        SigChange5_Abandonment<- paste((Rep_Df$Score_Abandonment[5] - Rep_Df$Score_Abandonment[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Abandonment<- data.frame(Time1, SigChange2_Abandonment, SigChange3_Abandonment, SigChange4_Abandonment, SigChange5_Abandonment)
      names(Change_Rep_Df5_Abandonment)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Abandonment)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Abandonment)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Abandonment)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Upper_Lim_Abandonment[2] | Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange5a_Abandonment<- paste(Rep_Df$Change_Abandonment[3], "**")
      } else if(Rep_Df$Score_Abandonment[3] < Rep_Df$CI_Upper_Lim_Abandonment[2] & Rep_Df$Score_Abandonment[3] > Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange5a_Abandonment<- paste(Rep_Df$Change_Abandonment[3])
      }
      
      if(Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Upper_Lim_Abandonment[2] | Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange5b_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[2]), "**")
      } else if(Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Upper_Lim_Abandonment[2] & Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange5b_Abandonment<- paste((Rep_Df$Score_Abandonment[4] - Rep_Df$Score_Abandonment[2]))
      }
      
      if(Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Upper_Lim_Abandonment[2] | Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange5c_Abandonment<- paste((Rep_Df$Score_Abandonment[5] - Rep_Df$Score_Abandonment[2]), "**")
      } else if(Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Upper_Lim_Abandonment[2] & Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Lower_Lim_Abandonment[2]) {
        SigChange5c_Abandonment<- paste((Rep_Df$Score_Abandonment[5] - Rep_Df$Score_Abandonment[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Abandonment<- data.frame(Time2, SigChange5a_Abandonment, SigChange5b_Abandonment, SigChange5c_Abandonment)
      names(Change_Rep_Df5a_Abandonment)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Abandonment)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Abandonment)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Upper_Lim_Abandonment[3] | Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Lower_Lim_Abandonment[3]) {
        SigChange5d_Abandonment<- paste(Rep_Df$Change_Abandonment[4], "**")
      } else if(Rep_Df$Score_Abandonment[4] < Rep_Df$CI_Upper_Lim_Abandonment[3] & Rep_Df$Score_Abandonment[4] > Rep_Df$CI_Lower_Lim_Abandonment[3]) {
        SigChange5d_Abandonment<- paste(Rep_Df$Change_Abandonment[4])
      }
      
      if(Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Upper_Lim_Abandonment[3] | Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Lower_Lim_Abandonment[3]) {
        SigChange5e_Abandonment<- paste((Rep_Df$Score_Abandonment[5] - Rep_Df$Score_Abandonment[3]), "**")
      } else if(Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Upper_Lim_Abandonment[3] & Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Lower_Lim_Abandonment[3]) {
        SigChange5e_Abandonment<- paste((Rep_Df$Score_Abandonment[5] - Rep_Df$Score_Abandonment[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Abandonment<- data.frame(Time3, SigChange5d_Abandonment, SigChange5e_Abandonment)
      names(Change_Rep_Df5b_Abandonment)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Abandonment)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Upper_Lim_Abandonment[4] | Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Lower_Lim_Abandonment[4]) {
        SigChange5f_Abandonment<- paste(Rep_Df$Change_Abandonment[5], "**")
      } else if(Rep_Df$Score_Abandonment[5] < Rep_Df$CI_Upper_Lim_Abandonment[4] & Rep_Df$Score_Abandonment[5] > Rep_Df$CI_Lower_Lim_Abandonment[4]) {
        SigChange5f_Abandonment<- paste(Rep_Df$Change_Abandonment[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Abandonment<- data.frame(Time4, SigChange5f_Abandonment)
      names(Change_Rep_Df5c_Abandonment)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Abandonment, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage


#Relationships Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Relationships<- Entered_Scores_Df[,c(1,38,39,40,41,42,43)]
names(Scores_Table_Relationships)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Relationships<- kable(Stats_Table_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Relationships, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p5<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Relationships, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Relationships_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Relationships_1[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Relationships_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Relationships_2[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Relationships_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Relationships_3[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Relationships_1[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Relationships_2[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Relationships_3[1],":",Entered_Scores_Df$Cutoff_Score_Relationships_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Relationships, ymax=Entered_Scores_Df$CI_Upper_Lim_Relationships), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Relationships)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Relationships)), size = 3, family = "AvantGarde") 
  
p5<- p5+labs(x="Date", y = "Relationships Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-4, 12), breaks = c(0,2,4,6,8), labels = c('0 Min','2','4','6','8 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p5)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Relationships<- data.frame(Time1, SigChange2_Relationships)
      names(Change_Rep_Df2_Relationships)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Relationships<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Relationships)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Relationships)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange3a_Relationships<- paste(Rep_Df$Change_Relationships[3], "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange3a_Relationships<- paste(Rep_Df$Change_Relationships[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Relationships<- data.frame(Time2, SigChange3a_Relationships)
      names(Change_Rep_Df3a_Relationships)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]))
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Relationships<- data.frame(Time1, SigChange2_Relationships, SigChange3_Relationships, SigChange4_Relationships)
      names(Change_Rep_Df4_Relationships)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Relationships)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Relationships)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4a_Relationships<- paste(Rep_Df$Change_Relationships[3], "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4a_Relationships<- paste(Rep_Df$Change_Relationships[3])
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange4b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Relationships<- data.frame(Time2, SigChange4a_Relationships, SigChange4b_Relationships)
      names(Change_Rep_Df4a_Relationships)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Relationships)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[3] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange4c_Relationships<- paste(Rep_Df$Change_Relationships[4], "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[3] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange4c_Relationships<- paste(Rep_Df$Change_Relationships[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Relationships<- data.frame(Time3, SigChange4c_Relationships)
      names(Change_Rep_Df4b_Relationships)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Relationships[2] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[2] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2], "**")
      } else if(Rep_Df$Score_Relationships[2] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[2] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange2_Relationships<- paste(Rep_Df$Change_Relationships[2])
      }
      
      if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange3_Relationships<- paste((Rep_Df$Score_Relationships[3] - Rep_Df$Score_Relationships[1]))
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange4_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[1]))
      }
      
      if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[1] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange5_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[1]), "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[1] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[1]) {
        SigChange5_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Relationships<- data.frame(Time1, SigChange2_Relationships, SigChange3_Relationships, SigChange4_Relationships, SigChange5_Relationships)
      names(Change_Rep_Df5_Relationships)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Relationships)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Relationships)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Relationships)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Relationships[3] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[3] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5a_Relationships<- paste(Rep_Df$Change_Relationships[3], "**")
      } else if(Rep_Df$Score_Relationships[3] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[3] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5a_Relationships<- paste(Rep_Df$Change_Relationships[3])
      }
      
      if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]), "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5b_Relationships<- paste((Rep_Df$Score_Relationships[4] - Rep_Df$Score_Relationships[2]))
      }
      
      if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[2] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5c_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[2]), "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[2] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[2]) {
        SigChange5c_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Relationships<- data.frame(Time2, SigChange5a_Relationships, SigChange5b_Relationships, SigChange5c_Relationships)
      names(Change_Rep_Df5a_Relationships)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Relationships)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Relationships)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Relationships[4] > Rep_Df$CI_Upper_Lim_Relationships[3] | Rep_Df$Score_Relationships[4] < Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5d_Relationships<- paste(Rep_Df$Change_Relationships[4], "**")
      } else if(Rep_Df$Score_Relationships[4] < Rep_Df$CI_Upper_Lim_Relationships[3] & Rep_Df$Score_Relationships[4] > Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5d_Relationships<- paste(Rep_Df$Change_Relationships[4])
      }
      
      if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[3] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5e_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[3]), "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[3] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[3]) {
        SigChange5e_Relationships<- paste((Rep_Df$Score_Relationships[5] - Rep_Df$Score_Relationships[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Relationships<- data.frame(Time3, SigChange5d_Relationships, SigChange5e_Relationships)
      names(Change_Rep_Df5b_Relationships)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Relationships)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Relationships[5] > Rep_Df$CI_Upper_Lim_Relationships[4] | Rep_Df$Score_Relationships[5] < Rep_Df$CI_Lower_Lim_Relationships[4]) {
        SigChange5f_Relationships<- paste(Rep_Df$Change_Relationships[5], "**")
      } else if(Rep_Df$Score_Relationships[5] < Rep_Df$CI_Upper_Lim_Relationships[4] & Rep_Df$Score_Relationships[5] > Rep_Df$CI_Lower_Lim_Relationships[4]) {
        SigChange5f_Relationships<- paste(Rep_Df$Change_Relationships[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Relationships<- data.frame(Time4, SigChange5f_Relationships)
      names(Change_Rep_Df5c_Relationships)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Relationships, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Self Image Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Self_Image<- Entered_Scores_Df[,c(1,47,48,49,50,51,52)]
names(Scores_Table_Self_Image)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Self_Image<- kable(Stats_Table_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Self_Image, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p6<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Self_Image, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Self_Image_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Self_Image_1[1],":",Entered_Scores_Df$Cutoff_Score_Self_Image_1[1])),  color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Self_Image_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Self_Image_2[1],":",Entered_Scores_Df$Cutoff_Score_Self_Image_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Self_Image_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Self_Image_3[1],":",Entered_Scores_Df$Cutoff_Score_Self_Image_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"),
limits = c(paste(Cutoff_Names$Cutoff_Name_Self_Image_1[1],":",Entered_Scores_Df$Cutoff_Score_Self_Image_1[1]),                                                   paste(Cutoff_Names$Cutoff_Name_Self_Image_2[1],":",Entered_Scores_Df$Cutoff_Score_Self_Image_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Self_Image_3[1],":",Entered_Scores_Df$Cutoff_Score_Self_Image_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Self_Image, ymax=Entered_Scores_Df$CI_Upper_Lim_Self_Image), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Self_Image)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Self_Image)), size = 3, family = "AvantGarde")
  
p6<- p6+labs(x="Date", y = "Self Image Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-4, 13), breaks = c(0,3,6,9), labels = c('0 Min','3','6','9 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p6)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2], "**")
      } else if(Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Self_Image<- data.frame(Time1, SigChange2_Self_Image)
      names(Change_Rep_Df2_Self_Image)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2], "**")
      } else if(Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2])
      }
      
      if(Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange3_Self_Image<- paste((Rep_Df$Score_Self_Image[3] - Rep_Df$Score_Self_Image[1]), "**")
      } else if(Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange3_Self_Image<- paste((Rep_Df$Score_Self_Image[3] - Rep_Df$Score_Self_Image[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Self_Image<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Self_Image)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Self_Image)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Upper_Lim_Self_Image[2] | Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange3a_Self_Image<- paste(Rep_Df$Change_Self_Image[3], "**")
      } else if(Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Upper_Lim_Self_Image[2] & Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange3a_Self_Image<- paste(Rep_Df$Change_Self_Image[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Self_Image<- data.frame(Time2, SigChange3a_Self_Image)
      names(Change_Rep_Df3a_Self_Image)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2], "**")
      } else if(Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2])
      }
      
      if(Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange3_Self_Image<- paste((Rep_Df$Score_Self_Image[3] - Rep_Df$Score_Self_Image[1]), "**")
      } else if(Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange3_Self_Image<- paste((Rep_Df$Score_Self_Image[3] - Rep_Df$Score_Self_Image[1]))
      }
      
      if(Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange4_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[1]), "**")
      } else if(Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange4_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Self_Image<- data.frame(Time1, SigChange2_Self_Image, SigChange3_Self_Image, SigChange4_Self_Image)
      names(Change_Rep_Df4_Self_Image)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Self_Image)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Self_Image)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Upper_Lim_Self_Image[2] | Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange4a_Self_Image<- paste(Rep_Df$Change_Self_Image[3], "**")
      } else if(Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Upper_Lim_Self_Image[2] & Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange4a_Self_Image<- paste(Rep_Df$Change_Self_Image[3])
      }
      
      if(Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Upper_Lim_Self_Image[2] | Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange4b_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[2]), "**")
      } else if(Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Upper_Lim_Self_Image[2] & Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange4b_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Self_Image<- data.frame(Time2, SigChange4a_Self_Image, SigChange4b_Self_Image)
      names(Change_Rep_Df4a_Self_Image)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Self_Image)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Upper_Lim_Self_Image[3] | Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Lower_Lim_Self_Image[3]) {
        SigChange4c_Self_Image<- paste(Rep_Df$Change_Self_Image[4], "**")
      } else if(Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Upper_Lim_Self_Image[3] & Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Lower_Lim_Self_Image[3]) {
        SigChange4c_Self_Image<- paste(Rep_Df$Change_Self_Image[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Self_Image<- data.frame(Time3, SigChange4c_Self_Image)
      names(Change_Rep_Df4b_Self_Image)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2], "**")
      } else if(Rep_Df$Score_Self_Image[2] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[2] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange2_Self_Image<- paste(Rep_Df$Change_Self_Image[2])
      }
      
      if(Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange3_Self_Image<- paste((Rep_Df$Score_Self_Image[3] - Rep_Df$Score_Self_Image[1]), "**")
      } else if(Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange3_Self_Image<- paste((Rep_Df$Score_Self_Image[3] - Rep_Df$Score_Self_Image[1]))
      }
      
      if(Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange4_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[1]), "**")
      } else if(Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange4_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[1]))
      }
      
      if(Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Upper_Lim_Self_Image[1] | Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange5_Self_Image<- paste((Rep_Df$Score_Self_Image[5] - Rep_Df$Score_Self_Image[1]), "**")
      } else if(Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Upper_Lim_Self_Image[1] & Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Lower_Lim_Self_Image[1]) {
        SigChange5_Self_Image<- paste((Rep_Df$Score_Self_Image[5] - Rep_Df$Score_Self_Image[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Self_Image<- data.frame(Time1, SigChange2_Self_Image, SigChange3_Self_Image, SigChange4_Self_Image, SigChange5_Self_Image)
      names(Change_Rep_Df5_Self_Image)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Self_Image)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Self_Image)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Self_Image)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Upper_Lim_Self_Image[2] | Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange5a_Self_Image<- paste(Rep_Df$Change_Self_Image[3], "**")
      } else if(Rep_Df$Score_Self_Image[3] < Rep_Df$CI_Upper_Lim_Self_Image[2] & Rep_Df$Score_Self_Image[3] > Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange5a_Self_Image<- paste(Rep_Df$Change_Self_Image[3])
      }
      
      if(Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Upper_Lim_Self_Image[2] | Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange5b_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[2]), "**")
      } else if(Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Upper_Lim_Self_Image[2] & Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange5b_Self_Image<- paste((Rep_Df$Score_Self_Image[4] - Rep_Df$Score_Self_Image[2]))
      }
      
      if(Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Upper_Lim_Self_Image[2] | Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange5c_Self_Image<- paste((Rep_Df$Score_Self_Image[5] - Rep_Df$Score_Self_Image[2]), "**")
      } else if(Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Upper_Lim_Self_Image[2] & Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Lower_Lim_Self_Image[2]) {
        SigChange5c_Self_Image<- paste((Rep_Df$Score_Self_Image[5] - Rep_Df$Score_Self_Image[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Self_Image<- data.frame(Time2, SigChange5a_Self_Image, SigChange5b_Self_Image, SigChange5c_Self_Image)
      names(Change_Rep_Df5a_Self_Image)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Self_Image)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Self_Image)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Upper_Lim_Self_Image[3] | Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Lower_Lim_Self_Image[3]) {
        SigChange5d_Self_Image<- paste(Rep_Df$Change_Self_Image[4], "**")
      } else if(Rep_Df$Score_Self_Image[4] < Rep_Df$CI_Upper_Lim_Self_Image[3] & Rep_Df$Score_Self_Image[4] > Rep_Df$CI_Lower_Lim_Self_Image[3]) {
        SigChange5d_Self_Image<- paste(Rep_Df$Change_Self_Image[4])
      }
      
      if(Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Upper_Lim_Self_Image[3] | Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Lower_Lim_Self_Image[3]) {
        SigChange5e_Self_Image<- paste((Rep_Df$Score_Self_Image[5] - Rep_Df$Score_Self_Image[3]), "**")
      } else if(Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Upper_Lim_Self_Image[3] & Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Lower_Lim_Self_Image[3]) {
        SigChange5e_Self_Image<- paste((Rep_Df$Score_Self_Image[5] - Rep_Df$Score_Self_Image[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Self_Image<- data.frame(Time3, SigChange5d_Self_Image, SigChange5e_Self_Image)
      names(Change_Rep_Df5b_Self_Image)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Self_Image)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Upper_Lim_Self_Image[4] | Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Lower_Lim_Self_Image[4]) {
        SigChange5f_Self_Image<- paste(Rep_Df$Change_Self_Image[5], "**")
      } else if(Rep_Df$Score_Self_Image[5] < Rep_Df$CI_Upper_Lim_Self_Image[4] & Rep_Df$Score_Self_Image[5] > Rep_Df$CI_Lower_Lim_Self_Image[4]) {
        SigChange5f_Self_Image<- paste(Rep_Df$Change_Self_Image[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Self_Image<- data.frame(Time4, SigChange5f_Self_Image)
      names(Change_Rep_Df5c_Self_Image)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Self_Image, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage

#Suicide/Self-Mutilation Subscale

##Response Summary
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Scores_Table_Suicide_Mutilation<- Entered_Scores_Df[,c(1,56,57,58,59,60,61)]
names(Scores_Table_Suicide_Mutilation)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")

kable(Scores_Table_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses
```{r, echo = FALSE, warning = FALSE, , comment=NA}

Stats_Table_Suicide_Mutilation<- kable(Stats_Table_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Suicide_Mutilation, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend
```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p7<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Suicide_Mutilation, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Suicide_Mutilation_1[1],":",Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Suicide_Mutilation_2[1],":",Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Suicide_Mutilation_3[1],":",Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_3[1])), color = "#827717", size = 0.4)  + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Suicide_Mutilation_1[1],":",Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Suicide_Mutilation_2[1],":",Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_2[1]),                                            paste(Cutoff_Names$Cutoff_Name_Suicide_Mutilation_3[1],":",Entered_Scores_Df$Cutoff_Score_Suicide_Mutilation_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Suicide_Mutilation, ymax=Entered_Scores_Df$CI_Upper_Lim_Suicide_Mutilation), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Suicide_Mutilation)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Suicide_Mutilation)), size = 3, family = "AvantGarde") 
  
p7<- p7+labs(x="Date", y = "Suicide Mutilation Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-4, 11), breaks = c(0,1,2,3,4,5,6,7),
                             labels = c('0 Min','1','2','3','4','5','6','7 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p7)
```


##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **
```{r, echo = FALSE, warning = FALSE,comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[2], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Suicide_Mutilation<- data.frame(Time1, SigChange2_Suicide_Mutilation)
      names(Change_Rep_Df2_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[2], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[2])
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange3_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[3] - Rep_Df$Score_Suicide_Mutilation[1]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange3_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[3] - Rep_Df$Score_Suicide_Mutilation[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Suicide_Mutilation<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Suicide_Mutilation)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] | Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange3a_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[3], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] & Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange3a_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Suicide_Mutilation<- data.frame(Time2, SigChange3a_Suicide_Mutilation)
      names(Change_Rep_Df3a_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[2], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[2])
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange3_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[3] - Rep_Df$Score_Suicide_Mutilation[1]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange3_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[3] - Rep_Df$Score_Suicide_Mutilation[1]))
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange4_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[1]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange4_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Suicide_Mutilation<- data.frame(Time1, SigChange2_Suicide_Mutilation, SigChange3_Suicide_Mutilation, SigChange4_Suicide_Mutilation)
      names(Change_Rep_Df4_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Suicide_Mutilation)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Suicide_Mutilation)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] | Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange4a_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[3], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] & Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange4a_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[3])
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] | Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange4b_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[2]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] & Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange4b_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Suicide_Mutilation<- data.frame(Time2, SigChange4a_Suicide_Mutilation, SigChange4b_Suicide_Mutilation)
      names(Change_Rep_Df4a_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Suicide_Mutilation)[3]<- paste0(Rep_Df$Date[4])   
  
  
kable(Change_Rep_Df4a_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[3] | Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[3]) {
        SigChange4c_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[4], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[3] & Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[3]) {
        SigChange4c_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Suicide_Mutilation<- data.frame(Time3, SigChange4c_Suicide_Mutilation)
      names(Change_Rep_Df4b_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[4])    
  
  
  
kable(Change_Rep_Df4b_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change[2], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[2] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[2] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange2_Suicide_Mutilation<- paste(Rep_Df$Change[2])
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange3_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[3] - Rep_Df$Score_Suicide_Mutilation[1]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange3_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[3] - Rep_Df$Score_Suicide_Mutilation[1]))
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange4_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[1]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange4_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[1]))
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] | Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange5_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[5] - Rep_Df$Score_Suicide_Mutilation[1]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[1] & Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[1]) {
        SigChange5_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[5] - Rep_Df$Score_Suicide_Mutilation[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Suicide_Mutilation<- data.frame(Time1, SigChange2_Suicide_Mutilation, SigChange3_Suicide_Mutilation, SigChange4_Suicide_Mutilation, SigChange5_Suicide_Mutilation)
      names(Change_Rep_Df5_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Suicide_Mutilation)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Suicide_Mutilation)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Suicide_Mutilation)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] | Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange5a_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[3], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[3] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] & Rep_Df$Score_Suicide_Mutilation[3] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange5a_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[3])
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] | Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange5b_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[2]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] & Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange5b_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[4] - Rep_Df$Score_Suicide_Mutilation[2]))
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] | Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange5c_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[5] - Rep_Df$Score_Suicide_Mutilation[2]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[2] & Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[2]) {
        SigChange5c_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[5] - Rep_Df$Score_Suicide_Mutilation[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Suicide_Mutilation<- data.frame(Time2, SigChange5a_Suicide_Mutilation, SigChange5b_Suicide_Mutilation, SigChange5c_Suicide_Mutilation)
      names(Change_Rep_Df5a_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Suicide_Mutilation)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Suicide_Mutilation)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[3] | Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[3]) {
        SigChange5d_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[4], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[4] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[3] & Rep_Df$Score_Suicide_Mutilation[4] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[3]) {
        SigChange5d_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[4])
      }
      
      if(Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[3] | Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[3]) {
        SigChange5e_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[5] - Rep_Df$Score_Suicide_Mutilation[3]), "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[3] & Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[3]) {
        SigChange5e_Suicide_Mutilation<- paste((Rep_Df$Score_Suicide_Mutilation[5] - Rep_Df$Score_Suicide_Mutilation[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Suicide_Mutilation<- data.frame(Time3, SigChange5d_Suicide_Mutilation, SigChange5e_Suicide_Mutilation)
      names(Change_Rep_Df5b_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Suicide_Mutilation)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Upper_Lim_Suicide_Mutilation[4] | Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Lower_Lim_Suicide_Mutilation[4]) {
        SigChange5f_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[5], "**")
      } else if(Rep_Df$Score_Suicide_Mutilation[5] < Rep_Df$CI_Upper_Lim_Suicide_Mutilation[4] & Rep_Df$Score_Suicide_Mutilation[5] > Rep_Df$CI_Lower_Lim_Suicide_Mutilation[4]) {
        SigChange5f_Suicide_Mutilation<- paste(Rep_Df$Change_Suicide_Mutilation[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Suicide_Mutilation<- data.frame(Time4, SigChange5f_Suicide_Mutilation)
      names(Change_Rep_Df5c_Suicide_Mutilation)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Suicide_Mutilation, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage 

#Emptiness Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Emptiness<- Entered_Scores_Df[,c(1,65,66,67,68,69,70)]
names(Scores_Table_Emptiness)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Emptiness<- kable(Stats_Table_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Emptiness, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p8<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Emptiness, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Emptiness_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Emptiness_1[1],":",Entered_Scores_Df$Cutoff_Score_Emptiness_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Emptiness_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Emptiness_2[1],":",Entered_Scores_Df$Cutoff_Score_Emptiness_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Emptiness_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Emptiness_3[1],":",Entered_Scores_Df$Cutoff_Score_Emptiness_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Emptiness_1[1],":",Entered_Scores_Df$Cutoff_Score_Emptiness_1[1]),                                           paste(Cutoff_Names$Cutoff_Name_Emptiness_2[1],":",Entered_Scores_Df$Cutoff_Score_Emptiness_2[1]),                            paste(Cutoff_Names$Cutoff_Name_Emptiness_3[1],":",Entered_Scores_Df$Cutoff_Score_Emptiness_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Emptiness, ymax=Entered_Scores_Df$CI_Upper_Lim_Emptiness), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Emptiness)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Emptiness)), size = 3, family = "AvantGarde")
  
p8<- p8+labs(x="Date", y = "Emptiness Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 15), breaks = c(0,2,4,6,8,10), labels = c('0 Min','2','4','6','8','10 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p8)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2], "**")
      } else if(Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Emptiness<- data.frame(Time1, SigChange2_Emptiness)
      names(Change_Rep_Df2_Emptiness)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2], "**")
      } else if(Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2])
      }
      
      if(Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange3_Emptiness<- paste((Rep_Df$Score_Emptiness[3] - Rep_Df$Score_Emptiness[1]), "**")
      } else if(Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange3_Emptiness<- paste((Rep_Df$Score_Emptiness[3] - Rep_Df$Score_Emptiness[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Emptiness<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Emptiness)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Emptiness)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Upper_Lim_Emptiness[2] | Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange3a_Emptiness<- paste(Rep_Df$Change_Emptiness[3], "**")
      } else if(Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Upper_Lim_Emptiness[2] & Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange3a_Emptiness<- paste(Rep_Df$Change_Emptiness[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Emptiness<- data.frame(Time2, SigChange3a_Emptiness)
      names(Change_Rep_Df3a_Emptiness)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2], "**")
      } else if(Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2])
      }
      
      if(Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange3_Emptiness<- paste((Rep_Df$Score_Emptiness[3] - Rep_Df$Score_Emptiness[1]), "**")
      } else if(Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange3_Emptiness<- paste((Rep_Df$Score_Emptiness[3] - Rep_Df$Score_Emptiness[1]))
      }
      
      if(Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange4_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[1]), "**")
      } else if(Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange4_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Emptiness<- data.frame(Time1, SigChange2_Emptiness, SigChange3_Emptiness, SigChange4_Emptiness)
      names(Change_Rep_Df4_Emptiness)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Emptiness)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Emptiness)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Upper_Lim_Emptiness[2] | Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange4a_Emptiness<- paste(Rep_Df$Change_Emptiness[3], "**")
      } else if(Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Upper_Lim_Emptiness[2] & Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange4a_Emptiness<- paste(Rep_Df$Change_Emptiness[3])
      }
      
      if(Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Upper_Lim_Emptiness[2] | Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange4b_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[2]), "**")
      } else if(Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Upper_Lim_Emptiness[2] & Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange4b_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Emptiness<- data.frame(Time2, SigChange4a_Emptiness, SigChange4b_Emptiness)
      names(Change_Rep_Df4a_Emptiness)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Emptiness)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Upper_Lim_Emptiness[3] | Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Lower_Lim_Emptiness[3]) {
        SigChange4c_Emptiness<- paste(Rep_Df$Change_Emptiness[4], "**")
      } else if(Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Upper_Lim_Emptiness[3] & Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Lower_Lim_Emptiness[3]) {
        SigChange4c_Emptiness<- paste(Rep_Df$Change_Emptiness[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Emptiness<- data.frame(Time3, SigChange4c_Emptiness)
      names(Change_Rep_Df4b_Emptiness)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2], "**")
      } else if(Rep_Df$Score_Emptiness[2] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[2] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange2_Emptiness<- paste(Rep_Df$Change_Emptiness[2])
      }
      
      if(Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange3_Emptiness<- paste((Rep_Df$Score_Emptiness[3] - Rep_Df$Score_Emptiness[1]), "**")
      } else if(Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange3_Emptiness<- paste((Rep_Df$Score_Emptiness[3] - Rep_Df$Score_Emptiness[1]))
      }
      
      if(Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange4_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[1]), "**")
      } else if(Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange4_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[1]))
      }
      
      if(Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Upper_Lim_Emptiness[1] | Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange5_Emptiness<- paste((Rep_Df$Score_Emptiness[5] - Rep_Df$Score_Emptiness[1]), "**")
      } else if(Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Upper_Lim_Emptiness[1] & Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Lower_Lim_Emptiness[1]) {
        SigChange5_Emptiness<- paste((Rep_Df$Score_Emptiness[5] - Rep_Df$Score_Emptiness[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Emptiness<- data.frame(Time1, SigChange2_Emptiness, SigChange3_Emptiness, SigChange4_Emptiness, SigChange5_Emptiness)
      names(Change_Rep_Df5_Emptiness)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Emptiness)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Emptiness)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Emptiness)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Upper_Lim_Emptiness[2] | Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange5a_Emptiness<- paste(Rep_Df$Change_Emptiness[3], "**")
      } else if(Rep_Df$Score_Emptiness[3] < Rep_Df$CI_Upper_Lim_Emptiness[2] & Rep_Df$Score_Emptiness[3] > Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange5a_Emptiness<- paste(Rep_Df$Change_Emptiness[3])
      }
      
      if(Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Upper_Lim_Emptiness[2] | Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange5b_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[2]), "**")
      } else if(Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Upper_Lim_Emptiness[2] & Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange5b_Emptiness<- paste((Rep_Df$Score_Emptiness[4] - Rep_Df$Score_Emptiness[2]))
      }
      
      if(Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Upper_Lim_Emptiness[2] | Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange5c_Emptiness<- paste((Rep_Df$Score_Emptiness[5] - Rep_Df$Score_Emptiness[2]), "**")
      } else if(Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Upper_Lim_Emptiness[2] & Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Lower_Lim_Emptiness[2]) {
        SigChange5c_Emptiness<- paste((Rep_Df$Score_Emptiness[5] - Rep_Df$Score_Emptiness[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Emptiness<- data.frame(Time2, SigChange5a_Emptiness, SigChange5b_Emptiness, SigChange5c_Emptiness)
      names(Change_Rep_Df5a_Emptiness)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Emptiness)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Emptiness)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Upper_Lim_Emptiness[3] | Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Lower_Lim_Emptiness[3]) {
        SigChange5d_Emptiness<- paste(Rep_Df$Change_Emptiness[4], "**")
      } else if(Rep_Df$Score_Emptiness[4] < Rep_Df$CI_Upper_Lim_Emptiness[3] & Rep_Df$Score_Emptiness[4] > Rep_Df$CI_Lower_Lim_Emptiness[3]) {
        SigChange5d_Emptiness<- paste(Rep_Df$Change_Emptiness[4])
      }
      
      if(Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Upper_Lim_Emptiness[3] | Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Lower_Lim_Emptiness[3]) {
        SigChange5e_Emptiness<- paste((Rep_Df$Score_Emptiness[5] - Rep_Df$Score_Emptiness[3]), "**")
      } else if(Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Upper_Lim_Emptiness[3] & Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Lower_Lim_Emptiness[3]) {
        SigChange5e_Emptiness<- paste((Rep_Df$Score_Emptiness[5] - Rep_Df$Score_Emptiness[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Emptiness<- data.frame(Time3, SigChange5d_Emptiness, SigChange5e_Emptiness)
      names(Change_Rep_Df5b_Emptiness)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Emptiness)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Upper_Lim_Emptiness[4] | Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Lower_Lim_Emptiness[4]) {
        SigChange5f_Emptiness<- paste(Rep_Df$Change_Emptiness[5], "**")
      } else if(Rep_Df$Score_Emptiness[5] < Rep_Df$CI_Upper_Lim_Emptiness[4] & Rep_Df$Score_Emptiness[5] > Rep_Df$CI_Lower_Lim_Emptiness[4]) {
        SigChange5f_Emptiness<- paste(Rep_Df$Change_Emptiness[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Emptiness<- data.frame(Time4, SigChange5f_Emptiness)
      names(Change_Rep_Df5c_Emptiness)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Emptiness, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage


#Intense Anger Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Anger<- Entered_Scores_Df[,c(1,74,75,76,77,78,79)]
names(Scores_Table_Anger)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Anger<- kable(Stats_Table_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Anger, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p9<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Anger, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Anger_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Anger_1[1],":",Entered_Scores_Df$Cutoff_Score_Anger_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Anger_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Anger_2[1],":",Entered_Scores_Df$Cutoff_Score_Anger_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Anger_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Anger_3[1],":",Entered_Scores_Df$Cutoff_Score_Anger_3[1])), color = "#827717", size = 0.4) + scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Anger_1[1],":",Entered_Scores_Df$Cutoff_Score_Anger_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Anger_2[1],":",Entered_Scores_Df$Cutoff_Score_Anger_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Anger_3[1],":",Entered_Scores_Df$Cutoff_Score_Anger_3[1]))) +
  geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Anger, ymax=Entered_Scores_Df$CI_Upper_Lim_Anger), width=.2, size = 0.6,
                 position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Anger)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Anger)), size = 3, family = "AvantGarde")
  
p9<- p9+labs(x="Date", y = "Intense Anger Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-5, 15), breaks = c(0,2,4,6,8,10), labels = c('0 Min','2','4','6','8','10 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p9)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anger[2] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[2] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2], "**")
      } else if(Rep_Df$Score_Anger[2] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[2] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Anger<- data.frame(Time1, SigChange2_Anger)
      names(Change_Rep_Df2_Anger)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anger[2] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[2] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2], "**")
      } else if(Rep_Df$Score_Anger[2] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[2] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2])
      }
      
      if(Rep_Df$Score_Anger[3] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[3] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange3_Anger<- paste((Rep_Df$Score_Anger[3] - Rep_Df$Score_Anger[1]), "**")
      } else if(Rep_Df$Score_Anger[3] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[3] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange3_Anger<- paste((Rep_Df$Score_Anger[3] - Rep_Df$Score_Anger[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Anger<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Anger)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Anger)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Anger[3] > Rep_Df$CI_Upper_Lim_Anger[2] | Rep_Df$Score_Anger[3] < Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange3a_Anger<- paste(Rep_Df$Change_Anger[3], "**")
      } else if(Rep_Df$Score_Anger[3] < Rep_Df$CI_Upper_Lim_Anger[2] & Rep_Df$Score_Anger[3] > Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange3a_Anger<- paste(Rep_Df$Change_Anger[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Anger<- data.frame(Time2, SigChange3a_Anger)
      names(Change_Rep_Df3a_Anger)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anger[2] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[2] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2], "**")
      } else if(Rep_Df$Score_Anger[2] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[2] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2])
      }
      
      if(Rep_Df$Score_Anger[3] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[3] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange3_Anger<- paste((Rep_Df$Score_Anger[3] - Rep_Df$Score_Anger[1]), "**")
      } else if(Rep_Df$Score_Anger[3] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[3] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange3_Anger<- paste((Rep_Df$Score_Anger[3] - Rep_Df$Score_Anger[1]))
      }
      
      if(Rep_Df$Score_Anger[4] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[4] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange4_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[1]), "**")
      } else if(Rep_Df$Score_Anger[4] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[4] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange4_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Anger<- data.frame(Time1, SigChange2_Anger, SigChange3_Anger, SigChange4_Anger)
      names(Change_Rep_Df4_Anger)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Anger)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Anger)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Anger[3] > Rep_Df$CI_Upper_Lim_Anger[2] | Rep_Df$Score_Anger[3] < Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange4a_Anger<- paste(Rep_Df$Change_Anger[3], "**")
      } else if(Rep_Df$Score_Anger[3] < Rep_Df$CI_Upper_Lim_Anger[2] & Rep_Df$Score_Anger[3] > Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange4a_Anger<- paste(Rep_Df$Change_Anger[3])
      }
      
      if(Rep_Df$Score_Anger[4] > Rep_Df$CI_Upper_Lim_Anger[2] | Rep_Df$Score_Anger[4] < Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange4b_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[2]), "**")
      } else if(Rep_Df$Score_Anger[4] < Rep_Df$CI_Upper_Lim_Anger[2] & Rep_Df$Score_Anger[4] > Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange4b_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Anger<- data.frame(Time2, SigChange4a_Anger, SigChange4b_Anger)
      names(Change_Rep_Df4a_Anger)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Anger)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Anger[4] > Rep_Df$CI_Upper_Lim_Anger[3] | Rep_Df$Score_Anger[4] < Rep_Df$CI_Lower_Lim_Anger[3]) {
        SigChange4c_Anger<- paste(Rep_Df$Change_Anger[4], "**")
      } else if(Rep_Df$Score_Anger[4] < Rep_Df$CI_Upper_Lim_Anger[3] & Rep_Df$Score_Anger[4] > Rep_Df$CI_Lower_Lim_Anger[3]) {
        SigChange4c_Anger<- paste(Rep_Df$Change_Anger[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Anger<- data.frame(Time3, SigChange4c_Anger)
      names(Change_Rep_Df4b_Anger)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Anger[2] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[2] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2], "**")
      } else if(Rep_Df$Score_Anger[2] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[2] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange2_Anger<- paste(Rep_Df$Change_Anger[2])
      }
      
      if(Rep_Df$Score_Anger[3] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[3] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange3_Anger<- paste((Rep_Df$Score_Anger[3] - Rep_Df$Score_Anger[1]), "**")
      } else if(Rep_Df$Score_Anger[3] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[3] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange3_Anger<- paste((Rep_Df$Score_Anger[3] - Rep_Df$Score_Anger[1]))
      }
      
      if(Rep_Df$Score_Anger[4] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[4] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange4_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[1]), "**")
      } else if(Rep_Df$Score_Anger[4] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[4] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange4_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[1]))
      }
      
      if(Rep_Df$Score_Anger[5] > Rep_Df$CI_Upper_Lim_Anger[1] | Rep_Df$Score_Anger[5] < Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange5_Anger<- paste((Rep_Df$Score_Anger[5] - Rep_Df$Score_Anger[1]), "**")
      } else if(Rep_Df$Score_Anger[5] < Rep_Df$CI_Upper_Lim_Anger[1] & Rep_Df$Score_Anger[5] > Rep_Df$CI_Lower_Lim_Anger[1]) {
        SigChange5_Anger<- paste((Rep_Df$Score_Anger[5] - Rep_Df$Score_Anger[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Anger<- data.frame(Time1, SigChange2_Anger, SigChange3_Anger, SigChange4_Anger, SigChange5_Anger)
      names(Change_Rep_Df5_Anger)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Anger)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Anger)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Anger)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Anger[3] > Rep_Df$CI_Upper_Lim_Anger[2] | Rep_Df$Score_Anger[3] < Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange5a_Anger<- paste(Rep_Df$Change_Anger[3], "**")
      } else if(Rep_Df$Score_Anger[3] < Rep_Df$CI_Upper_Lim_Anger[2] & Rep_Df$Score_Anger[3] > Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange5a_Anger<- paste(Rep_Df$Change_Anger[3])
      }
      
      if(Rep_Df$Score_Anger[4] > Rep_Df$CI_Upper_Lim_Anger[2] | Rep_Df$Score_Anger[4] < Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange5b_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[2]), "**")
      } else if(Rep_Df$Score_Anger[4] < Rep_Df$CI_Upper_Lim_Anger[2] & Rep_Df$Score_Anger[4] > Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange5b_Anger<- paste((Rep_Df$Score_Anger[4] - Rep_Df$Score_Anger[2]))
      }
      
      if(Rep_Df$Score_Anger[5] > Rep_Df$CI_Upper_Lim_Anger[2] | Rep_Df$Score_Anger[5] < Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange5c_Anger<- paste((Rep_Df$Score_Anger[5] - Rep_Df$Score_Anger[2]), "**")
      } else if(Rep_Df$Score_Anger[5] < Rep_Df$CI_Upper_Lim_Anger[2] & Rep_Df$Score_Anger[5] > Rep_Df$CI_Lower_Lim_Anger[2]) {
        SigChange5c_Anger<- paste((Rep_Df$Score_Anger[5] - Rep_Df$Score_Anger[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Anger<- data.frame(Time2, SigChange5a_Anger, SigChange5b_Anger, SigChange5c_Anger)
      names(Change_Rep_Df5a_Anger)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Anger)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Anger)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Anger[4] > Rep_Df$CI_Upper_Lim_Anger[3] | Rep_Df$Score_Anger[4] < Rep_Df$CI_Lower_Lim_Anger[3]) {
        SigChange5d_Anger<- paste(Rep_Df$Change_Anger[4], "**")
      } else if(Rep_Df$Score_Anger[4] < Rep_Df$CI_Upper_Lim_Anger[3] & Rep_Df$Score_Anger[4] > Rep_Df$CI_Lower_Lim_Anger[3]) {
        SigChange5d_Anger<- paste(Rep_Df$Change_Anger[4])
      }
      
      if(Rep_Df$Score_Anger[5] > Rep_Df$CI_Upper_Lim_Anger[3] | Rep_Df$Score_Anger[5] < Rep_Df$CI_Lower_Lim_Anger[3]) {
        SigChange5e_Anger<- paste((Rep_Df$Score_Anger[5] - Rep_Df$Score_Anger[3]), "**")
      } else if(Rep_Df$Score_Anger[5] < Rep_Df$CI_Upper_Lim_Anger[3] & Rep_Df$Score_Anger[5] > Rep_Df$CI_Lower_Lim_Anger[3]) {
        SigChange5e_Anger<- paste((Rep_Df$Score_Anger[5] - Rep_Df$Score_Anger[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Anger<- data.frame(Time3, SigChange5d_Anger, SigChange5e_Anger)
      names(Change_Rep_Df5b_Anger)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Anger)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Anger[5] > Rep_Df$CI_Upper_Lim_Anger[4] | Rep_Df$Score_Anger[5] < Rep_Df$CI_Lower_Lim_Anger[4]) {
        SigChange5f_Anger<- paste(Rep_Df$Change_Anger[5], "**")
      } else if(Rep_Df$Score_Anger[5] < Rep_Df$CI_Upper_Lim_Anger[4] & Rep_Df$Score_Anger[5] > Rep_Df$CI_Lower_Lim_Anger[4]) {
        SigChange5f_Anger<- paste(Rep_Df$Change_Anger[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Anger<- data.frame(Time4, SigChange5f_Anger)
      names(Change_Rep_Df5c_Anger)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Anger, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```


\newpage


#Quasi-Psychotic States Subscale

##Response Summary

```{r, echo = FALSE, warning = FALSE, comment=NA}

Scores_Table_Quasi_Psychotic<- Entered_Scores_Df[,c(1,83,84,85,86,87,88)]
names(Scores_Table_Quasi_Psychotic)<-  c("Date", "Score", "Change", "Predicted Score", "Standard Error", "CI Upper Limit", "CI Lower Limit")
kable(Scores_Table_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Data Employed in Reliable Change Analyses

```{r, echo = FALSE, warning = FALSE, comment=NA}

Stats_Table_Quasi_Psychotic<- kable(Stats_Table_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T) %>% row_spec(0, bold = T)

add_footnote(Stats_Table_Quasi_Psychotic, c(paste("Source of Reference Population Mean and Sd:", Tab_Reference), paste("Source of Test-Retest Reliability: Poreh, Rawlings & Claridge (2006)")), notation = "number")
```

##Trend

```{r, echo = FALSE, warning=FALSE, comment=FALSE, message=FALSE, fig.width=8}

 p10<- ggplot(Entered_Scores_Df, aes(x=factor(Entered_Scores_Df$Date, levels = Entered_Scores_Df$Date), y=Entered_Scores_Df$Score_Quasi_Psychotic, group = 1)) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_1[1], linetype = paste(Cutoff_Names$Cutoff_Name_Quasi_Psychotic_1[1],":",Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_1[1])), color = "#827717", 
size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_2[1], linetype = paste(Cutoff_Names$Cutoff_Name_Quasi_Psychotic_2[1],":",Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_2[1])), color = "#827717", size = 0.4) + geom_hline(aes(yintercept = Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_3[1], linetype = paste(Cutoff_Names$Cutoff_Name_Quasi_Psychotic_3[1],":",Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_3[1])), color = "#827717", size = 0.4) +
  scale_linetype_manual(guide = guide_legend(reverse = TRUE), name = "Cut-Off Scores", values = c("dotted", "longdash", "solid"), limits = c(paste(Cutoff_Names$Cutoff_Name_Quasi_Psychotic_1[1],":",Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_1[1]),                                  paste(Cutoff_Names$Cutoff_Name_Quasi_Psychotic_2[1],":",Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_2[1]),                                  paste(Cutoff_Names$Cutoff_Name_Quasi_Psychotic_3[1],":",Entered_Scores_Df$Cutoff_Score_Quasi_Psychotic_3[1]))) + geom_errorbar(aes(ymin=Entered_Scores_Df$CI_Lower_Lim_Quasi_Psychotic, ymax=Entered_Scores_Df$CI_Upper_Lim_Quasi_Psychotic), width=.2, size = 0.6, position=position_dodge(0.05), color = "#d35400") + geom_line(color = "#00004c", size = 1) + geom_point(shape=23, fill="#00004c", color="#00004c", size=1.5) + geom_label_repel(aes(label = paste0("Change =", Entered_Scores_Df$Change_Quasi_Psychotic)), y = -10, segment.color = 'transparent', size = 3, family = "AvantGarde") + geom_label_repel(aes(label = paste0(Entered_Scores_Df$Score_Quasi_Psychotic)), size = 3, family = "AvantGarde") 
  
p10<- p10+labs(x="Date", y = "Quasi-Psychotic States Score") +
theme_bw() + theme(panel.background = element_rect("#f1f1f1"), panel.grid.major = element_blank(), panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + scale_y_continuous(limits = c(-4, 11), breaks = c(0,1,2,3,4,5,6,7), labels = c('0 Min','1','2','3','4','5','6','7 Max')) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=12, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=12, family = "AvantGarde", face = "bold"), legend.title=element_text(size=10, family = "AvantGarde"), legend.text=element_text(size=9, family = "AvantGarde"), text=element_text(size=12, family="AvantGarde")) 
print(p10)
```



##Score Differences Between All Pairs of Timepoints 
#####Statistically reliable change is indicated by **

```{r, echo = FALSE, warning = FALSE, comment=NA}


if(length(Entered_Scores_Df$Date) == 2) {  
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2])
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df2_Quasi_Psychotic<- data.frame(Time1, SigChange2_Quasi_Psychotic)
      names(Change_Rep_Df2_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[2])  
  

kable(Change_Rep_Df2_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
  
} 
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2])
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange3_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[3] - Rep_Df$Score_Quasi_Psychotic[1]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange3_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[3] - Rep_Df$Score_Quasi_Psychotic[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df3_Quasi_Psychotic<- data.frame(Time1, SigChange2, SigChange3)
      names(Change_Rep_Df3_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df3_Quasi_Psychotic)[3]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 3) {

 if(Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] | Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange3a_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[3], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] & Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange3a_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[3])
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df3a_Quasi_Psychotic<- data.frame(Time2, SigChange3a_Quasi_Psychotic)
      names(Change_Rep_Df3a_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[3])  
  
  
kable(Change_Rep_Df3a_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)

}
  
```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2])
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange3_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[3] - Rep_Df$Score_Quasi_Psychotic[1]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange3_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[3] - Rep_Df$Score_Quasi_Psychotic[1]))
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange4_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[1]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange4_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[1]))
      }
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df4_Quasi_Psychotic<- data.frame(Time1, SigChange2_Quasi_Psychotic, SigChange3_Quasi_Psychotic, SigChange4_Quasi_Psychotic)
      names(Change_Rep_Df4_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df4_Quasi_Psychotic)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df4_Quasi_Psychotic)[4]<- paste0(Rep_Df$Date[4])
      
  
kable(Change_Rep_Df4_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
if(Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] | Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange4a_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[3], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] & Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange4a_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[3])
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] | Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange4b_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[2]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] & Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange4b_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[2]))
      }
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df4a_Quasi_Psychotic<- data.frame(Time2, SigChange4a_Quasi_Psychotic, SigChange4b_Quasi_Psychotic)
      names(Change_Rep_Df4a_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df4a_Quasi_Psychotic)[3]<- paste0(Rep_Df$Date[4])   
  
kable(Change_Rep_Df4a_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 4) {
  
    if(Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[3] | Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[3]) {
        SigChange4c_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[4], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[3] & Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[3]) {
        SigChange4c_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[4])
      }
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df4b_Quasi_Psychotic<- data.frame(Time3, SigChange4c_Quasi_Psychotic)
      names(Change_Rep_Df4b_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[4])    
  
  
kable(Change_Rep_Df4b_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
Rep_Df<- Entered_Scores_Df
      if(Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[2] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[2] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange2_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[2])
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange3_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[3] - Rep_Df$Score_Quasi_Psychotic[1]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange3_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[3] - Rep_Df$Score_Quasi_Psychotic[1]))
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange4_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[1]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange4_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[1]))
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] | Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange5_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[5] - Rep_Df$Score_Quasi_Psychotic[1]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[1] & Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[1]) {
        SigChange5_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[5] - Rep_Df$Score_Quasi_Psychotic[1]))
      }
      
      
      Time1<- paste0(Rep_Df$Date[1])
      Change_Rep_Df5_Quasi_Psychotic<- data.frame(Time1, SigChange2_Quasi_Psychotic, SigChange3_Quasi_Psychotic, SigChange4_Quasi_Psychotic, SigChange5_Quasi_Psychotic)
      names(Change_Rep_Df5_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[2])
      names(Change_Rep_Df5_Quasi_Psychotic)[3]<- paste0(Rep_Df$Date[3])
      names(Change_Rep_Df5_Quasi_Psychotic)[4]<- paste0(Rep_Df$Date[4])
      names(Change_Rep_Df5_Quasi_Psychotic)[5]<- paste0(Rep_Df$Date[5])  
  
  
kable(Change_Rep_Df5_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] | Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange5a_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[3], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[3] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] & Rep_Df$Score_Quasi_Psychotic[3] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange5a_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[3])
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] | Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange5b_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[2]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] & Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange5b_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[4] - Rep_Df$Score_Quasi_Psychotic[2]))
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] | Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange5c_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[5] - Rep_Df$Score_Quasi_Psychotic[2]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[2] & Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[2]) {
        SigChange5c_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[5] - Rep_Df$Score_Quasi_Psychotic[2]))
      }
      
      
      Time2<- paste0(Rep_Df$Date[2])
      Change_Rep_Df5a_Quasi_Psychotic<- data.frame(Time2, SigChange5a_Quasi_Psychotic, SigChange5b_Quasi_Psychotic, SigChange5c_Quasi_Psychotic)
      names(Change_Rep_Df5a_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[3])  
      names(Change_Rep_Df5a_Quasi_Psychotic)[3]<- paste0(Rep_Df$Date[4]) 
      names(Change_Rep_Df5a_Quasi_Psychotic)[4]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5a_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
if(Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[3] | Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[3]) {
        SigChange5d_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[4], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[4] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[3] & Rep_Df$Score_Quasi_Psychotic[4] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[3]) {
        SigChange5d_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[4])
      }
      
      if(Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[3] | Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[3]) {
        SigChange5e_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[5] - Rep_Df$Score_Quasi_Psychotic[3]), "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[3] & Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[3]) {
        SigChange5e_Quasi_Psychotic<- paste((Rep_Df$Score_Quasi_Psychotic[5] - Rep_Df$Score_Quasi_Psychotic[3]))
      }
      
      
      Time3<- paste0(Rep_Df$Date[3])
      Change_Rep_Df5b_Quasi_Psychotic<- data.frame(Time3, SigChange5d_Quasi_Psychotic, SigChange5e_Quasi_Psychotic)
      names(Change_Rep_Df5b_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[4])  
      names(Change_Rep_Df5b_Quasi_Psychotic)[3]<- paste0(Rep_Df$Date[5])    
  
kable(Change_Rep_Df5b_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

```{r, echo = FALSE, warning = FALSE,comment=NA}
if(length(Entered_Scores_Df$Date) == 5) {
  
 if(Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Upper_Lim_Quasi_Psychotic[4] | Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Lower_Lim_Quasi_Psychotic[4]) {
        SigChange5f_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[5], "**")
      } else if(Rep_Df$Score_Quasi_Psychotic[5] < Rep_Df$CI_Upper_Lim_Quasi_Psychotic[4] & Rep_Df$Score_Quasi_Psychotic[5] > Rep_Df$CI_Lower_Lim_Quasi_Psychotic[4]) {
        SigChange5f_Quasi_Psychotic<- paste(Rep_Df$Change_Quasi_Psychotic[5])
      }
      
      Time4<- paste0(Rep_Df$Date[4])
      Change_Rep_Df5c_Quasi_Psychotic<- data.frame(Time4, SigChange5f_Quasi_Psychotic)
      names(Change_Rep_Df5c_Quasi_Psychotic)[2]<- paste0(Rep_Df$Date[5])   
  
kable(Change_Rep_Df5c_Quasi_Psychotic, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F) %>% row_spec(0, bold = T) %>% column_spec(1, bold = T)
}

```

\newpage

#####Most Recent Item Scores

#####`r Scores_Table[nrow(Scores_Table),1]`

```{r,echo=FALSE,warning=FALSE,comment=NA}

kable(Item_Df, format = "latex", booktabs = T) %>% kable_styling(position = "left", full_width = T, font_size = 5, latex_options = "striped") %>% row_spec(0, bold = T)
```

\newpage

\begingroup\Large

\begin{center} \textbf{Information About the Borderline Personality Questionnaire (BPQ)} \end{center} 

#What it Measures: 

* The nine symptoms of Borderline Personality Disorder, as outlined in the Diagnostic and Statistical Manual of Mental Disorders, 4th Edition (DSM-IV).


* The nine criteria assessed include (subscale names appear in parentheses): Frantic efforts to avoid abandonment **(Abandonment)**, a pattern of unstable and intense relationships **(Relationships)**, an unstable sense of self **(Self-Image)**, impulsivity in at least 2 areas **(Impulsivity)**, suicidal and self-mutilation behaviour **(Suicide/Self-Mutilation)**, mood lability **(Affective Instability)**, chronic feelings of emptiness **(Emptiness)**, inappropriate anger **(Intense Anger)**, and transient paranoid ideation/dissociative symptoms **(Quasi-Psychotic States)**. 


#What Higher Scores Mean:

* More severe Borderline Personality Disorder symptomatology.


* Greater likelihood of meeting DSM-IV criteria for Borderline Personality Disorder. 


* Chanen and colleagues (2008) reported that the optimal cut-off score for Borderline Personality Disorder was a score greater than **56**. 


#Scale Quality:

* In a comparision of screeining measures for Borderline Personality Disorder in youth, the BPQ emerged as the strongest self-report instrument (Chanen, Jovev, Yuen & Rawlings, 2008). It displayed the best combination of characteristics, including the highest diagnostic accuracy, specificity, kappa, and test-retest reliability.


#Scale Structure:

* Contains 80 items spread across 9 subscales.


* True/false items (True = 1, False = 0).


* Respondents circle "yes" or "no" to indicate whether each item best describes their "usual self" over the past two years and longer (e.g. "I frequently get into physical fights").


* Items appear to load on a single factor (Poreh, Rawlings & Claridge, 2006), however futher factor analytic research is needed to clarify factor structure.

\endgroup