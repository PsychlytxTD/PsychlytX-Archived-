---
title: "Social Phobia Scale (SPS)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information About the Social Phobia Scale (SPS)} \end{center} 

#What it Measures: 

* Anxiety about being scrutinised by others.


* Performance concerns such as blushing, appearing panicky and behaving oddly.


* Subjetively-felt self-consciousness while in different situations (e.g. using public toilets or riding
in an elevator). 


* **Does not** assess avoidance behaviours.


#What Higher Scores Mean:

* Greater fear of scrutiny by others and self-consciousness in social situations.


* Greater anxiety about performance during observation by others (particularly concerns about experiencing unwanted changes in bodily appearance or behaviour). 


* Higher likelihood of meeting criteria for Social Anxiety Disorder. But note that the SPS is **not** a diagnostic instrument.


* Some authors have argued that the SPS should not be used to measure a subtype of social anxiety (i.e. public scrutiny concerns; Gomez & Watson, 2017). Rather, they argue that the SPS should be administered alongside the Social Interaction Anxiety Scale (SIAS), with the combined scores on both scales being used to assess the level of social anxiety in a general sense.


#Scale Quality:

* In a systematic review of social anxiety self-report measures, the SPS was one of two scales to receive the highest number of positive ratings (Modini, Abbot & Hunt, 2015). 


#Scale Structure:

* Contains 20 items.


* 5-Point Likert scale.


* Respondents rate to what extent (0 = "Not at all"; 4 = "Extremely") each item is characteristic of them (e.g. "I fear I may blush when I am with others").


* Items have been shown to load on a single factor (MÃ¶rtberg et al., 2017) and also on a general factor (when items are combined with those of the SIAS; Gomez & Watson, 2017).

\endgroup
\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #SPS nonsig calculations 
    
    SPS_Imp_Df<-dplyr::select(Imp_Df, starts_with("SPS.Fullscale"))

    
    SPS_Imp_Df<-as.data.frame(gather(SPS_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    
    #SPS sig calculations
    
    
    SPS_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, starts_with("SPS.Fullscale"))

    
    SPS_Sig_Imp_Df<-as.data.frame(gather(SPS_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
     if(nrow(SPS_Imp_Df) == 1 & nrow(SPS_Sig_Imp_Df) == 1) {
      SPS_Percentages<- rbind(SPS_Imp_Df, SPS_Sig_Imp_Df)
      SPS_Percentages<- cbind(Improvement_Type, SPS_Percentages)
    }  else if(nrow(SPS_Imp_Df) == 1 & nrow(SPS_Sig_Imp_Df) == 0) {
      SPS_Percentages = rbind(SPS_Imp_Df, Sig_Null)
       SPS_Percentages<- cbind(Improvement_Type, SPS_Percentages)
    } else if(nrow(SPS_Imp_Df) == 0) {
      SPS_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      SPS_Percentages<- cbind(Improvement_Type, SPS_Percentages)
    }

     names(SPS_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
     
    Scale_Names<- c("SPS Total")
    
    SPS_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(starts_with("SPS")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    SPS_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(starts_with("SPS")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    SPS_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(starts_with("SPS")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    SPS_Range<- c("Total Scale" = "0-60")

    
    SPS_Descriptives<- rbind(SPS_M_Intake, SPS_M_Discharge, SPS_M_Change, SPS_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    SPS_Descriptives<- cbind(Data, SPS_Descriptives)
  
```

##SPS

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(SPS_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
  
#SPS Graph
    
    SPS_Reformat<- dplyr::select(Scale_Report_Df, Name, SPS.Fullscale.First.Score, SPS.Fullscale.Last.Score)
    SPS_Reformat<- SPS_Reformat %>% rename(Pre = SPS.Fullscale.First.Score, Post = SPS.Fullscale.Last.Score)
    SPS_Reformat<- SPS_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    SPS_Reformat<- gather(SPS_Reformat, Group, SPS.Total.Score, Pre:Post)
    SPS_Reformat$Group<- factor(SPS_Reformat$Group, levels=unique(SPS_Reformat$Group))
    
    SPS_Plot<- ggplot(data = SPS_Reformat, aes (x = factor(Group), y = SPS.Total.Score, group = Name))
    SPS_Plot<- SPS_Plot + geom_line() + xlab("Time") + ylab("SPS Total") 
    
    SPS_Plot + scale_y_continuous(limits = c(0, 60), breaks = c(0,10,20,30,40,50,60)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```


##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(SPS_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) %>% column_spec(1, width = "6cm")

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete SPS data were used.")
}


```