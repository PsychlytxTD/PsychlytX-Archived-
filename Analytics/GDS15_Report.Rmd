---
title: "Geriatric Depression Scale - 15 (GDS-15)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---


\begingroup\Large

\begin{center} \textbf{Information About the Geriatric Depression Scale - 15 (GDS-15)} \end{center} 

#What it Measures: 

* Severity of depression over the past week.

* The GDS-15 is **not a diagnostic instrument** and **does not assess risk of suicide**. 


#What Higher Scores Mean:

* More severe depression.

* Research has indicated that scores of **5 or 6 indicate the presence of depression** (Mitchell Bird, Rizzo & Meader, 2010; Pocklington, Gilbody, Manea & McMillan, 2016; Sheik & Yesavage, 1986). 


#Scale Quality:

* The GDS-15 has received extensive support as the pre-eminent tool for screening depression among older individuals (for a systematic review and meta-analysis, see Pocklington, Gilbody, Manea & McMillan, 2016; Mitchell Bird, Rizzo & Meader, 2010). 

#Scale Structure:

* 15 items. 

* Yes-No format.

* Respondents are asked to indicate the best answer for them over the past week (e.g. "Are you basically satisfed with your life?"), by answering "YES" or "NO". Depending on the item, a score of 1 or 0 is registered. Item scores are then summed to yield a total score.  

* Studies examining the factor structure of the GDS-15 have yielded conflicting results, when treating data as continuous. However, a unidimensional factor structure has been  supported when treating data as categorical, in accordance with the yes-no format of the scale (Launeanu & Hubley, 2012). 

\endgroup
\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #GDS-15 nonsig calculations 
    
    GDS15_Imp_Df<-dplyr::select(Imp_Df, contains("GDS15.Fullscale"))

    
    GDS15_Imp_Df<-as.data.frame(gather(GDS15_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    
    #GDS-15 sig calculations
    
    
    GDS15_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("GDS15.Fullscale"))

    
    GDS15_Sig_Imp_Df<-as.data.frame(gather(GDS15_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
     if(nrow(GDS15_Imp_Df) == 1 & nrow(GDS15_Sig_Imp_Df) == 1) {
      GDS15_Percentages<- rbind(GDS15_Imp_Df, GDS15_Sig_Imp_Df)
      GDS15_Percentages<- cbind(Improvement_Type, GDS15_Percentages)
    }  else if(nrow(GDS15_Imp_Df) == 1 & nrow(GDS15_Sig_Imp_Df) == 0) {
      GDS15_Percentages = rbind(GDS15_Imp_Df, Sig_Null)
       GDS15_Percentages<- cbind(Improvement_Type, GDS15_Percentages)
    } else if(nrow(GDS15_Imp_Df) == 0) {
      GDS15_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      GDS15_Percentages<- cbind(Improvement_Type, GDS15_Percentages)
    }

     names(GDS15_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
     
    Scale_Names<- c("GDS-15 Total")
    
    GDS15_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("GDS15")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    GDS15_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("GDS15")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    GDS15_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("GDS15")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    GDS15_Range<- c("Total Scale" = "0-30")

    
    GDS15_Descriptives<- rbind(GDS15_M_Intake, GDS15_M_Discharge, GDS15_M_Change, GDS15_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    GDS15_Descriptives<- cbind(Data, GDS15_Descriptives)
  
```

##GDS-15

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(GDS15_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
  
#GDS-15 Graph
    
    GDS15_Reformat<- dplyr::select(Scale_Report_Df, Name, GDS15.Fullscale.First.Score, GDS15.Fullscale.Last.Score)
    GDS15_Reformat<- GDS15_Reformat %>% rename(Pre = GDS15.Fullscale.First.Score, Post = GDS15.Fullscale.Last.Score)
    GDS15_Reformat<- GDS15_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    GDS15_Reformat<- gather(GDS15_Reformat, Group, GDS15.Total.Score, Pre:Post)
    GDS15_Reformat$Group<- factor(GDS15_Reformat$Group, levels=unique(GDS15_Reformat$Group))
    
    GDS15_Plot<- ggplot(data = GDS15_Reformat, aes (x = factor(Group), y = GDS15.Total.Score, group = Name))
    GDS15_Plot<- GDS15_Plot + geom_line() + xlab("Time") + ylab("GDS-15 Total") 
    
    GDS15_Plot + scale_y_continuous(limits = c(0, 15), breaks = c(0,5,10,15)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```


##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(GDS15_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) %>% column_spec(1, width = "6cm")

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete GDS-15 data were used.")
}


```