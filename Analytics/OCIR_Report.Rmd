---
title: "Obsessive Compulsive Inventory - Revised (OCI-R)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information About the Obsessive Compulsive Inventory - Revised (OCI-R)} \end{center} 

#What it Measures: 

* Emotional, cognitive and behavioural symptoms of Obsessive Compulsive Disorder (OCD). The seven symptom-categories of the scale are described below (subscale names appear bold in parentheses).

* Concerns about contamination and self-cleaning compulsions **(Washing)**. 

* Compulsions involving checking, such as verifying that electical devices have been turned off **(Checking)**,

* Distress about objects being inproperly arranged **(Ordering)**.

* Difficulty with intrusive, negative thoughts **(Obsessing)**. 

* Hoarding behaviours **(Hoarding)**. 

* Attaching significance to certain numbers or feeling compelled to use numeric repetition/counting to alleviate fears/anxiety during activities **(Neutralizing)**. 


#What Higher Scores Mean:

* More severe OCD symptomatology. 

* An elevated total score may occur because the patient has scored highly within a single symptom-category (e.g. washing). Thus, a higher total score **does not** necessarily indicate the presence of OCD symptoms across multiple symptom-categories. 

* An elevated total score **does not** necessarily imply high levels of functional impairment. 

* The scale's developers have recommended a cut-off score of **21** to indicate the likely presence of Obsessive Compulsive Disorder. 

* A cut-off score of **7** on the Hoarding subscale has been advocated to indicate the likely presence of Hoarding Disorder (Wooton et al., 2015). 


#Scale Quality:

* Reviews comparing self-report measures for OCD have strongly endorsed the use of the OCI-R as a screening and treatment-monitoring instrument (see Rapp, Bergman, Piacentini & McGuire, 2016; Storch, Benito & Goodman, 2011). 

* The OCI-R has performed well in several psychometric validation studies (Huppert et al., 2007; Wooton et al., 2015). 

#Scale Structure:

* Contains 18 items spread across 7 subscales.

* 5-point Likert scale.

* Respondents rate how much they have been bothered or distressed by each symptom during the past month (0 = "Not at all"; 4 = "Extremely"). 

* Psychometric evaluations have suggested that the OCI-R displays a 6-factor structure, corresponding to the 6 subscales listed above (Foa et al., 2002; Huppert et al., 2007). 

\endgroup

\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #OCIR nonsig calculations 
    
    OCIR_Imp_Df<-dplyr::select(Imp_Df, contains("OCIR.Fullscale"))
    Washing_Imp_Df<-dplyr::select(Imp_Df, contains("OCIR.Washing"))
    Checking_Imp_Df<- dplyr::select(Imp_Df, contains("OCIR.Checking"))
    Ordering_Imp_Df<-dplyr::select(Imp_Df, contains("OCIR.Ordering"))
    Obsessing_Imp_Df<-dplyr::select(Imp_Df, contains("OCIR.Obsessing"))
    Hoarding_Imp_Df<- dplyr::select(Imp_Df, contains("OCIR.Hoarding"))
    Neutralizing_Imp_Df<-dplyr::select(Imp_Df, contains("OCIR.Neutralizing"))


    
    OCIR_Imp_Df<-as.data.frame(gather(OCIR_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Washing_Imp_Df<-as.data.frame(gather(Washing_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Checking_Imp_Df<-as.data.frame(gather(Checking_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Ordering_Imp_Df<-as.data.frame(gather(Ordering_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Obsessing_Imp_Df<-as.data.frame(gather(Obsessing_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Hoarding_Imp_Df<-as.data.frame(gather(Hoarding_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Neutralizing_Imp_Df<-as.data.frame(gather(Neutralizing_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))


    
    #OCIR sig calculations
    
    
    OCIR_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("OCIR.Fullscale"))
    Washing_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("OCIR.Washing"))
    Checking_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("OCIR.Checking"))
    Ordering_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("OCIR.Ordering"))
    Obsessing_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("OCIR.Obsessing"))
    Hoarding_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("OCIR.Hoarding"))
    Neutralizing_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("OCIR.Neutralizing"))

    
      OCIR_Sig_Imp_Df<-as.data.frame(gather(OCIR_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Washing_Sig_Imp_Df<-as.data.frame(gather(Washing_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Checking_Sig_Imp_Df<-as.data.frame(gather(Checking_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Ordering_Sig_Imp_Df<-as.data.frame(gather(Ordering_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Obsessing_Sig_Imp_Df<-as.data.frame(gather(Obsessing_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Hoarding_Sig_Imp_Df<-as.data.frame(gather(Hoarding_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Neutralizing_Sig_Imp_Df<-as.data.frame(gather(Neutralizing_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
    if(nrow(OCIR_Imp_Df) == 1 & nrow(OCIR_Sig_Imp_Df) == 1) {
      OCIR_Percentages<- rbind(OCIR_Imp_Df, OCIR_Sig_Imp_Df)
      OCIR_Percentages<- cbind(Improvement_Type, OCIR_Percentages)
    }  else if(nrow(OCIR_Imp_Df) == 1 & nrow(OCIR_Sig_Imp_Df) == 0) {
      OCIR_Percentages = rbind(OCIR_Imp_Df, Sig_Null)
       OCIR_Percentages<- cbind(Improvement_Type, OCIR_Percentages)
    } else if(nrow(OCIR_Imp_Df) == 0) {
      OCIR_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      OCIR_Percentages<- cbind(Improvement_Type, OCIR_Percentages)
    }

     names(OCIR_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


       
       if(nrow(Washing_Imp_Df) == 1 & nrow(Washing_Sig_Imp_Df) == 1) {
      Washing_Percentages<- rbind(Washing_Imp_Df, Washing_Sig_Imp_Df)
      Washing_Percentages<- cbind(Improvement_Type, Washing_Percentages)
    }  else if(nrow(Washing_Imp_Df) == 1 & nrow(Washing_Sig_Imp_Df) == 0) {
      Washing_Percentages = rbind(Washing_Imp_Df, Sig_Null)
       Washing_Percentages<- cbind(Improvement_Type, Washing_Percentages)
    } else if(nrow(Washing_Imp_Df) == 0) {
      Washing_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Washing_Percentages<- cbind(Improvement_Type, Washing_Percentages)
    }

     names(Washing_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
       if(nrow(Checking_Imp_Df) == 1 & nrow(Checking_Sig_Imp_Df) == 1) {
      Checking_Percentages<- rbind(Checking_Imp_Df, Checking_Sig_Imp_Df)
      Checking_Percentages<- cbind(Improvement_Type, Checking_Percentages)
    }  else if(nrow(Checking_Imp_Df) == 1 & nrow(Checking_Sig_Imp_Df) == 0) {
      Checking_Percentages = rbind(Checking_Imp_Df, Sig_Null)
       Checking_Percentages<- cbind(Improvement_Type, Checking_Percentages)
    } else if(nrow(Checking_Imp_Df) == 0) {
      Checking_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Checking_Percentages<- cbind(Improvement_Type, Checking_Percentages)
    }

     names(Checking_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
      if(nrow(Ordering_Imp_Df) == 1 & nrow(Ordering_Sig_Imp_Df) == 1) {
      Ordering_Percentages<- rbind(Ordering_Imp_Df, Ordering_Sig_Imp_Df)
      Ordering_Percentages<- cbind(Improvement_Type, Ordering_Percentages)
    }  else if(nrow(Ordering_Imp_Df) == 1 & nrow(Ordering_Sig_Imp_Df) == 0) {
      Ordering_Percentages = rbind(Ordering_Imp_Df, Sig_Null)
       Ordering_Percentages<- cbind(Improvement_Type, Ordering_Percentages)
    } else if(nrow(Ordering_Imp_Df) == 0) {
      Ordering_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Ordering_Percentages<- cbind(Improvement_Type, Ordering_Percentages)
    }

     names(Ordering_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    
  
    
      if(nrow(Obsessing_Imp_Df) == 1 & nrow(Obsessing_Sig_Imp_Df) == 1) {
      Obsessing_Percentages<- rbind(Obsessing_Imp_Df, Obsessing_Sig_Imp_Df)
      Obsessing_Percentages<- cbind(Improvement_Type, Obsessing_Percentages)
    }  else if(nrow(Obsessing_Imp_Df) == 1 & nrow(Obsessing_Sig_Imp_Df) == 0) {
      Obsessing_Percentages = rbind(Obsessing_Imp_Df, Sig_Null)
       Obsessing_Percentages<- cbind(Improvement_Type, Obsessing_Percentages)
    } else if(nrow(Obsessing_Imp_Df) == 0) {
      Obsessing_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Obsessing_Percentages<- cbind(Improvement_Type, Obsessing_Percentages)
    }

     names(Obsessing_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
     if(nrow(Hoarding_Imp_Df) == 1 & nrow(Hoarding_Sig_Imp_Df) == 1) {
      Hoarding_Percentages<- rbind(Hoarding_Imp_Df, Hoarding_Sig_Imp_Df)
      Hoarding_Percentages<- cbind(Improvement_Type, Hoarding_Percentages)
    }  else if(nrow(Hoarding_Imp_Df) == 1 & nrow(Hoarding_Sig_Imp_Df) == 0) {
      Hoarding_Percentages = rbind(Hoarding_Imp_Df, Sig_Null)
       Hoarding_Percentages<- cbind(Improvement_Type, Hoarding_Percentages)
    } else if(nrow(Hoarding_Imp_Df) == 0) {
      Hoarding_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Hoarding_Percentages<- cbind(Improvement_Type, Hoarding_Percentages)
    }

     names(Hoarding_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


     
     if(nrow(Neutralizing_Imp_Df) == 1 & nrow(Neutralizing_Sig_Imp_Df) == 1) {
      Neutralizing_Percentages<- rbind(Neutralizing_Imp_Df, Neutralizing_Sig_Imp_Df)
      Neutralizing_Percentages<- cbind(Improvement_Type, Neutralizing_Percentages)
    }  else if(nrow(Neutralizing_Imp_Df) == 1 & nrow(Neutralizing_Sig_Imp_Df) == 0) {
      Neutralizing_Percentages = rbind(Neutralizing_Imp_Df, Sig_Null)
       Neutralizing_Percentages<- cbind(Improvement_Type, Neutralizing_Percentages)
    } else if(nrow(Neutralizing_Imp_Df) == 0) {
      Neutralizing_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Neutralizing_Percentages<- cbind(Improvement_Type, Neutralizing_Percentages)
    }

     names(Neutralizing_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
   

      Scale_Names<- c("OCI-R Total", "Washing", "Checking", "Ordering", "Obsessing", "Hoarding", "Neutralizing")
    
    OCIR_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("OCIR")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    OCIR_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("OCIR")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    OCIR_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("OCIR")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    OCIR_Range<- c("Total Scale" = "0-72","Washing" = "0-9",  "Affective Instability" = "0-10",  "Ordering" = "0-10", "Obsessing" = "0-8", "Self-Image" = "0-9", "Suicide Self-Mutilation" = "0-7")

    
    OCIR_Descriptives<- rbind(OCIR_M_Intake, OCIR_M_Discharge, OCIR_M_Change, OCIR_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    OCIR_Descriptives<- cbind(Data, OCIR_Descriptives) 
  
```

##OCI-R Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(OCIR_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}

    OCIR_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Fullscale.First.Score, OCIR.Fullscale.Last.Score)
    OCIR_Reformat<- OCIR_Reformat %>% rename(Pre = OCIR.Fullscale.First.Score, Post = OCIR.Fullscale.Last.Score)
    OCIR_Reformat<- OCIR_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Reformat<- gather(OCIR_Reformat, Group, OCIR.Total.Score, Pre:Post)
    OCIR_Reformat$Group<- factor(OCIR_Reformat$Group, levels=unique(OCIR_Reformat$Group))
    
    OCIR_Plot<- ggplot(data = OCIR_Reformat, aes (x = factor(Group), y = OCIR.Total.Score, group = Name))
    OCIR_Plot<- OCIR_Plot + geom_line() + xlab("Time") + ylab("OCI-R Total") 
    
    OCIR_Plot + scale_y_continuous(limits = c(0, 72), breaks = c(0,24,48,72)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Washing Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Washing_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
OCIR_Washing_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Washing.First.Score, OCIR.Washing.Last.Score)
    OCIR_Washing_Reformat<- OCIR_Washing_Reformat %>% rename(Pre = OCIR.Washing.First.Score, Post = OCIR.Washing.Last.Score)
    OCIR_Washing_Reformat<- OCIR_Washing_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Washing_Reformat<- gather(OCIR_Washing_Reformat, Group, OCIR.Washing.Score, Pre:Post)
    OCIR_Washing_Reformat$Group<- factor(OCIR_Washing_Reformat$Group, levels=unique(OCIR_Washing_Reformat$Group))
    
    OCIR_Washing_Plot<- ggplot(data = OCIR_Washing_Reformat, aes(x = factor(Group), y = OCIR.Washing.Score, group = Name))
    OCIR_Washing_Plot<- OCIR_Washing_Plot + geom_line() + xlab("Time") + ylab("Washing") 
    
    OCIR_Washing_Plot + scale_y_continuous(limits = c(0, 12), breaks = c(0,4,8,12)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Checking Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Checking_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
OCIR_Checking_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Checking.First.Score, OCIR.Checking.Last.Score)
    OCIR_Checking_Reformat<- OCIR_Checking_Reformat %>% rename(Pre = OCIR.Checking.First.Score, Post = OCIR.Checking.Last.Score)
    OCIR_Checking_Reformat<- OCIR_Checking_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Checking_Reformat<- gather(OCIR_Checking_Reformat, Group, OCIR.Checking.Score, Pre:Post)
    OCIR_Checking_Reformat$Group<- factor(OCIR_Checking_Reformat$Group, levels=unique(OCIR_Checking_Reformat$Group))
    
    OCIR_Checking_Plot<- ggplot(data = OCIR_Checking_Reformat, aes (x = factor(Group), y = OCIR.Checking.Score, group = Name))
    OCIR_Checking_Plot<- OCIR_Checking_Plot + geom_line() + xlab("Time") + ylab("Checking") 
    
    OCIR_Checking_Plot + scale_y_continuous(limits = c(0, 12), breaks = c(0,4,8,12)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

\newpage

##Ordering Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Ordering_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
OCIR_Ordering_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Ordering.First.Score, OCIR.Ordering.Last.Score)
    OCIR_Ordering_Reformat<- OCIR_Ordering_Reformat %>% rename(Pre = OCIR.Ordering.First.Score, Post = OCIR.Ordering.Last.Score)
    OCIR_Ordering_Reformat<- OCIR_Ordering_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Ordering_Reformat<- gather(OCIR_Ordering_Reformat, Group, OCIR.Ordering.Score, Pre:Post)
    OCIR_Ordering_Reformat$Group<- factor(OCIR_Ordering_Reformat$Group, levels=unique(OCIR_Ordering_Reformat$Group))
    
    OCIR_Ordering_Plot<- ggplot(data = OCIR_Ordering_Reformat, aes(x = factor(Group), y = OCIR.Ordering.Score, group = Name))
    OCIR_Ordering_Plot<- OCIR_Ordering_Plot + geom_line() + xlab("Time") + ylab("Ordering") 
    
    OCIR_Ordering_Plot + scale_y_continuous(limits = c(0, 12), breaks = c(0,4,8,12)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Obsessing Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Obsessing_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
OCIR_Obsessing_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Obsessing.First.Score, OCIR.Obsessing.Last.Score)
    OCIR_Obsessing_Reformat<- OCIR_Obsessing_Reformat %>% rename(Pre = OCIR.Obsessing.First.Score, Post = OCIR.Obsessing.Last.Score)
    OCIR_Obsessing_Reformat<- OCIR_Obsessing_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Obsessing_Reformat<- gather(OCIR_Obsessing_Reformat, Group, OCIR.Obsessing.Score, Pre:Post)
    OCIR_Obsessing_Reformat$Group<- factor(OCIR_Obsessing_Reformat$Group, levels=unique(OCIR_Obsessing_Reformat$Group))
    
    OCIR_Obsessing_Plot<- ggplot(data = OCIR_Obsessing_Reformat, aes(x = factor(Group), y = OCIR.Obsessing.Score, group = Name))
    OCIR_Obsessing_Plot<- OCIR_Obsessing_Plot + geom_line() + xlab("Time") + ylab("Obsessing") 
    
    OCIR_Obsessing_Plot + scale_y_continuous(limits = c(0, 12), breaks = c(0,4,8,12)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Hoarding Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Hoarding_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
OCIR_Hoarding_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Hoarding.First.Score, OCIR.Hoarding.Last.Score)
    OCIR_Hoarding_Reformat<- OCIR_Hoarding_Reformat %>% rename(Pre = OCIR.Hoarding.First.Score, Post = OCIR.Hoarding.Last.Score)
    OCIR_Hoarding_Reformat<- OCIR_Hoarding_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Hoarding_Reformat<- gather(OCIR_Hoarding_Reformat, Group, OCIR.Hoarding.Score, Pre:Post)
    OCIR_Hoarding_Reformat$Group<- factor(OCIR_Hoarding_Reformat$Group, levels=unique(OCIR_Hoarding_Reformat$Group))
    
    OCIR_Hoarding_Plot<- ggplot(data = OCIR_Hoarding_Reformat, aes(x = factor(Group), y = OCIR.Hoarding.Score, group = Name))
    OCIR_Hoarding_Plot<- OCIR_Hoarding_Plot + geom_line() + xlab("Time") + ylab("Hoarding") 
    
    OCIR_Hoarding_Plot + scale_y_continuous(limits = c(0, 12), breaks = c(0,4,8,12)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

\newpage

##Neutralizing Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Neutralizing_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
OCIR_Neutralizing_Reformat<- dplyr::select(Scale_Report_Df, Name, OCIR.Neutralizing.First.Score, OCIR.Neutralizing.Last.Score)
    OCIR_Neutralizing_Reformat<- OCIR_Neutralizing_Reformat %>% rename(Pre = OCIR.Neutralizing.First.Score, Post = OCIR.Neutralizing.Last.Score)
    OCIR_Neutralizing_Reformat<- OCIR_Neutralizing_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    OCIR_Neutralizing_Reformat<- gather(OCIR_Neutralizing_Reformat, Group, OCIR.Neutralizing.Score, Pre:Post)
    OCIR_Neutralizing_Reformat$Group<- factor(OCIR_Neutralizing_Reformat$Group, levels=unique(OCIR_Neutralizing_Reformat$Group))
    
    OCIR_Neutralizing_Plot<- ggplot(data = OCIR_Neutralizing_Reformat, aes(x = factor(Group), y = OCIR.Neutralizing.Score, group = Name))
    OCIR_Neutralizing_Plot<- OCIR_Neutralizing_Plot + geom_line() + xlab("Time") + ylab("Neutralizing") 
    
    OCIR_Neutralizing_Plot + scale_y_continuous(limits = c(0, 12), breaks = c(0,4,8,12)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Average Change Over Treatment Period

####See last page.

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}


cat('\n#', "Reporting Period", '\n')
cat('\n')

if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete OCI-R data were used.")
}


OCIR_Descriptives_Tab<- kable(OCIR_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F, latex_options = "striped") %>% row_spec(0, bold = T) %>% kable_styling(latex_options="scale_down")

landscape(OCIR_Descriptives_Tab)

```
