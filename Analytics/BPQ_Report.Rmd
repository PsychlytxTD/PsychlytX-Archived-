---
title: "Borderline Personality Questionnaire (BPQ)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information About the Borderline Personality Questionnaire (BPQ)} \end{center} 

#What it Measures: 

* The nine symptoms of Borderline Personality Disorder, as outlined in the Diagnostic and Statistical Manual of Mental Disorders, 4th Edition (DSM-IV).


* The nine criteria assessed include (subscale names appear in parentheses): Frantic efforts to avoid abandonment **(Abandonment)**, a pattern of unstable and intense relationships **(Relationships)**, an unstable sense of self **(Self-Image)**, impulsivity in at least 2 areas **(Impulsivity)**, suicidal and self-mutilation behaviour **(Suicide/Self-Mutilation)**, mood lability **(Affective Instability)**, chronic feelings of emptiness **(Emptiness)**, inappropriate anger **(Intense Anger)**, and transient paranoid ideation/dissociative symptoms **(Quasi-Psychotic States)**. 


#What Higher Scores Mean:

* More severe Borderline Personality Disorder symptomatology.


* Greater likelihood of meeting DSM-IV criteria for Borderline Personality Disorder. 


* Chanen and colleagues (2008) reported that the optimal cut-off score for Borderline Personality Disorder was a score greater than **56**. 


#Scale Quality:

* In a comparision of screeining measures for Borderline Personality Disorder in youth, the BPQ emerged as the strongest self-report instrument (Chanen, Jovev, Yuen & Rawlings, 2008). It displayed the best combination of characteristics, including the highest diagnostic accuracy, specificity, kappa, and test-retest reliability.


#Scale Structure:

* Contains 80 items spread across 9 subscales.


* True/false items (True = 1, False = 0).


* Respondents circle "yes" or "no" to indicate whether each item best describes their "usual self" over the past two years and longer (e.g. "I frequently get into physical fights").


* Items appear to load on a single factor (Poreh, Rawlings & Claridge, 2006), however futher factor analytic research is needed to clarify factor structure.

\endgroup

\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #BPQ nonsig calculations 
    
    BPQ_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Fullscale"))
    Impulsivity_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Impulsivity"))
    Affective_Instability_Imp_Df<- dplyr::select(Imp_Df, contains("BPQ.Affective.Instability"))
    Abandonment_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Abandonment"))
    Relationships_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Relationships"))
    Self_Image_Imp_Df<- dplyr::select(Imp_Df, contains("BPQ.Self.Image"))
    Suicide_Mutilation_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Suicide.Mutilation"))
    Emptiness_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Emptiness"))
    Anger_Imp_Df<- dplyr::select(Imp_Df, contains("Anger"))
    Quasi_Psychotic_Imp_Df<-dplyr::select(Imp_Df, contains("BPQ.Quasi.Psychotic"))
    
    
    
    
    BPQ_Imp_Df<-as.data.frame(gather(BPQ_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Impulsivity_Imp_Df<-as.data.frame(gather(Impulsivity_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Affective_Instability_Imp_Df<-as.data.frame(gather(Affective_Instability_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Abandonment_Imp_Df<-as.data.frame(gather(Abandonment_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Relationships_Imp_Df<-as.data.frame(gather(Relationships_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Self_Image_Imp_Df<-as.data.frame(gather(Self_Image_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Suicide_Mutilation_Imp_Df<-as.data.frame(gather(Suicide_Mutilation_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Emptiness_Imp_Df<-as.data.frame(gather(Emptiness_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Anger_Imp_Df<-as.data.frame(gather(Anger_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Quasi_Psychotic_Imp_Df<-as.data.frame(gather(Quasi_Psychotic_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    #BPQ sig calculations
    
    
    BPQ_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Fullscale"))
    Impulsivity_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Impulsivity"))
    Affective_Instability_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("BPQ.Affective.Instability"))
    Abandonment_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Abandonment"))
    Relationships_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Relationships"))
    Self_Image_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("BPQ.Self.Image"))
    Suicide_Mutilation_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Suicide.Mutilation"))
    Emptiness_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Emptiness"))
    Anger_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("BPQ.Anger"))
    Quasi_Psychotic_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("BPQ.Quasi.Psychotic"))

    
    
      BPQ_Sig_Imp_Df<-as.data.frame(gather(BPQ_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Impulsivity_Sig_Imp_Df<-as.data.frame(gather(Impulsivity_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Affective_Instability_Sig_Imp_Df<-as.data.frame(gather(Affective_Instability_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Abandonment_Sig_Imp_Df<-as.data.frame(gather(Abandonment_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Relationships_Sig_Imp_Df<-as.data.frame(gather(Relationships_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Self_Image_Sig_Imp_Df<-as.data.frame(gather(Self_Image_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Suicide_Mutilation_Sig_Imp_Df<-as.data.frame(gather(Suicide_Mutilation_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Emptiness_Sig_Imp_Df<-as.data.frame(gather(Emptiness_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Anger_Sig_Imp_Df<-as.data.frame(gather(Anger_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Quasi_Psychotic_Sig_Imp_Df<-as.data.frame(gather(Quasi_Psychotic_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
    if(nrow(BPQ_Imp_Df) == 1 & nrow(BPQ_Sig_Imp_Df) == 1) {
      BPQ_Percentages<- rbind(BPQ_Imp_Df, BPQ_Sig_Imp_Df)
      BPQ_Percentages<- cbind(Improvement_Type, BPQ_Percentages)
    }  else if(nrow(BPQ_Imp_Df) == 1 & nrow(BPQ_Sig_Imp_Df) == 0) {
      BPQ_Percentages = rbind(BPQ_Imp_Df, Sig_Null)
       BPQ_Percentages<- cbind(Improvement_Type, BPQ_Percentages)
    } else if(nrow(BPQ_Imp_Df) == 0) {
      BPQ_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      BPQ_Percentages<- cbind(Improvement_Type, BPQ_Percentages)
    }

     names(BPQ_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


       
       if(nrow(Impulsivity_Imp_Df) == 1 & nrow(Impulsivity_Sig_Imp_Df) == 1) {
      Impulsivity_Percentages<- rbind(Impulsivity_Imp_Df, Impulsivity_Sig_Imp_Df)
      Impulsivity_Percentages<- cbind(Improvement_Type, Impulsivity_Percentages)
    }  else if(nrow(Impulsivity_Imp_Df) == 1 & nrow(Impulsivity_Sig_Imp_Df) == 0) {
      Impulsivity_Percentages = rbind(Impulsivity_Imp_Df, Sig_Null)
       Impulsivity_Percentages<- cbind(Improvement_Type, Impulsivity_Percentages)
    } else if(nrow(Impulsivity_Imp_Df) == 0) {
      Impulsivity_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Impulsivity_Percentages<- cbind(Improvement_Type, Impulsivity_Percentages)
    }

     names(Impulsivity_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
       if(nrow(Affective_Instability_Imp_Df) == 1 & nrow(Affective_Instability_Sig_Imp_Df) == 1) {
      Affective_Instability_Percentages<- rbind(Affective_Instability_Imp_Df, Affective_Instability_Sig_Imp_Df)
      Affective_Instability_Percentages<- cbind(Improvement_Type, Affective_Instability_Percentages)
    }  else if(nrow(Affective_Instability_Imp_Df) == 1 & nrow(Affective_Instability_Sig_Imp_Df) == 0) {
      Affective_Instability_Percentages = rbind(Affective_Instability_Imp_Df, Sig_Null)
       Affective_Instability_Percentages<- cbind(Improvement_Type, Affective_Instability_Percentages)
    } else if(nrow(Affective_Instability_Imp_Df) == 0) {
      Affective_Instability_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Affective_Instability_Percentages<- cbind(Improvement_Type, Affective_Instability_Percentages)
    }

     names(Affective_Instability_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
      if(nrow(Abandonment_Imp_Df) == 1 & nrow(Abandonment_Sig_Imp_Df) == 1) {
      Abandonment_Percentages<- rbind(Abandonment_Imp_Df, Abandonment_Sig_Imp_Df)
      Abandonment_Percentages<- cbind(Improvement_Type, Abandonment_Percentages)
    }  else if(nrow(Abandonment_Imp_Df) == 1 & nrow(Abandonment_Sig_Imp_Df) == 0) {
      Abandonment_Percentages = rbind(Abandonment_Imp_Df, Sig_Null)
       Abandonment_Percentages<- cbind(Improvement_Type, Abandonment_Percentages)
    } else if(nrow(Abandonment_Imp_Df) == 0) {
      Abandonment_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Abandonment_Percentages<- cbind(Improvement_Type, Abandonment_Percentages)
    }

     names(Abandonment_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    
  
    
      if(nrow(Relationships_Imp_Df) == 1 & nrow(Relationships_Sig_Imp_Df) == 1) {
      Relationships_Percentages<- rbind(Relationships_Imp_Df, Relationships_Sig_Imp_Df)
      Relationships_Percentages<- cbind(Improvement_Type, Relationships_Percentages)
    }  else if(nrow(Relationships_Imp_Df) == 1 & nrow(Relationships_Sig_Imp_Df) == 0) {
      Relationships_Percentages = rbind(Relationships_Imp_Df, Sig_Null)
       Relationships_Percentages<- cbind(Improvement_Type, Relationships_Percentages)
    } else if(nrow(Relationships_Imp_Df) == 0) {
      Relationships_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Relationships_Percentages<- cbind(Improvement_Type, Relationships_Percentages)
    }

     names(Relationships_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
     if(nrow(Self_Image_Imp_Df) == 1 & nrow(Self_Image_Sig_Imp_Df) == 1) {
      Self_Image_Percentages<- rbind(Self_Image_Imp_Df, Self_Image_Sig_Imp_Df)
      Self_Image_Percentages<- cbind(Improvement_Type, Self_Image_Percentages)
    }  else if(nrow(Self_Image_Imp_Df) == 1 & nrow(Self_Image_Sig_Imp_Df) == 0) {
      Self_Image_Percentages = rbind(Self_Image_Imp_Df, Sig_Null)
       Self_Image_Percentages<- cbind(Improvement_Type, Self_Image_Percentages)
    } else if(nrow(Self_Image_Imp_Df) == 0) {
      Self_Image_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Self_Image_Percentages<- cbind(Improvement_Type, Self_Image_Percentages)
    }

     names(Self_Image_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


     
     if(nrow(Suicide_Mutilation_Imp_Df) == 1 & nrow(Suicide_Mutilation_Sig_Imp_Df) == 1) {
      Suicide_Mutilation_Percentages<- rbind(Suicide_Mutilation_Imp_Df, Suicide_Mutilation_Sig_Imp_Df)
      Suicide_Mutilation_Percentages<- cbind(Improvement_Type, Suicide_Mutilation_Percentages)
    }  else if(nrow(Suicide_Mutilation_Imp_Df) == 1 & nrow(Suicide_Mutilation_Sig_Imp_Df) == 0) {
      Suicide_Mutilation_Percentages = rbind(Suicide_Mutilation_Imp_Df, Sig_Null)
       Suicide_Mutilation_Percentages<- cbind(Improvement_Type, Suicide_Mutilation_Percentages)
    } else if(nrow(Suicide_Mutilation_Imp_Df) == 0) {
      Suicide_Mutilation_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Suicide_Mutilation_Percentages<- cbind(Improvement_Type, Suicide_Mutilation_Percentages)
    }

     names(Suicide_Mutilation_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
   
    
    
      if(nrow(Emptiness_Imp_Df) == 1 & nrow(Emptiness_Sig_Imp_Df) == 1) {
      Emptiness_Percentages<- rbind(Emptiness_Imp_Df, Emptiness_Sig_Imp_Df)
      Emptiness_Percentages<- cbind(Improvement_Type, Emptiness_Percentages)
    }  else if(nrow(Emptiness_Imp_Df) == 1 & nrow(Emptiness_Sig_Imp_Df) == 0) {
      Emptiness_Percentages = rbind(Emptiness_Imp_Df, Sig_Null)
       Emptiness_Percentages<- cbind(Improvement_Type, Emptiness_Percentages)
    } else if(nrow(Emptiness_Imp_Df) == 0) {
      Emptiness_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Emptiness_Percentages<- cbind(Improvement_Type, Emptiness_Percentages)
    }

     names(Emptiness_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


     
      if(nrow(Anger_Imp_Df) == 1 & nrow(Anger_Sig_Imp_Df) == 1) {
      Anger_Percentages<- rbind(Anger_Imp_Df, Anger_Sig_Imp_Df)
      Anger_Percentages<- cbind(Improvement_Type, Anger_Percentages)
    }  else if(nrow(Anger_Imp_Df) == 1 & nrow(Anger_Sig_Imp_Df) == 0) {
      Anger_Percentages = rbind(Anger_Imp_Df, Sig_Null)
       Anger_Percentages<- cbind(Improvement_Type, Anger_Percentages)
    } else if(nrow(Anger_Imp_Df) == 0) {
      Anger_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Anger_Percentages<- cbind(Improvement_Type, Anger_Percentages)
    }

     names(Anger_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
   
    if(nrow(Quasi_Psychotic_Imp_Df) == 1 & nrow(Quasi_Psychotic_Sig_Imp_Df) == 1) {
      Quasi_Psychotic_Percentages<- rbind(Quasi_Psychotic_Imp_Df, Quasi_Psychotic_Sig_Imp_Df)
      Quasi_Psychotic_Percentages<- cbind(Improvement_Type, Quasi_Psychotic_Percentages)
    }  else if(nrow(Quasi_Psychotic_Imp_Df) == 1 & nrow(Quasi_Psychotic_Sig_Imp_Df) == 0) {
      Quasi_Psychotic_Percentages = rbind(Quasi_Psychotic_Imp_Df, Sig_Null)
       Quasi_Psychotic_Percentages<- cbind(Improvement_Type, Quasi_Psychotic_Percentages)
    } else if(nrow(Quasi_Psychotic_Imp_Df) == 0) {
      Quasi_Psychotic_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Quasi_Psychotic_Percentages<- cbind(Improvement_Type, Quasi_Psychotic_Percentages)
    }

     names(Quasi_Psychotic_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    

      Scale_Names<- c("BPQ Total", "Impulsivity", "Affective Instability", "Abandonment", "Relationships", "Self-Image", "Suicide Self-Mutilation", "Emptiness", "Anger", "Quasi-Psychotic States")
    
    BPQ_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("BPQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    BPQ_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("BPQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    BPQ_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("BPQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    BPQ_Range<- c("Total Scale" = "0-80","Impulsivity" = "0-9",  "Affective Instability" = "0-10",  "Abandonment" = "0-10", "Relationships" = "0-8", "Self-Image" = "0-9", "Suicide Self-Mutilation" = "0-7", "Emptiness" = "0-10", "Anger" = "0-10", "Quasi-Psychotic States" = "0-7")

    
    BPQ_Descriptives<- rbind(BPQ_M_Intake, BPQ_M_Discharge, BPQ_M_Change, BPQ_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    BPQ_Descriptives<- cbind(Data, BPQ_Descriptives) 
  
```

##BPQ Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(BPQ_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}

    BPQ_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Fullscale.First.Score, BPQ.Fullscale.Last.Score)
    BPQ_Reformat<- BPQ_Reformat %>% rename(Pre = BPQ.Fullscale.First.Score, Post = BPQ.Fullscale.Last.Score)
    BPQ_Reformat<- BPQ_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Reformat<- gather(BPQ_Reformat, Group, BPQ.Total.Score, Pre:Post)
    BPQ_Reformat$Group<- factor(BPQ_Reformat$Group, levels=unique(BPQ_Reformat$Group))
    
    BPQ_Plot<- ggplot(data = BPQ_Reformat, aes (x = factor(Group), y = BPQ.Total.Score, group = Name))
    BPQ_Plot<- BPQ_Plot + geom_line() + xlab("Time") + ylab("BPQ Total") 
    
    BPQ_Plot + scale_y_continuous(limits = c(0, 80), breaks = c(0,20,40,60,80)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Impulsivity Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Impulsivity_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Impulsivity_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Impulsivity.First.Score, BPQ.Impulsivity.Last.Score)
    BPQ_Impulsivity_Reformat<- BPQ_Impulsivity_Reformat %>% rename(Pre = BPQ.Impulsivity.First.Score, Post = BPQ.Impulsivity.Last.Score)
    BPQ_Impulsivity_Reformat<- BPQ_Impulsivity_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Impulsivity_Reformat<- gather(BPQ_Impulsivity_Reformat, Group, BPQ.Impulsivity.Score, Pre:Post)
    BPQ_Impulsivity_Reformat$Group<- factor(BPQ_Impulsivity_Reformat$Group, levels=unique(BPQ_Impulsivity_Reformat$Group))
    
    BPQ_Impulsivity_Plot<- ggplot(data = BPQ_Impulsivity_Reformat, aes(x = factor(Group), y = BPQ.Impulsivity.Score, group = Name))
    BPQ_Impulsivity_Plot<- BPQ_Impulsivity_Plot + geom_line() + xlab("Time") + ylab("Impulsivity") 
    
    BPQ_Impulsivity_Plot + scale_y_continuous(limits = c(0, 9), breaks = c(0,3,6,9)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Affective Instability Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Affective_Instability_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Affective_Instability_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Affective.Instability.First.Score, BPQ.Affective.Instability.Last.Score)
    BPQ_Affective_Instability_Reformat<- BPQ_Affective_Instability_Reformat %>% rename(Pre = BPQ.Affective.Instability.First.Score, Post = BPQ.Affective.Instability.Last.Score)
    BPQ_Affective_Instability_Reformat<- BPQ_Affective_Instability_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Affective_Instability_Reformat<- gather(BPQ_Affective_Instability_Reformat, Group, BPQ.Affective.Instability.Score, Pre:Post)
    BPQ_Affective_Instability_Reformat$Group<- factor(BPQ_Affective_Instability_Reformat$Group, levels=unique(BPQ_Affective_Instability_Reformat$Group))
    
    BPQ_Affective_Instability_Plot<- ggplot(data = BPQ_Affective_Instability_Reformat, aes (x = factor(Group), y = BPQ.Affective.Instability.Score, group = Name))
    BPQ_Affective_Instability_Plot<- BPQ_Affective_Instability_Plot + geom_line() + xlab("Time") + ylab("Affective Instability") 
    
    BPQ_Affective_Instability_Plot + scale_y_continuous(limits = c(0, 10), breaks = c(0,2,4,6,8,10)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

\newpage

##Abandonment Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Abandonment_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Abandonment_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Abandonment.First.Score, BPQ.Abandonment.Last.Score)
    BPQ_Abandonment_Reformat<- BPQ_Abandonment_Reformat %>% rename(Pre = BPQ.Abandonment.First.Score, Post = BPQ.Abandonment.Last.Score)
    BPQ_Abandonment_Reformat<- BPQ_Abandonment_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Abandonment_Reformat<- gather(BPQ_Abandonment_Reformat, Group, BPQ.Abandonment.Score, Pre:Post)
    BPQ_Abandonment_Reformat$Group<- factor(BPQ_Abandonment_Reformat$Group, levels=unique(BPQ_Abandonment_Reformat$Group))
    
    BPQ_Abandonment_Plot<- ggplot(data = BPQ_Abandonment_Reformat, aes(x = factor(Group), y = BPQ.Abandonment.Score, group = Name))
    BPQ_Abandonment_Plot<- BPQ_Abandonment_Plot + geom_line() + xlab("Time") + ylab("Abandonment") 
    
    BPQ_Abandonment_Plot + scale_y_continuous(limits = c(0, 10), breaks = c(0,2,4,6,8,10)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Relationships Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Relationships_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Relationships_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Relationships.First.Score, BPQ.Relationships.Last.Score)
    BPQ_Relationships_Reformat<- BPQ_Relationships_Reformat %>% rename(Pre = BPQ.Relationships.First.Score, Post = BPQ.Relationships.Last.Score)
    BPQ_Relationships_Reformat<- BPQ_Relationships_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Relationships_Reformat<- gather(BPQ_Relationships_Reformat, Group, BPQ.Relationships.Score, Pre:Post)
    BPQ_Relationships_Reformat$Group<- factor(BPQ_Relationships_Reformat$Group, levels=unique(BPQ_Relationships_Reformat$Group))
    
    BPQ_Relationships_Plot<- ggplot(data = BPQ_Relationships_Reformat, aes(x = factor(Group), y = BPQ.Relationships.Score, group = Name))
    BPQ_Relationships_Plot<- BPQ_Relationships_Plot + geom_line() + xlab("Time") + ylab("Relationships") 
    
    BPQ_Relationships_Plot + scale_y_continuous(limits = c(0, 8), breaks = c(0,2,4,6,8)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Self-Image Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Self_Image_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Self_Image_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Self.Image.First.Score, BPQ.Self.Image.Last.Score)
    BPQ_Self_Image_Reformat<- BPQ_Self_Image_Reformat %>% rename(Pre = BPQ.Self.Image.First.Score, Post = BPQ.Self.Image.Last.Score)
    BPQ_Self_Image_Reformat<- BPQ_Self_Image_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Self_Image_Reformat<- gather(BPQ_Self_Image_Reformat, Group, BPQ.Self.Image.Score, Pre:Post)
    BPQ_Self_Image_Reformat$Group<- factor(BPQ_Self_Image_Reformat$Group, levels=unique(BPQ_Self_Image_Reformat$Group))
    
    BPQ_Self_Image_Plot<- ggplot(data = BPQ_Self_Image_Reformat, aes(x = factor(Group), y = BPQ.Self.Image.Score, group = Name))
    BPQ_Self_Image_Plot<- BPQ_Self_Image_Plot + geom_line() + xlab("Time") + ylab("Self-Image") 
    
    BPQ_Self_Image_Plot + scale_y_continuous(limits = c(0, 9), breaks = c(0,3,6,9)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

\newpage

##Suicide Self-Mutilation Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Suicide_Mutilation_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Suicide_Mutilation_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Suicide.Mutilation.First.Score, BPQ.Suicide.Mutilation.Last.Score)
    BPQ_Suicide_Mutilation_Reformat<- BPQ_Suicide_Mutilation_Reformat %>% rename(Pre = BPQ.Suicide.Mutilation.First.Score, Post = BPQ.Suicide.Mutilation.Last.Score)
    BPQ_Suicide_Mutilation_Reformat<- BPQ_Suicide_Mutilation_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Suicide_Mutilation_Reformat<- gather(BPQ_Suicide_Mutilation_Reformat, Group, BPQ.Suicide.Mutilation.Score, Pre:Post)
    BPQ_Suicide_Mutilation_Reformat$Group<- factor(BPQ_Suicide_Mutilation_Reformat$Group, levels=unique(BPQ_Suicide_Mutilation_Reformat$Group))
    
    BPQ_Suicide_Mutilation_Plot<- ggplot(data = BPQ_Suicide_Mutilation_Reformat, aes(x = factor(Group), y = BPQ.Suicide.Mutilation.Score, group = Name))
    BPQ_Suicide_Mutilation_Plot<- BPQ_Suicide_Mutilation_Plot + geom_line() + xlab("Time") + ylab("Suicide/Self-Mutilation") 
    
    BPQ_Suicide_Mutilation_Plot + scale_y_continuous(limits = c(0, 7), breaks = c(0,1,2,3,4,5,6,7)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Emptiness Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Emptiness_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
    BPQ_Emptiness_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Emptiness.First.Score, BPQ.Emptiness.Last.Score)
    BPQ_Emptiness_Reformat<- BPQ_Emptiness_Reformat %>% rename(Pre = BPQ.Emptiness.First.Score, Post = BPQ.Emptiness.Last.Score)
    BPQ_Emptiness_Reformat<- BPQ_Emptiness_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Emptiness_Reformat<- gather(BPQ_Emptiness_Reformat, Group, BPQ.Emptiness.Score, Pre:Post)
    BPQ_Emptiness_Reformat$Group<- factor(BPQ_Emptiness_Reformat$Group, levels=unique(BPQ_Emptiness_Reformat$Group))
    
    BPQ_Emptiness_Plot<- ggplot(data = BPQ_Emptiness_Reformat, aes(x = factor(Group), y = BPQ.Emptiness.Score, group = Name))
    BPQ_Emptiness_Plot<- BPQ_Emptiness_Plot + geom_line() + xlab("Time") + ylab("Emptiness") 
    
    BPQ_Emptiness_Plot + scale_y_continuous(limits = c(0, 10), breaks = c(0,2,4,6,8,10)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```



##Anger Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Anger_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Anger_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Anger.First.Score, BPQ.Anger.Last.Score)
    BPQ_Anger_Reformat<- BPQ_Anger_Reformat %>% rename(Pre = BPQ.Anger.First.Score, Post = BPQ.Anger.Last.Score)
    BPQ_Anger_Reformat<- BPQ_Anger_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    BPQ_Anger_Reformat<- gather(BPQ_Anger_Reformat, Group, BPQ.Anger.Score, Pre:Post)
    BPQ_Anger_Reformat$Group<- factor(BPQ_Anger_Reformat$Group, levels=unique(BPQ_Anger_Reformat$Group))
    
    BPQ_Anger_Plot<- ggplot(data = BPQ_Anger_Reformat, aes(x = factor(Group), y = BPQ.Anger.Score, group = Name))
    BPQ_Anger_Plot<- BPQ_Anger_Plot + geom_line() + xlab("Time") + ylab("Intense Anger") 
    
    BPQ_Anger_Plot + scale_y_continuous(limits = c(0, 10), breaks = c(0,2,4,6,8,10)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

\newpage

##Quasi-Psychotic States Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Quasi_Psychotic_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
BPQ_Quasi_Psychotic_Reformat<- dplyr::select(Scale_Report_Df, Name, BPQ.Quasi.Psychotic.First.Score, BPQ.Quasi.Psychotic.Last.Score)
    BPQ_Quasi_Psychotic_Reformat<- BPQ_Quasi_Psychotic_Reformat %>% rename(Pre = BPQ.Quasi.Psychotic.First.Score, Post = BPQ.Quasi.Psychotic.Last.Score)
    BPQ_Quasi_Psychotic_Reformat<- BPQ_Quasi_Psychotic_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

  BPQ_Quasi_Psychotic_Reformat<- gather(BPQ_Quasi_Psychotic_Reformat, Group, BPQ.Quasi.Psychotic.Score, Pre:Post)
    BPQ_Quasi_Psychotic_Reformat$Group<- factor(BPQ_Quasi_Psychotic_Reformat$Group, levels=unique(BPQ_Quasi_Psychotic_Reformat$Group))
    
    BPQ_Quasi_Psychotic_Plot<- ggplot(data = BPQ_Quasi_Psychotic_Reformat, aes(x = factor(Group), y = BPQ.Quasi.Psychotic.Score, group = Name))
    BPQ_Quasi_Psychotic_Plot<- BPQ_Quasi_Psychotic_Plot + geom_line() + xlab("Time") + ylab("Quasi-Psychotic") 
    
    BPQ_Quasi_Psychotic_Plot + scale_y_continuous(limits = c(0, 7), breaks = c(0,1,2,3,4,5,6,7)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Average Change Over Treatment Period

####See last page.

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}


cat('\n#', "Reporting Period", '\n')
cat('\n')

if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete BPQ data were used.")
}


BPQ_Descriptives_Tab<- kable(BPQ_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F, latex_options = "striped") %>% row_spec(0, bold = T) %>% kable_styling(latex_options="scale_down")

landscape(BPQ_Descriptives_Tab)

```
