---
title: "Edinborough Postnatal Depression Scale (EDPS)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---


\begingroup\Large

\begin{center} \textbf{Information About the Edinburgh Postnatal Depression Scale (EDPS)} \end{center} 

#What it Measures: 

* Symptoms of emotional distress over the previous week (8 items relate to depressive symptoms and 2 items relate to anxiety symptoms). The EDPS is widely treated as a measure of depressive symptoms. 

* The EDPS was designed to be used during the antenatal and postnatal periods of pregnancy. It was developed to address the problems of existing mood 
scales at that time (e.g. overemphasis on somatic symptoms such as fatigue and sleep difficulties). 

* The EDPS is **not a diagnostic instrument** 


#What Higher Scores Mean:

* More severe symptoms of depression/emotional distress during the past week.


#Scale Quality:

* The EDPS is very widely used, and has undergone extensive psychometric evaluation (for systematic reviews, see Gibson, McKenzie-McHarg, Shakespeare, Price & Gray, 2009; O'Connor, Rossom, Henninger, Groom & Burda, 2015). 

* The EDPS has some important limitations, which have been summarised by Matthey & Agostini (2017). Cox (2017) has provided a succint paper to guide correct use of the EDPS. 

* To address the problem of multiple validated cut-off scores, I have created default cut-off scores based on the data provided by systematic reviews and studies that employed large samples. If possible, locate a study providing cut-off score information or normative values for the population that you work with. You can then use these values to create custom cut-off scores with this application.

#Scale Structure:

* 10 items.

* 4-point Likert scale. 

* 8 items are reverse-scored and worded negatively (e.g. "I have felt sad or miserable:").

* 2 items are worded positively (e.g."I have looked forward with enjoyment to things:"). 

* Respondents are asked how frequently (e.g."Yes, most of the time" = 3; "No, not at all" = 0) they experienced the each statement during the previous week. 

* Recent research has challenged the assumed unidimensional structure of the EDPS, proposing a 3-factor structure consisting of Anxiety, Depression & Anhedonia (Martin & Redshaw, 2018). 


\endgroup

\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #EDPS nonsig calculations 
    
    EDPS_Imp_Df<-dplyr::select(Imp_Df, contains("EDPS.Fullscale"))

    
    EDPS_Imp_Df<-as.data.frame(gather(EDPS_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    
    #EDPS sig calculations
    
    
    EDPS_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("EDPS.Fullscale"))

    
    EDPS_Sig_Imp_Df<-as.data.frame(gather(EDPS_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
     if(nrow(EDPS_Imp_Df) == 1 & nrow(EDPS_Sig_Imp_Df) == 1) {
      EDPS_Percentages<- rbind(EDPS_Imp_Df, EDPS_Sig_Imp_Df)
      EDPS_Percentages<- cbind(Improvement_Type, EDPS_Percentages)
    }  else if(nrow(EDPS_Imp_Df) == 1 & nrow(EDPS_Sig_Imp_Df) == 0) {
      EDPS_Percentages = rbind(EDPS_Imp_Df, Sig_Null)
       EDPS_Percentages<- cbind(Improvement_Type, EDPS_Percentages)
    } else if(nrow(EDPS_Imp_Df) == 0) {
      EDPS_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      EDPS_Percentages<- cbind(Improvement_Type, EDPS_Percentages)
    }

     names(EDPS_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
     
    Scale_Names<- c("EDPS Total")
    
    EDPS_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("EDPS")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    EDPS_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("EDPS")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    EDPS_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("EDPS")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    EDPS_Range<- c("Total Scale" = "0-30")

    
    EDPS_Descriptives<- rbind(EDPS_M_Intake, EDPS_M_Discharge, EDPS_M_Change, EDPS_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    EDPS_Descriptives<- cbind(Data, EDPS_Descriptives)
  
```

##EDPS

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(EDPS_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
  
#EDPS Graph
    
    EDPS_Reformat<- dplyr::select(Scale_Report_Df, Name, EDPS.Fullscale.First.Score, EDPS.Fullscale.Last.Score)
    EDPS_Reformat<- EDPS_Reformat %>% rename(Pre = EDPS.Fullscale.First.Score, Post = EDPS.Fullscale.Last.Score)
    EDPS_Reformat<- EDPS_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    EDPS_Reformat<- gather(EDPS_Reformat, Group, EDPS.Total.Score, Pre:Post)
    EDPS_Reformat$Group<- factor(EDPS_Reformat$Group, levels=unique(EDPS_Reformat$Group))
    
    EDPS_Plot<- ggplot(data = EDPS_Reformat, aes (x = factor(Group), y = EDPS.Total.Score, group = Name))
    EDPS_Plot<- EDPS_Plot + geom_line() + xlab("Time") + ylab("EDPS Total") 
    
    EDPS_Plot + scale_y_continuous(limits = c(0, 30), breaks = c(0,10,20,30)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```


##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(EDPS_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) %>% column_spec(1, width = "6cm")

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete EDPS data were used.")
}


```