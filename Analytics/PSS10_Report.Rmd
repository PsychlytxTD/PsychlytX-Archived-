---
title: "Perceived Stress Scale - 10 (PSS-10)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---


\begingroup\Large

\begin{center} \textbf{Information About the Perceived Stress Scale - 10 (PSS-10)} \end{center} 

#What it Measures: 

* Stress (i.e. the degre to which people perceive situations in their life as excessively stressful relative to their ability to cope).

* "How unpredictable, uncontrollable, and overloaded respondents find their lives" (Cohen & Williamson, 1988, p. 34). 


#What Higher Scores Mean:

* More severe stress.


#Scale Quality:

* The PSS-10 and the PSS-14 are among the most widely used measures of stress (Taylor, 2015). The psychometric properties of both scale versions have been well established (for a systematic review, see Lee, 2012). 


#Scale Structure:

* 10 items.

* 5-point Likert scale.

* Respondents indicate how often (0 = "Never"; 4 = "Very Often") they thought or felt the statements listed (e.g. "In the last month, how often have you felt that you were unable to control the important things in your life?"). 

* Psychometric analyses have suggested that the PSS-10 has a two-factor structure, however the scale us usually scored in terms of a single construct (Jiang, Seng, Zimmerman, Sliwinski, Kim & Lipton, 2017). 

\endgroup
\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #PSS-10 nonsig calculations 
    
    PSS10_Imp_Df<-dplyr::select(Imp_Df, contains("PSS10.Fullscale"))

    
    PSS10_Imp_Df<-as.data.frame(gather(PSS10_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    
    #PSS-10 sig calculations
    
    
    PSS10_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("PSS10.Fullscale"))

    
    PSS10_Sig_Imp_Df<-as.data.frame(gather(PSS10_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
     if(nrow(PSS10_Imp_Df) == 1 & nrow(PSS10_Sig_Imp_Df) == 1) {
      PSS10_Percentages<- rbind(PSS10_Imp_Df, PSS10_Sig_Imp_Df)
      PSS10_Percentages<- cbind(Improvement_Type, PSS10_Percentages)
    }  else if(nrow(PSS10_Imp_Df) == 1 & nrow(PSS10_Sig_Imp_Df) == 0) {
      PSS10_Percentages = rbind(PSS10_Imp_Df, Sig_Null)
       PSS10_Percentages<- cbind(Improvement_Type, PSS10_Percentages)
    } else if(nrow(PSS10_Imp_Df) == 0) {
      PSS10_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      PSS10_Percentages<- cbind(Improvement_Type, PSS10_Percentages)
    }

     names(PSS10_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
     
    Scale_Names<- c("PSS-10 Total")
    
    PSS10_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("PSS10")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    PSS10_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("PSS10")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    PSS10_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("PSS10")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    PSS10_Range<- c("Total Scale" = "0-40")

    
    PSS10_Descriptives<- rbind(PSS10_M_Intake, PSS10_M_Discharge, PSS10_M_Change, PSS10_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    PSS10_Descriptives<- cbind(Data, PSS10_Descriptives)
  
```

##PSS-10 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(PSS10_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
  
#PSS10 Graph
    
    PSS10_Reformat<- dplyr::select(Scale_Report_Df, Name, PSS10.Fullscale.First.Score, PSS10.Fullscale.Last.Score)
    PSS10_Reformat<- PSS10_Reformat %>% rename(Pre = PSS10.Fullscale.First.Score, Post = PSS10.Fullscale.Last.Score)
    PSS10_Reformat<- PSS10_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    PSS10_Reformat<- gather(PSS10_Reformat, Group, PSS10.Total.Score, Pre:Post)
    PSS10_Reformat$Group<- factor(PSS10_Reformat$Group, levels=unique(PSS10_Reformat$Group))
    
    PSS10_Plot<- ggplot(data = PSS10_Reformat, aes (x = factor(Group), y = PSS10.Total.Score, group = Name))
    PSS10_Plot<- PSS10_Plot + geom_line() + xlab("Time") + ylab("PSS-10 Total") 
    
    PSS10_Plot + scale_y_continuous(limits = c(0, 40), breaks = c(0,10,20,30,40)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```


##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(PSS10_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) %>% column_spec(1, width = "6cm")

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete PSS-10 data were used.")
}


```