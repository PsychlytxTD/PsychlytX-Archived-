---
title: "Eating Disorder Examination Questionnaire (EDE-Q)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information about the Eating Disorder Examination Questionnaire (EDE-Q)} \end{center} 

#What it Measures: 

* The frequency of important eating disorder behaviours, including restriction of eating **(Restraint)**, and thoughts/preoccupations related to eating **(Eating Concern)**, body-shape **(Shape Concern)**, and weight **(Weight Concern)**. 

* The EDE-Q is the self-report form of the Eating Disorder Examination (EDE), a structured, clinician-administered interview that is considered the gold standard in assessment of eating disorder symptomatology. 

* The EDE-Q also contains items assessing binge eating symptoms, however these items are not included in the subscale or total scale scores. 


#What Higher Scores Mean:

* Greater frequency of eating disorder symptomatology. 

#Scale Quality:

* The EDE-Q is one of the most frequently-used measures of eating disorder symptomatology. The scale has been critiqued on the grounds of having an irreplicable factor structure and being emotionnally-triggering for respondents. However, systematic review supported and found that it performed similarly to the EDE in important respects (Berg, Peterson, Frazier & Crow, 2013). 

#Scale Structure: 

* The original 4-factor structure of the EDE-Q (Fairburn & Beglin, 1994) has generally not been supported by subsequent research. A recent confirmatory factor analysis and assessment of measurement invariance (based on sex) evalutated 12 different models proposed by previous studies (Rand-Giovannetti, Cicero, Mond & Latner, 2017). The authors found the strongest support for the model of Friborg et al. (2013), a 4-factor model comprising (1) dietary restraint, (2) preoccupation and restriction, (3) weight and shape concern, and (4) eating shame. 

\endgroup

\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #EDEQ nonsig calculations 
    
    EDEQ_Imp_Df<-dplyr::select(Imp_Df, contains("EDEQ.Fullscale"))
    Restraint_Imp_Df<-dplyr::select(Imp_Df, contains("EDEQ.Restraint"))
    Eating_Concern_Imp_Df<- dplyr::select(Imp_Df, contains("EDEQ.Eating.Concern"))
    Shape_Concern_Imp_Df<-dplyr::select(Imp_Df, contains("EDEQ.Shape.Concern"))
    Weight_Concern_Imp_Df<-dplyr::select(Imp_Df, contains("EDEQ.Weight.Concern"))
    
    
    EDEQ_Imp_Df<-as.data.frame(gather(EDEQ_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    Restraint_Imp_Df<-as.data.frame(gather(Restraint_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Eating_Concern_Imp_Df<-as.data.frame(gather(Eating_Concern_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Shape_Concern_Imp_Df<-as.data.frame(gather(Shape_Concern_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Weight_Concern_Imp_Df<-as.data.frame(gather(Weight_Concern_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
   
    
    #EDEQ sig calculations
    
    
    EDEQ_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("EDEQ.Fullscale"))
    Restraint_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("EDEQ.Restraint"))
    Eating_Concern_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("EDEQ.Eating.Concern"))
    Shape_Concern_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("EDEQ.Shape.Concern"))
    Weight_Concern_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("EDEQ.Weight.Concern"))
   
    
      EDEQ_Sig_Imp_Df<-as.data.frame(gather(EDEQ_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
      
    Restraint_Sig_Imp_Df<-as.data.frame(gather(Restraint_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Eating_Concern_Sig_Imp_Df<-as.data.frame(gather(Eating_Concern_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Shape_Concern_Sig_Imp_Df<-as.data.frame(gather(Shape_Concern_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Weight_Concern_Sig_Imp_Df<-as.data.frame(gather(Weight_Concern_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
   
    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
    if(nrow(EDEQ_Imp_Df) == 1 & nrow(EDEQ_Sig_Imp_Df) == 1) {
      EDEQ_Percentages<- rbind(EDEQ_Imp_Df, EDEQ_Sig_Imp_Df)
      EDEQ_Percentages<- cbind(Improvement_Type, EDEQ_Percentages)
    }  else if(nrow(EDEQ_Imp_Df) == 1 & nrow(EDEQ_Sig_Imp_Df) == 0) {
      EDEQ_Percentages = rbind(EDEQ_Imp_Df, Sig_Null)
       EDEQ_Percentages<- cbind(Improvement_Type, EDEQ_Percentages)
    } else if(nrow(EDEQ_Imp_Df) == 0) {
      EDEQ_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      EDEQ_Percentages<- cbind(Improvement_Type, EDEQ_Percentages)
    }

     names(EDEQ_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


       
       if(nrow(Restraint_Imp_Df) == 1 & nrow(Restraint_Sig_Imp_Df) == 1) {
      Restraint_Percentages<- rbind(Restraint_Imp_Df, Restraint_Sig_Imp_Df)
      Restraint_Percentages<- cbind(Improvement_Type, Restraint_Percentages)
    }  else if(nrow(Restraint_Imp_Df) == 1 & nrow(Restraint_Sig_Imp_Df) == 0) {
      Restraint_Percentages = rbind(Restraint_Imp_Df, Sig_Null)
       Restraint_Percentages<- cbind(Improvement_Type, Restraint_Percentages)
    } else if(nrow(Restraint_Imp_Df) == 0) {
      Restraint_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Restraint_Percentages<- cbind(Improvement_Type, Restraint_Percentages)
    }

     names(Restraint_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
       if(nrow(Eating_Concern_Imp_Df) == 1 & nrow(Eating_Concern_Sig_Imp_Df) == 1) {
      Eating_Concern_Percentages<- rbind(Eating_Concern_Imp_Df, Eating_Concern_Sig_Imp_Df)
      Eating_Concern_Percentages<- cbind(Improvement_Type, Eating_Concern_Percentages)
    }  else if(nrow(Eating_Concern_Imp_Df) == 1 & nrow(Eating_Concern_Sig_Imp_Df) == 0) {
      Eating_Concern_Percentages = rbind(Eating_Concern_Imp_Df, Sig_Null)
       Eating_Concern_Percentages<- cbind(Improvement_Type, Eating_Concern_Percentages)
    } else if(nrow(Eating_Concern_Imp_Df) == 0) {
      Eating_Concern_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Eating_Concern_Percentages<- cbind(Improvement_Type, Eating_Concern_Percentages)
    }

     names(Eating_Concern_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
      if(nrow(Shape_Concern_Imp_Df) == 1 & nrow(Shape_Concern_Sig_Imp_Df) == 1) {
      Shape_Concern_Percentages<- rbind(Shape_Concern_Imp_Df, Shape_Concern_Sig_Imp_Df)
      Shape_Concern_Percentages<- cbind(Improvement_Type, Shape_Concern_Percentages)
    }  else if(nrow(Shape_Concern_Imp_Df) == 1 & nrow(Shape_Concern_Sig_Imp_Df) == 0) {
      Shape_Concern_Percentages = rbind(Shape_Concern_Imp_Df, Sig_Null)
       Shape_Concern_Percentages<- cbind(Improvement_Type, Shape_Concern_Percentages)
    } else if(nrow(Shape_Concern_Imp_Df) == 0) {
      Shape_Concern_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Shape_Concern_Percentages<- cbind(Improvement_Type, Shape_Concern_Percentages)
    }

     names(Shape_Concern_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    
  
    
      if(nrow(Weight_Concern_Imp_Df) == 1 & nrow(Weight_Concern_Sig_Imp_Df) == 1) {
      Weight_Concern_Percentages<- rbind(Weight_Concern_Imp_Df, Weight_Concern_Sig_Imp_Df)
      Weight_Concern_Percentages<- cbind(Improvement_Type, Weight_Concern_Percentages)
    }  else if(nrow(Weight_Concern_Imp_Df) == 1 & nrow(Weight_Concern_Sig_Imp_Df) == 0) {
      Weight_Concern_Percentages = rbind(Weight_Concern_Imp_Df, Sig_Null)
       Weight_Concern_Percentages<- cbind(Improvement_Type, Weight_Concern_Percentages)
    } else if(nrow(Weight_Concern_Imp_Df) == 0) {
      Weight_Concern_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Weight_Concern_Percentages<- cbind(Improvement_Type, Weight_Concern_Percentages)
    }

     names(Weight_Concern_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


      Scale_Names<- c("EDE-Q Total", "Restraint", "Eating Concern", "Shape Concern", "Weight Concern")
    
    EDEQ_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("EDEQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    EDEQ_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("EDEQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    EDEQ_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("EDEQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    EDEQ_Range<- c("Total Scale" = "0-4","Restraint" = "0-5",  "Eating Concern" = "0-5",  "Shape Concern" = "0-8", "Weight Concern" = "0-5")

    
    EDEQ_Descriptives<- rbind(EDEQ_M_Intake, EDEQ_M_Discharge, EDEQ_M_Change, EDEQ_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    EDEQ_Descriptives<- cbind(Data, EDEQ_Descriptives) 
  
```

##EDE-Q Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(EDEQ_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}

    EDEQ_Reformat<- dplyr::select(Scale_Report_Df, Name, EDEQ.Fullscale.First.Score, EDEQ.Fullscale.Last.Score)
    EDEQ_Reformat<- EDEQ_Reformat %>% rename(Pre = EDEQ.Fullscale.First.Score, Post = EDEQ.Fullscale.Last.Score)
    EDEQ_Reformat<- EDEQ_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    EDEQ_Reformat<- gather(EDEQ_Reformat, Group, EDEQ.Total.Score, Pre:Post)
    EDEQ_Reformat$Group<- factor(EDEQ_Reformat$Group, levels=unique(EDEQ_Reformat$Group))
    
    EDEQ_Plot<- ggplot(data = EDEQ_Reformat, aes (x = factor(Group), y = EDEQ.Total.Score, group = Name))
    EDEQ_Plot<- EDEQ_Plot + geom_line() + xlab("Time") + ylab("EDE-Q Total") 
    
    EDEQ_Plot + scale_y_continuous(limits = c(0, 4), breaks = c(0,1,2,3,4)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Restraint Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Restraint_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
EDEQ_Restraint_Reformat<- dplyr::select(Scale_Report_Df, Name, EDEQ.Restraint.First.Score, EDEQ.Restraint.Last.Score)
    EDEQ_Restraint_Reformat<- EDEQ_Restraint_Reformat %>% rename(Pre = EDEQ.Restraint.First.Score, Post = EDEQ.Restraint.Last.Score)
    EDEQ_Restraint_Reformat<- EDEQ_Restraint_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    EDEQ_Restraint_Reformat<- gather(EDEQ_Restraint_Reformat, Group, EDEQ.Restraint.Score, Pre:Post)
    EDEQ_Restraint_Reformat$Group<- factor(EDEQ_Restraint_Reformat$Group, levels=unique(EDEQ_Restraint_Reformat$Group))
    
    EDEQ_Restraint_Plot<- ggplot(data = EDEQ_Restraint_Reformat, aes(x = factor(Group), y = EDEQ.Restraint.Score, group = Name))
    EDEQ_Restraint_Plot<- EDEQ_Restraint_Plot + geom_line() + xlab("Time") + ylab("Restraint") 
    
    EDEQ_Restraint_Plot + scale_y_continuous(limits = c(0, 5), breaks = c(0,1,2,3,4,5)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Eating Concern Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Eating_Concern_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
EDEQ_Eating_Concern_Reformat<- dplyr::select(Scale_Report_Df, Name, EDEQ.Eating.Concern.First.Score, EDEQ.Eating.Concern.Last.Score)
    EDEQ_Eating_Concern_Reformat<- EDEQ_Eating_Concern_Reformat %>% rename(Pre = EDEQ.Eating.Concern.First.Score, Post = EDEQ.Eating.Concern.Last.Score)
    EDEQ_Eating_Concern_Reformat<- EDEQ_Eating_Concern_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    EDEQ_Eating_Concern_Reformat<- gather(EDEQ_Eating_Concern_Reformat, Group, EDEQ.Eating.Concern.Score, Pre:Post)
    EDEQ_Eating_Concern_Reformat$Group<- factor(EDEQ_Eating_Concern_Reformat$Group, levels=unique(EDEQ_Eating_Concern_Reformat$Group))
    
    EDEQ_Eating_Concern_Plot<- ggplot(data = EDEQ_Eating_Concern_Reformat, aes (x = factor(Group), y = EDEQ.Eating.Concern.Score, group = Name))
    EDEQ_Eating_Concern_Plot<- EDEQ_Eating_Concern_Plot + geom_line() + xlab("Time") + ylab("Eating Concern") 
    
    EDEQ_Eating_Concern_Plot + scale_y_continuous(limits = c(0, 5), breaks = c(0,1,2,3,4,5)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

\newpage

##Shape Concern Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Shape_Concern_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
EDEQ_Shape_Concern_Reformat<- dplyr::select(Scale_Report_Df, Name, EDEQ.Shape.Concern.First.Score, EDEQ.Shape.Concern.Last.Score)
    EDEQ_Shape_Concern_Reformat<- EDEQ_Shape_Concern_Reformat %>% rename(Pre = EDEQ.Shape.Concern.First.Score, Post = EDEQ.Shape.Concern.Last.Score)
    EDEQ_Shape_Concern_Reformat<- EDEQ_Shape_Concern_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    EDEQ_Shape_Concern_Reformat<- gather(EDEQ_Shape_Concern_Reformat, Group, EDEQ.Shape.Concern.Score, Pre:Post)
    EDEQ_Shape_Concern_Reformat$Group<- factor(EDEQ_Shape_Concern_Reformat$Group, levels=unique(EDEQ_Shape_Concern_Reformat$Group))
    
    EDEQ_Shape_Concern_Plot<- ggplot(data = EDEQ_Shape_Concern_Reformat, aes(x = factor(Group), y = EDEQ.Shape.Concern.Score, group = Name))
    EDEQ_Shape_Concern_Plot<- EDEQ_Shape_Concern_Plot + geom_line() + xlab("Time") + ylab("Shape Concern") 
    
    EDEQ_Shape_Concern_Plot + scale_y_continuous(limits = c(0, 8), breaks = c(0,2,4,6,8)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Weight Concern Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Weight_Concern_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
EDEQ_Weight_Concern_Reformat<- dplyr::select(Scale_Report_Df, Name, EDEQ.Weight.Concern.First.Score, EDEQ.Weight.Concern.Last.Score)
    EDEQ_Weight_Concern_Reformat<- EDEQ_Weight_Concern_Reformat %>% rename(Pre = EDEQ.Weight.Concern.First.Score, Post = EDEQ.Weight.Concern.Last.Score)
    EDEQ_Weight_Concern_Reformat<- EDEQ_Weight_Concern_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    EDEQ_Weight_Concern_Reformat<- gather(EDEQ_Weight_Concern_Reformat, Group, EDEQ.Weight.Concern.Score, Pre:Post)
    EDEQ_Weight_Concern_Reformat$Group<- factor(EDEQ_Weight_Concern_Reformat$Group, levels=unique(EDEQ_Weight_Concern_Reformat$Group))
    
    EDEQ_Weight_Concern_Plot<- ggplot(data = EDEQ_Weight_Concern_Reformat, aes(x = factor(Group), y = EDEQ.Weight.Concern.Score, group = Name))
    EDEQ_Weight_Concern_Plot<- EDEQ_Weight_Concern_Plot + geom_line() + xlab("Time") + ylab("Weight Concern") 
    
    EDEQ_Weight_Concern_Plot + scale_y_continuous(limits = c(0, 5), breaks = c(0,1,2,3,4,5)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}
kable(EDEQ_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

##Reporting Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete EDE-Q data were used.")
}


```
