---
title: "Chronic Pain Acceptance Questionnaire (CPAQ)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information About The Chronic Pain Acceptance Questionnaire (CPAQ)} \end{center} 


#What it Measures: 

* Acceptance of pain. Pain acceptance is theorised to reduce unhelpful attempts aimed at avoiding or controlling pain sensations, and therefore focusing on the pursuit of valued activities and meaningful goals.

* The Activity Engagement subscale measures participation in life activities despite pain.

* The Pain Willingness subscale measures the extent to which pain is allowed in experience, without efforts to avoid or control it. 


#What Higher Scores Mean:

* Greater avoidance of life activities due to pain and/or greater struggle (psychologically and behaviourally) with the physiological experience of pain. 


#Scale Quality:

* The CPAQ has been used in a large number of studies examining the importance of pain acceptance. A systematic review concluded that the CPAQ was the optimal measure for assessing pain acceptance, despite some psychometric limitations (Reneman, Dijkstra, Geertzen & Dijkstra, 2010). 


#Scale Structure:

* The original version of the CPAQ contains 20 items (CPAQ-20). A shorter version contains 8 items (CPAQ-8). The two versions appear to have similar psychometric properties (Rovner, Vowles, Gerdle & Gillanders, 2015). 

* 7-point Likert scale. 

* Respondents indicate how true (0 = "Never true"; 6 = "Always true") each statement is for them (e.g. "I need to concentrate on getting rid of my pain"). 

* Factor analyses have supported a 2-factor structure (Baranoff, Hanrahan, Kapur & Connor, 2012; Lieu, Wan, Wei, Wang, Xu et al., 2016; Vowles, McCracken, McLeod & Eccleston, 2008). 


\endgroup

\newpage 

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #CPAQ nonsig calculations 
    
    CPAQ_Imp_Df<-dplyr::select(Imp_Df, contains("CPAQ.Fullscale"))
    AE_Imp_Df<-dplyr::select(Imp_Df, contains("CPAQ.Activity.Engagement"))
    PW_Imp_Df<- dplyr::select(Imp_Df, contains("CPAQ.Pain.Willingness"))
    
    CPAQ_Imp_Df<-as.data.frame(gather(CPAQ_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    AE_Imp_Df<-as.data.frame(gather(AE_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    PW_Imp_Df<-as.data.frame(gather(PW_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    
    #CPAQ sig calculations
    
    
    CPAQ_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("CPAQ.Fullscale"))
    AE_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("CPAQ.Activity.Engagement"))
    PW_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("CPAQ.Pain.Willingness"))
    
    CPAQ_Sig_Imp_Df<-as.data.frame(gather(CPAQ_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    AE_Sig_Imp_Df<-as.data.frame(gather(AE_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    PW_Sig_Imp_Df<-as.data.frame(gather(PW_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
     if(nrow(CPAQ_Imp_Df) == 1 & nrow(CPAQ_Sig_Imp_Df) == 1) {
      CPAQ_Percentages<- rbind(CPAQ_Imp_Df, CPAQ_Sig_Imp_Df)
      CPAQ_Percentages<- cbind(Improvement_Type, CPAQ_Percentages)
    }  else if(nrow(CPAQ_Imp_Df) == 1 & nrow(CPAQ_Sig_Imp_Df) == 0) {
      CPAQ_Percentages = rbind(CPAQ_Imp_Df, Sig_Null)
       CPAQ_Percentages<- cbind(Improvement_Type, CPAQ_Percentages)
    } else if(nrow(CPAQ_Imp_Df) == 0) {
      CPAQ_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      CPAQ_Percentages<- cbind(Improvement_Type, CPAQ_Percentages)
    }

     names(CPAQ_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
    
    if(nrow(AE_Imp_Df) == 1 & nrow(AE_Sig_Imp_Df) == 1) {
      AE_Percentages<- rbind(AE_Imp_Df, AE_Sig_Imp_Df)
      AE_Percentages<- cbind(Improvement_Type, AE_Percentages)
    }  else if(nrow(AE_Imp_Df) == 1 & nrow(AE_Sig_Imp_Df) == 0) {
      AE_Percentages = rbind(AE_Imp_Df, Sig_Null)
       AE_Percentages<- cbind(Improvement_Type, AE_Percentages)
    } else if(nrow(AE_Imp_Df) == 0) {
      AE_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      AE_Percentages<- cbind(Improvement_Type, AE_Percentages)
    }

     names(AE_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
     if(nrow(PW_Imp_Df) == 1 & nrow(PW_Sig_Imp_Df) == 1) {
      PW_Percentages<- rbind(PW_Imp_Df, PW_Sig_Imp_Df)
      PW_Percentages<- cbind(Improvement_Type, PW_Percentages)
    }  else if(nrow(PW_Imp_Df) == 1 & nrow(PW_Sig_Imp_Df) == 0) {
      PW_Percentages = rbind(PW_Imp_Df, Sig_Null)
       PW_Percentages<- cbind(Improvement_Type, PW_Percentages)
    } else if(nrow(PW_Imp_Df) == 0) {
      PW_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      PW_Percentages<- cbind(Improvement_Type, PW_Percentages)
    }

     names(PW_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
     
     
    Scale_Names<- c("CPAQ Total", "Activity Engagement", "Pain Willingness")
    
    CPAQ_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("CPAQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    CPAQ_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("CPAQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    CPAQ_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("CPAQ")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    CPAQ_Range<- c("Total Scale" = "0-120", "Activity Engagement" = "0-54", "Pain Willingness" = "0-66")

    
    CPAQ_Descriptives<- rbind(CPAQ_M_Intake, CPAQ_M_Discharge, CPAQ_M_Change, CPAQ_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    CPAQ_Descriptives<- cbind(Data, CPAQ_Descriptives)
  
```

##Chronic Pain Acceptance Questionnaire Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(CPAQ_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
  
#CPAQ Graph
    
    CPAQ_Reformat<- dplyr::select(Scale_Report_Df, Name, CPAQ.Fullscale.First.Score, CPAQ.Fullscale.Last.Score)
    CPAQ_Reformat<- CPAQ_Reformat %>% rename(Pre = CPAQ.Fullscale.First.Score, Post = CPAQ.Fullscale.Last.Score)
    CPAQ_Reformat<- CPAQ_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    CPAQ_Reformat<- gather(CPAQ_Reformat, Group, CPAQ.Total.Score, Pre:Post)
    CPAQ_Reformat$Group<- factor(CPAQ_Reformat$Group, levels=unique(CPAQ_Reformat$Group))
    
    CPAQ_Plot<- ggplot(data = CPAQ_Reformat, aes (x = factor(Group), y = CPAQ.Total.Score, group = Name))
    CPAQ_Plot<- CPAQ_Plot + geom_line() + xlab("Time") + ylab("CPAQ Total") 
    
    CPAQ_Plot + scale_y_continuous(limits = c(0, 120), breaks = c(0,40,80,120)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Activity Engagement Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(AE_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
CPAQ_AE_Reformat<- dplyr::select(Scale_Report_Df, Name, CPAQ.Activity.Engagement.First.Score, CPAQ.Activity.Engagement.Last.Score)
    CPAQ_AE_Reformat<- CPAQ_AE_Reformat %>% rename(Pre = CPAQ.Activity.Engagement.First.Score, Post = CPAQ.Activity.Engagement.Last.Score)
    CPAQ_AE_Reformat<- CPAQ_AE_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    CPAQ_AE_Reformat<- gather(CPAQ_AE_Reformat, Group, CPAQ.Activity.Engagement.Score, Pre:Post)
    CPAQ_AE_Reformat$Group<- factor(CPAQ_AE_Reformat$Group, levels=unique(CPAQ_AE_Reformat$Group))
    
    CPAQ_AE_Plot<- ggplot(data = CPAQ_AE_Reformat, aes(x = factor(Group), y = CPAQ.Activity.Engagement.Score, group = Name))
    CPAQ_AE_Plot<- CPAQ_AE_Plot + geom_line() + xlab("Time") + ylab("Activity Engagement") 
    
    CPAQ_AE_Plot + scale_y_continuous(limits = c(0, 54), breaks = c(0,18,36,54)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Pain Willingness Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(PW_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
CPAQ_PW_Reformat<- dplyr::select(Scale_Report_Df, Name, CPAQ.Pain.Willingness.First.Score, CPAQ.Pain.Willingness.Last.Score)
    CPAQ_PW_Reformat<- CPAQ_PW_Reformat %>% rename(Pre = CPAQ.Pain.Willingness.First.Score, Post = CPAQ.Pain.Willingness.Last.Score)
    CPAQ_PW_Reformat<- CPAQ_PW_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    CPAQ_PW_Reformat<- gather(CPAQ_PW_Reformat, Group, CPAQ.Pain.Willingness.Score, Pre:Post)
    CPAQ_PW_Reformat$Group<- factor(CPAQ_PW_Reformat$Group, levels=unique(CPAQ_PW_Reformat$Group))
    
    CPAQ_PW_Plot<- ggplot(data = CPAQ_PW_Reformat, aes (x = factor(Group), y = CPAQ.Pain.Willingness.Score, group = Name))
    CPAQ_PW_Plot<- CPAQ_PW_Plot + geom_line() + xlab("Time") + ylab("Pain Willingness") 
    
    CPAQ_PW_Plot + scale_y_continuous(limits = c(0, 66), breaks = c(0,22,44,66)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(CPAQ_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete CPQA data were used.")
}


```