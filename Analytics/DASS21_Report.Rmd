---
title: "Depression Anxiety Stress Scales - 21 (DASS-21)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information about the Depression Anxiety Stress Scales - 21 (DASS-21)} \end{center} 

#What it Measures: 

* Severity of depression, anxiety and stress. The DASS-21 is **not a diagnostic instrument** and is based on a dimensional rather than categorical understanding of psychological disorder. 

Information below about DASS-21 subscales is derived from a summary provided by the University of New South Wales (http://www2.psy.unsw.edu.au/Groups/Dass/over.htm). 

* The Depression subscale assesses dysphoric mood, feelings of hopelessness, devaluation of life, self-deprecation, lack of interest/participation, anhedonia, and inertia. 
* The Anxiety scale assesses autonomic arousal, skeletal muscle changes, situational anxiety, and the subjective experience of anxious affect.

* The Stress scale is sensitive to levels of chronic non-specific arousal. It assesses difficulty relaxing, nervous arousal, and being easily upset/agitated, irritable/over-reactive and impatient.


#What Higher Scores Mean:

* More severe symptoms of depression, anxiety and stress.


#Scale Quality:

* The DASS-21 has undergone extensive psychometric validation and is one of the most frequently adopted measures within clinical psychology. It is suitable for use with a wide range of populations (Henry & Crawford, 2005). 


#Scale Structure:

* 21-item scale. 

* Three subscales (depression, anxiety & stress), each containing 7 items. Item scores on each subscale are summed.

* A general psychological distress score can be obtained by summing total scores across all subscales. 

* Respondents indicate on a 4-point Likert scale how often (0 = "never"; 3 = "almost always") each statement applied to them during the past week (e.g. "I found it hard to wind down"). 

* Factor analytic research has generally supported a 3-factor structure (Norton, 2007; Page, Hooke & Morisson, 2007), although alternative structural models have also been proposed (Osman, Wong, Bagge, Freedenthal, Gutierrez & Lozano, 2012). 

\endgroup

\newpage 

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #DASS21 nonsig calculations 
    
    DASS21_Imp_Df<-dplyr::select(Imp_Df, contains("DASS21.Fullscale"))
    Dep_Imp_Df<-dplyr::select(Imp_Df, contains("DASS21.Depression"))
    Anx_Imp_Df<- dplyr::select(Imp_Df, contains("DASS21.Anxiety"))
    Stress_Imp_Df<-dplyr::select(Imp_Df, contains("DASS21.Stress"))
    
    DASS21_Imp_Df<-as.data.frame(gather(DASS21_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Dep_Imp_Df<-as.data.frame(gather(Dep_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Anx_Imp_Df<-as.data.frame(gather(Anx_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Stress_Imp_Df<-as.data.frame(gather(Stress_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    
    #DASS21 sig calculations
    
    
    DASS21_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("DASS21.Fullscale"))
    Dep_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("DASS21.Depression"))
    Anx_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("DASS21.Anxiety"))
    Stress_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("DASS21.Stress"))
    
    DASS21_Sig_Imp_Df<-as.data.frame(gather(DASS21_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Dep_Sig_Imp_Df<-as.data.frame(gather(Dep_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Anx_Sig_Imp_Df<-as.data.frame(gather(Anx_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Stress_Sig_Imp_Df<-as.data.frame(gather(Stress_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
     if(nrow(DASS21_Imp_Df) == 1 & nrow(DASS21_Sig_Imp_Df) == 1) {
      DASS21_Percentages<- rbind(DASS21_Imp_Df, DASS21_Sig_Imp_Df)
      DASS21_Percentages<- cbind(Improvement_Type, DASS21_Percentages)
    }  else if(nrow(DASS21_Imp_Df) == 1 & nrow(DASS21_Sig_Imp_Df) == 0) {
      DASS21_Percentages = rbind(DASS21_Imp_Df, Sig_Null)
       DASS21_Percentages<- cbind(Improvement_Type, DASS21_Percentages)
    } else if(nrow(DASS21_Imp_Df) == 0) {
      DASS21_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      DASS21_Percentages<- cbind(Improvement_Type, DASS21_Percentages)
    }

     names(DASS21_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
 
    if(nrow(Dep_Imp_Df) == 1 & nrow(Dep_Sig_Imp_Df) == 1) {
      Dep_Percentages<- rbind(Dep_Imp_Df, Dep_Sig_Imp_Df)
      Dep_Percentages<- cbind(Improvement_Type, Dep_Percentages)
    }  else if(nrow(Dep_Imp_Df) == 1 & nrow(Dep_Sig_Imp_Df) == 0) {
      Dep_Percentages = rbind(Dep_Imp_Df, Sig_Null)
       Dep_Percentages<- cbind(Improvement_Type, Dep_Percentages)
    } else if(nrow(Dep_Imp_Df) == 0) {
      Dep_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Dep_Percentages<- cbind(Improvement_Type, Dep_Percentages)
    }

     names(Dep_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
     if(nrow(Anx_Imp_Df) == 1 & nrow(Anx_Sig_Imp_Df) == 1) {
      Anx_Percentages<- rbind(Anx_Imp_Df, Anx_Sig_Imp_Df)
      Anx_Percentages<- cbind(Improvement_Type, Anx_Percentages)
    }  else if(nrow(Anx_Imp_Df) == 1 & nrow(Anx_Sig_Imp_Df) == 0) {
      Anx_Percentages = rbind(Anx_Imp_Df, Sig_Null)
       Anx_Percentages<- cbind(Improvement_Type, Anx_Percentages)
    } else if(nrow(Anx_Imp_Df) == 0) {
      Anx_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Anx_Percentages<- cbind(Improvement_Type, Anx_Percentages)
    }

     names(Anx_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
     
      if(nrow(Stress_Imp_Df) == 1 & nrow(Stress_Sig_Imp_Df) == 1) {
      Stress_Percentages<- rbind(Stress_Imp_Df, Stress_Sig_Imp_Df)
      Stress_Percentages<- cbind(Improvement_Type, Stress_Percentages)
    }  else if(nrow(Stress_Imp_Df) == 1 & nrow(Stress_Sig_Imp_Df) == 0) {
      Stress_Percentages = rbind(Stress_Imp_Df, Sig_Null)
       Stress_Percentages<- cbind(Improvement_Type, Stress_Percentages)
    } else if(nrow(Stress_Imp_Df) == 0) {
      Stress_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Stress_Percentages<- cbind(Improvement_Type, Stress_Percentages)
    }

     names(Stress_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
     
     
    Scale_Names<- c("DASS21 Total", "Depression", "Anxiety", "Stress")
    
    DASS21_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("DASS21")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    DASS21_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("DASS21")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    DASS21_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("DASS21")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    DASS21_Range<- c("Total Scale" = "0-63", "Depression" = "0-21", "Anxiety" = "0-21", "Stress" = "0-21")

    
    DASS21_Descriptives<- rbind(DASS21_M_Intake, DASS21_M_Discharge, DASS21_M_Change, DASS21_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    DASS21_Descriptives<- cbind(Data, DASS21_Descriptives)
  
```

##DASS-21 Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(DASS21_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
  
#DASS21 Graph
    
    DASS21_Reformat<- dplyr::select(Scale_Report_Df, Name, DASS21.Fullscale.First.Score, DASS21.Fullscale.Last.Score)
    DASS21_Reformat<- DASS21_Reformat %>% rename(Pre = DASS21.Fullscale.First.Score, Post = DASS21.Fullscale.Last.Score)
    DASS21_Reformat<- DASS21_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    DASS21_Reformat<- gather(DASS21_Reformat, Group, DASS21.Total.Score, Pre:Post)
    DASS21_Reformat$Group<- factor(DASS21_Reformat$Group, levels=unique(DASS21_Reformat$Group))
    
    DASS21_Plot<- ggplot(data = DASS21_Reformat, aes (x = factor(Group), y = DASS21.Total.Score, group = Name))
    DASS21_Plot<- DASS21_Plot + geom_line() + xlab("Time") + ylab("DASS21 Total") 
    
    DASS21_Plot + scale_y_continuous(limits = c(0, 63), breaks = c(0,14,35,49,63)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Depression Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Dep_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
DASS21_Dep_Reformat<- dplyr::select(Scale_Report_Df, Name, DASS21.Depression.First.Score, DASS21.Depression.Last.Score)
    DASS21_Dep_Reformat<- DASS21_Dep_Reformat %>% rename(Pre = DASS21.Depression.First.Score, Post = DASS21.Depression.Last.Score)
    DASS21_Dep_Reformat<- DASS21_Dep_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    DASS21_Dep_Reformat<- gather(DASS21_Dep_Reformat, Group, DASS21.Depression.Score, Pre:Post)
    DASS21_Dep_Reformat$Group<- factor(DASS21_Dep_Reformat$Group, levels=unique(DASS21_Dep_Reformat$Group))
    
    DASS21_Dep_Plot<- ggplot(data = DASS21_Dep_Reformat, aes(x = factor(Group), y = DASS21.Depression.Score, group = Name))
    DASS21_Dep_Plot<- DASS21_Dep_Plot + geom_line() + xlab("Time") + ylab("Depression") 
    
    DASS21_Dep_Plot + scale_y_continuous(limits = c(0, 21), breaks = c(0,7,14,21)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Anxiety Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Anx_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
DASS21_Anx_Reformat<- dplyr::select(Scale_Report_Df, Name, DASS21.Anxiety.First.Score, DASS21.Anxiety.Last.Score)
    DASS21_Anx_Reformat<- DASS21_Anx_Reformat %>% rename(Pre = DASS21.Anxiety.First.Score, Post = DASS21.Anxiety.Last.Score)
    DASS21_Anx_Reformat<- DASS21_Anx_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    DASS21_Anx_Reformat<- gather(DASS21_Anx_Reformat, Group, DASS21.Anxiety.Score, Pre:Post)
    DASS21_Anx_Reformat$Group<- factor(DASS21_Anx_Reformat$Group, levels=unique(DASS21_Anx_Reformat$Group))
    
    DASS21_Anx_Plot<- ggplot(data = DASS21_Anx_Reformat, aes (x = factor(Group), y = DASS21.Anxiety.Score, group = Name))
    DASS21_Anx_Plot<- DASS21_Anx_Plot + geom_line() + xlab("Time") + ylab("Anxiety") 
    
    DASS21_Anx_Plot + scale_y_continuous(limits = c(0, 21), breaks = c(0,7,14,21)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```


##Stress Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Stress_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
DASS21_Stress_Reformat<- dplyr::select(Scale_Report_Df, Name, DASS21.Stress.First.Score, DASS21.Stress.Last.Score)
    DASS21_Stress_Reformat<- DASS21_Stress_Reformat %>% rename(Pre = DASS21.Stress.First.Score, Post = DASS21.Stress.Last.Score)
    DASS21_Stress_Reformat<- DASS21_Stress_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    DASS21_Stress_Reformat<- gather(DASS21_Stress_Reformat, Group, DASS21.Stress.Score, Pre:Post)
    DASS21_Stress_Reformat$Group<- factor(DASS21_Stress_Reformat$Group, levels=unique(DASS21_Stress_Reformat$Group))
    
    DASS21_Stress_Plot<- ggplot(data = DASS21_Stress_Reformat, aes(x = factor(Group), y = DASS21.Stress.Score, group = Name))
    DASS21_Stress_Plot<- DASS21_Stress_Plot + geom_line() + xlab("Time") + ylab("Stress") 
    
    DASS21_Stress_Plot + scale_y_continuous(limits = c(0, 21), breaks = c(0,7,14,21)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(DASS21_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete DASS-21 data were used.")
}


```