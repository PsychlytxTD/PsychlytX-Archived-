---
title: "Assessment of Quality of Life - 8 Dimensions (AQoL-8D)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---

\begingroup\Large

\begin{center} \textbf{Information About the Assessment of Quality of Life - 8 Dimensions (AQoL-8D)} \end{center} 

#What it Measures: 

* Health-related quality of life across the psychosocial domain (including mental health, happiness, coping, relationships & self worth) 
and the physical domain (including independent living, pain and functioning of the senses).


#What Higher Scores Mean:

* Greater quality of life. This applies to all subscales, dimensions and the total scale score. For exmample, a higher
score on the Pain subscale indicates **greater** quality of life in terms of pain frequency, intensity and interference
in daily activities.

#Scale Quality:

* The AQOL-8D was developed by a team at Monash University in Australia. It is intended to rectify the psychometric limitations of
existing measures that are widely used, including the EQ5D, 15D, HUI 3 and SF-6D. Research has suggested that the AQOL-8D has strong 
psychometric properties (Richardson & Iezzi, 2011). 


#Scale Structure & Scoring:

* A total quality of life score is calculated using all 35 items. 

* A **Mental Super Dimension** score reflects the respondent's responses across the subscales of **Mental Health**, **Happiness**,
**Coping**, **Relationships** and **Self-Worth**. 

* A **Physical Super Dimension** score reflects the respondent's responses across the subscales of **Independent Living**, **Pain** and
**Senses**. 

* Subscale scores can be used to assess specific facets of quality of life and inlude the 8 subscales listed above in bold.

* All scores appearing in the PDF report have been standardised and have a range of 0-100, with higher standardised scores indicating
greater quality of life. For more information about standardisation scoring, visit the scale authors' website (www.aqol.com.au).  

\endgroup

\newpage 

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #AQOL nonsig calculations 
    
    AQOL_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Fullscale"))
    Super_Phys_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Super.Physical"))
    Super_Ment_Imp_Df<- dplyr::select(Imp_Df, contains("AQOL8D.Super.Mental"))
    Indep_Liv_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Independent.Living"))
    Pain_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Pain"))
    Senses_Imp_Df<- dplyr::select(Imp_Df, contains("AQOL8D.Senses"))
    Relation_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Relationships"))
    Ment_Health_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Mental.Health"))
    Coping_Imp_Df<- dplyr::select(Imp_Df, contains("Coping"))
    Self_Worth_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Self.Worth"))
    Happiness_Imp_Df<-dplyr::select(Imp_Df, contains("AQOL8D.Happiness"))
    
    
    
    
    AQOL_Imp_Df<-as.data.frame(gather(AQOL_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Super_Phys_Imp_Df<-as.data.frame(gather(Super_Phys_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Super_Ment_Imp_Df<-as.data.frame(gather(Super_Ment_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Indep_Liv_Imp_Df<-as.data.frame(gather(Indep_Liv_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Pain_Imp_Df<-as.data.frame(gather(Pain_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Senses_Imp_Df<-as.data.frame(gather(Senses_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Relation_Imp_Df<-as.data.frame(gather(Relation_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Ment_Health_Imp_Df<-as.data.frame(gather(Ment_Health_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Coping_Imp_Df<-as.data.frame(gather(Coping_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Self_Worth_Imp_Df<-as.data.frame(gather(Self_Worth_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Happiness_Imp_Df<-as.data.frame(gather(Happiness_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    
    #AQOL sig calculations
    
    
    AQOL_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Fullscale"))
    Super_Phys_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Super.Physical"))
    Super_Ment_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("AQOL8D.Super.Mental"))
    Indep_Liv_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Independent.Living"))
    Pain_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Pain"))
    Senses_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("AQOL8D.Senses"))
    Relation_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Relationships"))
    Ment_Health_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Mental.Health"))
    Coping_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("AQOL8D.Coping"))
    Self_Worth_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Self.Worth"))
    Happiness_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("AQOL8D.Happiness"))

    
    
      AQOL_Sig_Imp_Df<-as.data.frame(gather(AQOL_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Super_Phys_Sig_Imp_Df<-as.data.frame(gather(Super_Phys_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Super_Ment_Sig_Imp_Df<-as.data.frame(gather(Super_Ment_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Indep_Liv_Sig_Imp_Df<-as.data.frame(gather(Indep_Liv_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Pain_Sig_Imp_Df<-as.data.frame(gather(Pain_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Senses_Sig_Imp_Df<-as.data.frame(gather(Senses_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Relation_Sig_Imp_Df<-as.data.frame(gather(Relation_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Ment_Health_Sig_Imp_Df<-as.data.frame(gather(Ment_Health_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Coping_Sig_Imp_Df<-as.data.frame(gather(Coping_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Self_Worth_Sig_Imp_Df<-as.data.frame(gather(Self_Worth_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    Happiness_Sig_Imp_Df<-as.data.frame(gather(Happiness_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
    if(nrow(AQOL_Imp_Df) == 1 & nrow(AQOL_Sig_Imp_Df) == 1) {
      AQOL_Percentages<- rbind(AQOL_Imp_Df, AQOL_Sig_Imp_Df)
      AQOL_Percentages<- cbind(Improvement_Type, AQOL_Percentages)
    }  else if(nrow(AQOL_Imp_Df) == 1 & nrow(AQOL_Sig_Imp_Df) == 0) {
      AQOL_Percentages = rbind(AQOL_Imp_Df, Sig_Null)
       AQOL_Percentages<- cbind(Improvement_Type, AQOL_Percentages)
    } else if(nrow(AQOL_Imp_Df) == 0) {
      AQOL_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      AQOL_Percentages<- cbind(Improvement_Type, AQOL_Percentages)
    }

     names(AQOL_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


       
       if(nrow(Super_Phys_Imp_Df) == 1 & nrow(Super_Phys_Sig_Imp_Df) == 1) {
      Super_Phys_Percentages<- rbind(Super_Phys_Imp_Df, Super_Phys_Sig_Imp_Df)
      Super_Phys_Percentages<- cbind(Improvement_Type, Super_Phys_Percentages)
    }  else if(nrow(Super_Phys_Imp_Df) == 1 & nrow(Super_Phys_Sig_Imp_Df) == 0) {
      Super_Phys_Percentages = rbind(Super_Phys_Imp_Df, Sig_Null)
       Super_Phys_Percentages<- cbind(Improvement_Type, Super_Phys_Percentages)
    } else if(nrow(Super_Phys_Imp_Df) == 0) {
      Super_Phys_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Super_Phys_Percentages<- cbind(Improvement_Type, Super_Phys_Percentages)
    }

     names(Super_Phys_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
       if(nrow(Super_Ment_Imp_Df) == 1 & nrow(Super_Ment_Sig_Imp_Df) == 1) {
      Super_Ment_Percentages<- rbind(Super_Ment_Imp_Df, Super_Ment_Sig_Imp_Df)
      Super_Ment_Percentages<- cbind(Improvement_Type, Super_Ment_Percentages)
    }  else if(nrow(Super_Ment_Imp_Df) == 1 & nrow(Super_Ment_Sig_Imp_Df) == 0) {
      Super_Ment_Percentages = rbind(Super_Ment_Imp_Df, Sig_Null)
       Super_Ment_Percentages<- cbind(Improvement_Type, Super_Ment_Percentages)
    } else if(nrow(Super_Ment_Imp_Df) == 0) {
      Super_Ment_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Super_Ment_Percentages<- cbind(Improvement_Type, Super_Ment_Percentages)
    }

     names(Super_Ment_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
      if(nrow(Indep_Liv_Imp_Df) == 1 & nrow(Indep_Liv_Sig_Imp_Df) == 1) {
      Indep_Liv_Percentages<- rbind(Indep_Liv_Imp_Df, Indep_Liv_Sig_Imp_Df)
      Indep_Liv_Percentages<- cbind(Improvement_Type, Indep_Liv_Percentages)
    }  else if(nrow(Indep_Liv_Imp_Df) == 1 & nrow(Indep_Liv_Sig_Imp_Df) == 0) {
      Indep_Liv_Percentages = rbind(Indep_Liv_Imp_Df, Sig_Null)
       Indep_Liv_Percentages<- cbind(Improvement_Type, Indep_Liv_Percentages)
    } else if(nrow(Indep_Liv_Imp_Df) == 0) {
      Indep_Liv_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Indep_Liv_Percentages<- cbind(Improvement_Type, Indep_Liv_Percentages)
    }

     names(Indep_Liv_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    
  
    
      if(nrow(Pain_Imp_Df) == 1 & nrow(Pain_Sig_Imp_Df) == 1) {
      Pain_Percentages<- rbind(Pain_Imp_Df, Pain_Sig_Imp_Df)
      Pain_Percentages<- cbind(Improvement_Type, Pain_Percentages)
    }  else if(nrow(Pain_Imp_Df) == 1 & nrow(Pain_Sig_Imp_Df) == 0) {
      Pain_Percentages = rbind(Pain_Imp_Df, Sig_Null)
       Pain_Percentages<- cbind(Improvement_Type, Pain_Percentages)
    } else if(nrow(Pain_Imp_Df) == 0) {
      Pain_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Pain_Percentages<- cbind(Improvement_Type, Pain_Percentages)
    }

     names(Pain_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
     if(nrow(Senses_Imp_Df) == 1 & nrow(Senses_Sig_Imp_Df) == 1) {
      Senses_Percentages<- rbind(Senses_Imp_Df, Senses_Sig_Imp_Df)
      Senses_Percentages<- cbind(Improvement_Type, Senses_Percentages)
    }  else if(nrow(Senses_Imp_Df) == 1 & nrow(Senses_Sig_Imp_Df) == 0) {
      Senses_Percentages = rbind(Senses_Imp_Df, Sig_Null)
       Senses_Percentages<- cbind(Improvement_Type, Senses_Percentages)
    } else if(nrow(Senses_Imp_Df) == 0) {
      Senses_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Senses_Percentages<- cbind(Improvement_Type, Senses_Percentages)
    }

     names(Senses_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


     
     if(nrow(Relation_Imp_Df) == 1 & nrow(Relation_Sig_Imp_Df) == 1) {
      Relation_Percentages<- rbind(Relation_Imp_Df, Relation_Sig_Imp_Df)
      Relation_Percentages<- cbind(Improvement_Type, Relation_Percentages)
    }  else if(nrow(Relation_Imp_Df) == 1 & nrow(Relation_Sig_Imp_Df) == 0) {
      Relation_Percentages = rbind(Relation_Imp_Df, Sig_Null)
       Relation_Percentages<- cbind(Improvement_Type, Relation_Percentages)
    } else if(nrow(Relation_Imp_Df) == 0) {
      Relation_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Relation_Percentages<- cbind(Improvement_Type, Relation_Percentages)
    }

     names(Relation_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
   
    
    
      if(nrow(Ment_Health_Imp_Df) == 1 & nrow(Ment_Health_Sig_Imp_Df) == 1) {
      Ment_Health_Percentages<- rbind(Ment_Health_Imp_Df, Ment_Health_Sig_Imp_Df)
      Ment_Health_Percentages<- cbind(Improvement_Type, Ment_Health_Percentages)
    }  else if(nrow(Ment_Health_Imp_Df) == 1 & nrow(Ment_Health_Sig_Imp_Df) == 0) {
      Ment_Health_Percentages = rbind(Ment_Health_Imp_Df, Sig_Null)
       Ment_Health_Percentages<- cbind(Improvement_Type, Ment_Health_Percentages)
    } else if(nrow(Ment_Health_Imp_Df) == 0) {
      Ment_Health_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Ment_Health_Percentages<- cbind(Improvement_Type, Ment_Health_Percentages)
    }

     names(Ment_Health_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


     
      if(nrow(Coping_Imp_Df) == 1 & nrow(Coping_Sig_Imp_Df) == 1) {
      Coping_Percentages<- rbind(Coping_Imp_Df, Coping_Sig_Imp_Df)
      Coping_Percentages<- cbind(Improvement_Type, Coping_Percentages)
    }  else if(nrow(Coping_Imp_Df) == 1 & nrow(Coping_Sig_Imp_Df) == 0) {
      Coping_Percentages = rbind(Coping_Imp_Df, Sig_Null)
       Coping_Percentages<- cbind(Improvement_Type, Coping_Percentages)
    } else if(nrow(Coping_Imp_Df) == 0) {
      Coping_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Coping_Percentages<- cbind(Improvement_Type, Coping_Percentages)
    }

     names(Coping_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
   
    if(nrow(Self_Worth_Imp_Df) == 1 & nrow(Self_Worth_Sig_Imp_Df) == 1) {
      Self_Worth_Percentages<- rbind(Self_Worth_Imp_Df, Self_Worth_Sig_Imp_Df)
      Self_Worth_Percentages<- cbind(Improvement_Type, Self_Worth_Percentages)
    }  else if(nrow(Self_Worth_Imp_Df) == 1 & nrow(Self_Worth_Sig_Imp_Df) == 0) {
      Self_Worth_Percentages = rbind(Self_Worth_Imp_Df, Sig_Null)
       Self_Worth_Percentages<- cbind(Improvement_Type, Self_Worth_Percentages)
    } else if(nrow(Self_Worth_Imp_Df) == 0) {
      Self_Worth_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Self_Worth_Percentages<- cbind(Improvement_Type, Self_Worth_Percentages)
    }

     names(Self_Worth_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    
     
     
      if(nrow(Happiness_Imp_Df) == 1 & nrow(Happiness_Sig_Imp_Df) == 1) {
      Happiness_Percentages<- rbind(Happiness_Imp_Df, Happiness_Sig_Imp_Df)
      Happiness_Percentages<- cbind(Improvement_Type, Happiness_Percentages)
    }  else if(nrow(Happiness_Imp_Df) == 1 & nrow(Happiness_Sig_Imp_Df) == 0) {
      Happiness_Percentages = rbind(Happiness_Imp_Df, Sig_Null)
       Happiness_Percentages<- cbind(Improvement_Type, Happiness_Percentages)
    } else if(nrow(Happiness_Imp_Df) == 0) {
      Happiness_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Happiness_Percentages<- cbind(Improvement_Type, Happiness_Percentages)
    }

     names(Happiness_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


      Scale_Names<- c("AQOL-8D Total", "Independent Living", "Relationships", "Mental Health", "Coping", "Pain", "Senses", "Self-Worth", "Happiness", "Mental Dimension", "Physical Dimension")
    
    AQOL_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("AQOL")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    AQOL_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("AQOL")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    AQOL_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("AQOL")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    AQOL_Range<- c("Total Scale" = "0-100","Independent Living" = "0-100",  "Relationships" = "0-100",  "Coping" = "0-100", "Pain" = "0-100", "Senses" = "0-100", "Self-Worth" = "0-100", "Happiness" = "0-100", "Mental Dimension" = "0-100", "Physical Dimension" = "0-100")

    
    AQOL_Descriptives<- rbind(AQOL_M_Intake, AQOL_M_Discharge, AQOL_M_Change, AQOL_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    AQOL_Descriptives<- cbind(Data, AQOL_Descriptives) 
  
```

##AQOL-8D Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(AQOL_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}

    AQOL_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Fullscale.First.Score, AQOL8D.Fullscale.Last.Score)
    AQOL_Reformat<- AQOL_Reformat %>% rename(Pre = AQOL8D.Fullscale.First.Score, Post = AQOL8D.Fullscale.Last.Score)
    AQOL_Reformat<- AQOL_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Reformat<- gather(AQOL_Reformat, Group, AQOL.Total.Score, Pre:Post)
    AQOL_Reformat$Group<- factor(AQOL_Reformat$Group, levels=unique(AQOL_Reformat$Group))
    
    AQOL_Plot<- ggplot(data = AQOL_Reformat, aes (x = factor(Group), y = AQOL.Total.Score, group = Name))
    AQOL_Plot<- AQOL_Plot + geom_line() + xlab("Time") + ylab("AQOL-8D Total") 
    
    AQOL_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Physical Super Dimension Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Super_Phys_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Super_Phys_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Super.Physical.First.Score, AQOL8D.Super.Physical.Last.Score)
    AQOL_Super_Phys_Reformat<- AQOL_Super_Phys_Reformat %>% rename(Pre = AQOL8D.Super.Physical.First.Score, Post = AQOL8D.Super.Physical.Last.Score)
    AQOL_Super_Phys_Reformat<- AQOL_Super_Phys_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Super_Phys_Reformat<- gather(AQOL_Super_Phys_Reformat, Group, AQOL.Super.Physical.Score, Pre:Post)
    AQOL_Super_Phys_Reformat$Group<- factor(AQOL_Super_Phys_Reformat$Group, levels=unique(AQOL_Super_Phys_Reformat$Group))
    
    AQOL_Super_Phys_Plot<- ggplot(data = AQOL_Super_Phys_Reformat, aes(x = factor(Group), y = AQOL.Super.Physical.Score, group = Name))
    AQOL_Super_Phys_Plot<- AQOL_Super_Phys_Plot + geom_line() + xlab("Time") + ylab("Physical Dimension") 
    
    AQOL_Super_Phys_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Mental Super Dimension Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Super_Ment_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Super_Ment_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Super.Mental.First.Score, AQOL8D.Super.Mental.Last.Score)
    AQOL_Super_Ment_Reformat<- AQOL_Super_Ment_Reformat %>% rename(Pre = AQOL8D.Super.Mental.First.Score, Post = AQOL8D.Super.Mental.Last.Score)
    AQOL_Super_Ment_Reformat<- AQOL_Super_Ment_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Super_Ment_Reformat<- gather(AQOL_Super_Ment_Reformat, Group, AQOL.Super.Mental.Score, Pre:Post)
    AQOL_Super_Ment_Reformat$Group<- factor(AQOL_Super_Ment_Reformat$Group, levels=unique(AQOL_Super_Ment_Reformat$Group))
    
    AQOL_Super_Ment_Plot<- ggplot(data = AQOL_Super_Ment_Reformat, aes (x = factor(Group), y = AQOL.Super.Mental.Score, group = Name))
    AQOL_Super_Ment_Plot<- AQOL_Super_Ment_Plot + geom_line() + xlab("Time") + ylab("Mental Dimension") 
    
    AQOL_Super_Ment_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

\newpage

##Independent Living Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Indep_Liv_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Indep_Liv_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Independent.Living.First.Score, AQOL8D.Independent.Living.Last.Score)
    AQOL_Indep_Liv_Reformat<- AQOL_Indep_Liv_Reformat %>% rename(Pre = AQOL8D.Independent.Living.First.Score, Post = AQOL8D.Independent.Living.Last.Score)
    AQOL_Indep_Liv_Reformat<- AQOL_Indep_Liv_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Indep_Liv_Reformat<- gather(AQOL_Indep_Liv_Reformat, Group, AQOL.Independent.Living.Score, Pre:Post)
    AQOL_Indep_Liv_Reformat$Group<- factor(AQOL_Indep_Liv_Reformat$Group, levels=unique(AQOL_Indep_Liv_Reformat$Group))
    
    AQOL_Indep_Liv_Plot<- ggplot(data = AQOL_Indep_Liv_Reformat, aes(x = factor(Group), y = AQOL.Independent.Living.Score, group = Name))
    AQOL_Indep_Liv_Plot<- AQOL_Indep_Liv_Plot + geom_line() + xlab("Time") + ylab("Independent Living") 
    
    AQOL_Indep_Liv_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Pain Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Pain_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Pain_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Pain.First.Score, AQOL8D.Pain.Last.Score)
    AQOL_Pain_Reformat<- AQOL_Pain_Reformat %>% rename(Pre = AQOL8D.Pain.First.Score, Post = AQOL8D.Pain.Last.Score)
    AQOL_Pain_Reformat<- AQOL_Pain_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Pain_Reformat<- gather(AQOL_Pain_Reformat, Group, AQOL.Pain.Score, Pre:Post)
    AQOL_Pain_Reformat$Group<- factor(AQOL_Pain_Reformat$Group, levels=unique(AQOL_Pain_Reformat$Group))
    
    AQOL_Pain_Plot<- ggplot(data = AQOL_Pain_Reformat, aes(x = factor(Group), y = AQOL.Pain.Score, group = Name))
    AQOL_Pain_Plot<- AQOL_Pain_Plot + geom_line() + xlab("Time") + ylab("Pain") 
    
    AQOL_Pain_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Senses Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Senses_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Senses_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Senses.First.Score, AQOL8D.Senses.Last.Score)
    AQOL_Senses_Reformat<- AQOL_Senses_Reformat %>% rename(Pre = AQOL8D.Senses.First.Score, Post = AQOL8D.Senses.Last.Score)
    AQOL_Senses_Reformat<- AQOL_Senses_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Senses_Reformat<- gather(AQOL_Senses_Reformat, Group, AQOL.Senses.Score, Pre:Post)
    AQOL_Senses_Reformat$Group<- factor(AQOL_Senses_Reformat$Group, levels=unique(AQOL_Senses_Reformat$Group))
    
    AQOL_Senses_Plot<- ggplot(data = AQOL_Senses_Reformat, aes(x = factor(Group), y = AQOL.Senses.Score, group = Name))
    AQOL_Senses_Plot<- AQOL_Senses_Plot + geom_line() + xlab("Time") + ylab("Senses") 
    
    AQOL_Senses_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

\newpage

##Relationships Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Relation_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Relationships_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Relationships.First.Score, AQOL8D.Relationships.Last.Score)
    AQOL_Relationships_Reformat<- AQOL_Relationships_Reformat %>% rename(Pre = AQOL8D.Relationships.First.Score, Post = AQOL8D.Relationships.Last.Score)
    AQOL_Relationships_Reformat<- AQOL_Relationships_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Relationships_Reformat<- gather(AQOL_Relationships_Reformat, Group, AQOL.Relationships.Score, Pre:Post)
    AQOL_Relationships_Reformat$Group<- factor(AQOL_Relationships_Reformat$Group, levels=unique(AQOL_Relationships_Reformat$Group))
    
    AQOL_Relationships_Plot<- ggplot(data = AQOL_Relationships_Reformat, aes(x = factor(Group), y = AQOL.Relationships.Score, group = Name))
    AQOL_Relationships_Plot<- AQOL_Relationships_Plot + geom_line() + xlab("Time") + ylab("Relationships") 
    
    AQOL_Relationships_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Mental Health Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Ment_Health_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
    AQOL_Ment_Health_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Mental.Health.First.Score, AQOL8D.Mental.Health.Last.Score)
    AQOL_Ment_Health_Reformat<- AQOL_Ment_Health_Reformat %>% rename(Pre = AQOL8D.Mental.Health.First.Score, Post = AQOL8D.Mental.Health.Last.Score)
    AQOL_Ment_Health_Reformat<- AQOL_Ment_Health_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Ment_Health_Reformat<- gather(AQOL_Ment_Health_Reformat, Group, AQOL.Mental.Health.Score, Pre:Post)
    AQOL_Ment_Health_Reformat$Group<- factor(AQOL_Ment_Health_Reformat$Group, levels=unique(AQOL_Ment_Health_Reformat$Group))
    
    AQOL_Ment_Health_Plot<- ggplot(data = AQOL_Ment_Health_Reformat, aes(x = factor(Group), y = AQOL.Mental.Health.Score, group = Name))
    AQOL_Ment_Health_Plot<- AQOL_Ment_Health_Plot + geom_line() + xlab("Time") + ylab("Mental Health") 
    
    AQOL_Ment_Health_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```



##Coping Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Coping_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Coping_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Coping.First.Score, AQOL8D.Coping.Last.Score)
    AQOL_Coping_Reformat<- AQOL_Coping_Reformat %>% rename(Pre = AQOL8D.Coping.First.Score, Post = AQOL8D.Coping.Last.Score)
    AQOL_Coping_Reformat<- AQOL_Coping_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Coping_Reformat<- gather(AQOL_Coping_Reformat, Group, AQOL.Coping.Score, Pre:Post)
    AQOL_Coping_Reformat$Group<- factor(AQOL_Coping_Reformat$Group, levels=unique(AQOL_Coping_Reformat$Group))
    
    AQOL_Coping_Plot<- ggplot(data = AQOL_Coping_Reformat, aes(x = factor(Group), y = AQOL.Coping.Score, group = Name))
    AQOL_Coping_Plot<- AQOL_Coping_Plot + geom_line() + xlab("Time") + ylab("Coping") 
    
    AQOL_Coping_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

\newpage

##Self-Worth Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Self_Worth_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Self_Worth_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Self.Worth.First.Score, AQOL8D.Self.Worth.Last.Score)
    AQOL_Self_Worth_Reformat<- AQOL_Self_Worth_Reformat %>% rename(Pre = AQOL8D.Self.Worth.First.Score, Post = AQOL8D.Self.Worth.Last.Score)
    AQOL_Self_Worth_Reformat<- AQOL_Self_Worth_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Self_Worth_Reformat<- gather(AQOL_Self_Worth_Reformat, Group, AQOL.Self.Worth.Score, Pre:Post)
    AQOL_Self_Worth_Reformat$Group<- factor(AQOL_Self_Worth_Reformat$Group, levels=unique(AQOL_Self_Worth_Reformat$Group))
    
    AQOL_Self_Worth_Plot<- ggplot(data = AQOL_Self_Worth_Reformat, aes(x = factor(Group), y = AQOL.Self.Worth.Score, group = Name))
    AQOL_Self_Worth_Plot<- AQOL_Self_Worth_Plot + geom_line() + xlab("Time") + ylab("Self Worth") 
    
    AQOL_Self_Worth_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Happiness Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Happiness_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
AQOL_Happiness_Reformat<- dplyr::select(Scale_Report_Df, Name, AQOL8D.Happiness.First.Score, AQOL8D.Happiness.Last.Score)
    AQOL_Happiness_Reformat<- AQOL_Happiness_Reformat %>% rename(Pre = AQOL8D.Happiness.First.Score, Post = AQOL8D.Happiness.Last.Score)
    AQOL_Happiness_Reformat<- AQOL_Happiness_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    AQOL_Happiness_Reformat<- gather(AQOL_Happiness_Reformat, Group, AQOL.Happiness.Score, Pre:Post)
    AQOL_Happiness_Reformat$Group<- factor(AQOL_Happiness_Reformat$Group, levels=unique(AQOL_Happiness_Reformat$Group))
    
    AQOL_Happiness_Plot<- ggplot(data = AQOL_Happiness_Reformat, aes(x = factor(Group), y = AQOL.Happiness.Score, group = Name))
    AQOL_Happiness_Plot<- AQOL_Happiness_Plot + geom_line() + xlab("Time") + ylab("Happiness") 
    
    AQOL_Happiness_Plot + scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Average Change Over Treatment Period

####See last page.

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}


cat('\n#', "Reporting Period", '\n')
cat('\n')

if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with compete AQoL-8D data were used.")
}


AQOL_Descriptives_Tab<- kable(AQOL_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = F, latex_options = "striped") %>% row_spec(0, bold = T) %>% kable_styling(latex_options="scale_down")

landscape(AQOL_Descriptives_Tab)

```
