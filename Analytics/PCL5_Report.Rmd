---
title: "PTSD Checklist for DSM-5 (PCL-5)"
author: "Analytics Report generated by Sentient Psychometrics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=2cm,right=2cm,top=1.5cm,bottom=1.2cm"
output:
  pdf_document:
    latex_engine: pdflatex
header-includes:
- \usepackage[fontsize=7.8pt]{scrextend}
- \usepackage{color}
- \usepackage{booktabs}
- \usepackage[table]{xcolor}
fontfamily: arev
always_allow_html: yes
params:
Imp_Df: 'NULL'
Sig_Imp_Df: 'NULL'
Scale_Report_Df: 'NULL'
Periods: 'NULL'
---


\begingroup\Large

\begin{center} \textbf{Information About The PTSD Checklist for DSM-5 (PCL-5)} \end{center} 

#What it Measures: 

* The 20 symptoms of Post-Traumatic Stress Disorder, as outlined in the Diagnostic & Statistical Manual of Psychological Disorders, 5th Edition (DSM-5).


* Re-experiencing symptoms, such as involuntary distressing dreams, memories, thoughts and feelings related to a traumatic event(s).


* Avoidance symptoms, such as efforts to avoid internal or external reminders of the traumatic event(s)


* Negative alterations in cognitions and mood, such as negative mood states, lack of positive emotions, and exaggerated negative beliefs about onself, the world, and others. 

* Hyperarousal symptoms, such as hypervigilance, exaggerated startle response, sleep difficulties, irritability and concentration problems.


#What Higher Scores Mean:

* More severe PTSD symptomatology. 


* A provisional diagnosis of PTSD may be made if scores are sufficiently elevated. The optimal cut-off score will vary according to the service and population. As a general guideline, cut-off scores of **38** (Weathers et al., 2013) and **33** (Bovin et al., 2015) have been endorsed as sufficient for a provisional PTSD diagnosis. 


#Scale Quality:

* The PCL-5 has undergone extensive psychometric validation, and is one of the most widely used self-report screening measures for PTSD (for a review see McDonald & Calhoun, 2010). 


#Scale Structure:

* 20 items.


* 5-point Likert Scale. 


* Respondents are asked to what extent (0 = "Not at all"; 4 = "Extremely") they have been bothered by each symptom during the past month (e.g. "Repeated, disturbing and unwanted memories of the stressful experience").


* Although the recommended PCL-5 method of scoring is based on a 4-factor structure (consistent with DSM-5 criteria), studies have consistently shown that a 6- or 7-factor solution provides a better fit to the data (Armour, Contractor, Shea, Elhai & Pietrzak, 2016; Ashbaugh, Houle-Johnson, Herbert, El-Hage & Brunet, 2016; Blevins, Weathers, Davis, Witte & Domino, 2015; Bovin et al., 2015; Clark et al., 2016, Seligowski & Orcutt, 2015). 

\endgroup

\newpage

```{r, echo = FALSE, warning = FALSE, comment = NA, results = 'asis'}

    #PCL5 nonsig calculations 
    
    PCL5_Imp_Df<-dplyr::select(Imp_Df, contains("PCL5.Fullscale"))
   Intrusion_Imp_Df<-dplyr::select(Imp_Df, contains("PCL5.Intrusion"))
    NACM_Imp_Df<- dplyr::select(Imp_Df, contains("PCL5.NACM"))
    Hyperarousal_Imp_Df<-dplyr::select(Imp_Df, contains("PCL5.Hyperarousal"))
    Avoidance_Imp_Df<-dplyr::select(Imp_Df, contains("PCL5.Avoidance"))

    
    PCL5_Imp_Df<-as.data.frame(gather(PCL5_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
   Intrusion_Imp_Df<-as.data.frame(gather(Intrusion_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    NACM_Imp_Df<-as.data.frame(gather(NACM_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Hyperarousal_Imp_Df<-as.data.frame(gather(Hyperarousal_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Avoidance_Imp_Df<-as.data.frame(gather(Avoidance_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    #PCL-5 sig calculations
    
    
    PCL5_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("PCL5.Fullscale"))
   Intrusion_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("PCL5.Intrusion"))
    NACM_Sig_Imp_Df<- dplyr::select(Sig_Imp_Df, contains("PCL5.NACM"))
    Hyperarousal_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("PCL5.Hyperarousal"))
    Avoidance_Sig_Imp_Df<-dplyr::select(Sig_Imp_Df, contains("PCL5.Avoidance"))

    
      PCL5_Sig_Imp_Df<-as.data.frame(gather(PCL5_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
   Intrusion_Sig_Imp_Df<-as.data.frame(gather(Intrusion_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    NACM_Sig_Imp_Df<-as.data.frame(gather(NACM_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
    
     Hyperarousal_Sig_Imp_Df<-as.data.frame(gather(Hyperarousal_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))
     Avoidance_Sig_Imp_Df<-as.data.frame(gather(Avoidance_Sig_Imp_Df, "Outcome", "Value") %>% na.omit() %>% count(Outcome,Value) %>% mutate(Percentage = paste0(round(100 * n/sum(n), 0), "%"))) %>% dplyr::filter(Value == "Yes") %>% dplyr::select(-c(Outcome,Value))

    Improvement_Type<- c("Improvement", "Statistically Reliable Improvement")
    
    Sig_Null<- data.frame(n = "NA", Percentage = "NA")
    
    
    if(nrow(PCL5_Imp_Df) == 1 & nrow(PCL5_Sig_Imp_Df) == 1) {
      PCL5_Percentages<- rbind(PCL5_Imp_Df, PCL5_Sig_Imp_Df)
      PCL5_Percentages<- cbind(Improvement_Type, PCL5_Percentages)
    }  else if(nrow(PCL5_Imp_Df) == 1 & nrow(PCL5_Sig_Imp_Df) == 0) {
      PCL5_Percentages = rbind(PCL5_Imp_Df, Sig_Null)
       PCL5_Percentages<- cbind(Improvement_Type, PCL5_Percentages)
    } else if(nrow(PCL5_Imp_Df) == 0) {
      PCL5_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      PCL5_Percentages<- cbind(Improvement_Type, PCL5_Percentages)
    }

     names(PCL5_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


       
       if(nrow(Intrusion_Imp_Df) == 1 & nrow(Intrusion_Sig_Imp_Df) == 1) {
     Intrusion_Percentages<- rbind(Intrusion_Imp_Df,Intrusion_Sig_Imp_Df)
     Intrusion_Percentages<- cbind(Improvement_Type,Intrusion_Percentages)
    }  else if(nrow(Intrusion_Imp_Df) == 1 & nrow(Intrusion_Sig_Imp_Df) == 0) {
     Intrusion_Percentages = rbind(Intrusion_Imp_Df, Sig_Null)
      Intrusion_Percentages<- cbind(Improvement_Type,Intrusion_Percentages)
    } else if(nrow(Intrusion_Imp_Df) == 0) {
     Intrusion_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
     Intrusion_Percentages<- cbind(Improvement_Type,Intrusion_Percentages)
    }

     names(Intrusion_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


    
       if(nrow(NACM_Imp_Df) == 1 & nrow(NACM_Sig_Imp_Df) == 1) {
      NACM_Percentages<- rbind(NACM_Imp_Df, NACM_Sig_Imp_Df)
      NACM_Percentages<- cbind(Improvement_Type, NACM_Percentages)
    }  else if(nrow(NACM_Imp_Df) == 1 & nrow(NACM_Sig_Imp_Df) == 0) {
      NACM_Percentages = rbind(NACM_Imp_Df, Sig_Null)
       NACM_Percentages<- cbind(Improvement_Type, NACM_Percentages)
    } else if(nrow(NACM_Imp_Df) == 0) {
      NACM_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      NACM_Percentages<- cbind(Improvement_Type, NACM_Percentages)
    }

     names(NACM_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")
    
    
    
      if(nrow(Hyperarousal_Imp_Df) == 1 & nrow(Hyperarousal_Sig_Imp_Df) == 1) {
      Hyperarousal_Percentages<- rbind(Hyperarousal_Imp_Df, Hyperarousal_Sig_Imp_Df)
      Hyperarousal_Percentages<- cbind(Improvement_Type, Hyperarousal_Percentages)
    }  else if(nrow(Hyperarousal_Imp_Df) == 1 & nrow(Hyperarousal_Sig_Imp_Df) == 0) {
      Hyperarousal_Percentages = rbind(Hyperarousal_Imp_Df, Sig_Null)
       Hyperarousal_Percentages<- cbind(Improvement_Type, Hyperarousal_Percentages)
    } else if(nrow(Hyperarousal_Imp_Df) == 0) {
      Hyperarousal_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Hyperarousal_Percentages<- cbind(Improvement_Type, Hyperarousal_Percentages)
    }

     names(Hyperarousal_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")

    
  
    
      if(nrow(Avoidance_Imp_Df) == 1 & nrow(Avoidance_Sig_Imp_Df) == 1) {
      Avoidance_Percentages<- rbind(Avoidance_Imp_Df, Avoidance_Sig_Imp_Df)
      Avoidance_Percentages<- cbind(Improvement_Type, Avoidance_Percentages)
    }  else if(nrow(Avoidance_Imp_Df) == 1 & nrow(Avoidance_Sig_Imp_Df) == 0) {
      Avoidance_Percentages = rbind(Avoidance_Imp_Df, Sig_Null)
       Avoidance_Percentages<- cbind(Improvement_Type, Avoidance_Percentages)
    } else if(nrow(Avoidance_Imp_Df) == 0) {
      Avoidance_Percentages<- data.frame(x = c("NA", "NA"), y = c("NA", "NA"))
      Avoidance_Percentages<- cbind(Improvement_Type, Avoidance_Percentages)
    }

     names(Avoidance_Percentages)<- c( "", "Number of Cases Improved", "Percentage of Cases Improved")


  
      Scale_Names<- c("PCL-5 Total", "Intrusion", "NACM", "Hyperarousal", "Avoidance")
    
    PCL5_M_Intake<- Scale_Report_Df %>% select(contains("First.Score")) %>% select(contains("PCL5")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    PCL5_M_Discharge<- Scale_Report_Df %>% select(contains("Last.Score")) %>% select(contains("PCL5")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    PCL5_M_Change<- Scale_Report_Df %>% select(contains("Change")) %>% select(contains("PCL5")) %>% summarise_all(funs(round(mean(., na.rm = TRUE), digits = 2))) %>% rename_all(funs(c(Scale_Names)))
    PCL5_Range<- c("Total Scale" = "0-80","Intrusion" = "0-20", "Negative Alteration Cognition & Mood" = "0-28","Hyperarousal" = "0-24", "Avoidance" = "0-8")

    
    PCL5_Descriptives<- rbind(PCL5_M_Intake, PCL5_M_Discharge, PCL5_M_Change, PCL5_Range)
    Data<- c("Mean Intake Score", "Mean Discharge Score", "Mean Change", "Range of Possible Scores")
    PCL5_Descriptives<- cbind(Data, PCL5_Descriptives) 
  
```

##PCL-5 Total Scale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(PCL5_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}

    PCL5_Reformat<- dplyr::select(Scale_Report_Df, Name, PCL5.Fullscale.First.Score, PCL5.Fullscale.Last.Score)
    PCL5_Reformat<- PCL5_Reformat %>% rename(Pre = PCL5.Fullscale.First.Score, Post = PCL5.Fullscale.Last.Score)
    PCL5_Reformat<- PCL5_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    PCL5_Reformat<- gather(PCL5_Reformat, Group, PCL5.Total.Score, Pre:Post)
    PCL5_Reformat$Group<- factor(PCL5_Reformat$Group, levels=unique(PCL5_Reformat$Group))
    
    PCL5_Plot<- ggplot(data = PCL5_Reformat, aes (x = factor(Group), y = PCL5.Total.Score, group = Name))
    PCL5_Plot<- PCL5_Plot + geom_line() + xlab("Time") + ylab("PCL-5 Total") 
    
    PCL5_Plot + scale_y_continuous(limits = c(0, 80), breaks = c(0,20,40,60,80)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

##Intrusion Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Intrusion_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
PCL5_Intrusion_Reformat<- dplyr::select(Scale_Report_Df, Name, PCL5.Intrusion.First.Score, PCL5.Intrusion.Last.Score)
    PCL5_Intrusion_Reformat<- PCL5_Intrusion_Reformat %>% rename(Pre = PCL5.Intrusion.First.Score, Post = PCL5.Intrusion.Last.Score)
    PCL5_Intrusion_Reformat<- PCL5_Intrusion_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    PCL5_Intrusion_Reformat<- gather(PCL5_Intrusion_Reformat, Group, PCL5.Intrusion.Score, Pre:Post)
    PCL5_Intrusion_Reformat$Group<- factor(PCL5_Intrusion_Reformat$Group, levels=unique(PCL5_Intrusion_Reformat$Group))
    
    PCL5_Intrusion_Plot<- ggplot(data = PCL5_Intrusion_Reformat, aes(x = factor(Group), y = PCL5.Intrusion.Score, group = Name))
    PCL5_Intrusion_Plot<- PCL5_Intrusion_Plot + geom_line() + xlab("Time") + ylab("Intrusion") 
    
    PCL5_Intrusion_Plot + scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Negative Alteration in Cognition & Mood (NACM) Subscale 

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(NACM_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)

```

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis', fig.width = 4, fig.height = 1.9, fig.align='left'}
PCL5_NACM_Reformat<- dplyr::select(Scale_Report_Df, Name, PCL5.NACM.First.Score, PCL5.NACM.Last.Score)
    PCL5_NACM_Reformat<- PCL5_NACM_Reformat %>% rename(Pre = PCL5.NACM.First.Score, Post = PCL5.NACM.Last.Score)
    PCL5_NACM_Reformat<- PCL5_NACM_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    PCL5_NACM_Reformat<- gather(PCL5_NACM_Reformat, Group, PCL5.NACM.Score, Pre:Post)
    PCL5_NACM_Reformat$Group<- factor(PCL5_NACM_Reformat$Group, levels=unique(PCL5_NACM_Reformat$Group))
    
    PCL5_NACM_Plot<- ggplot(data = PCL5_NACM_Reformat, aes (x = factor(Group), y = PCL5.NACM.Score, group = Name))
    PCL5_NACM_Plot<- PCL5_NACM_Plot + geom_line() + xlab("Time") + ylab("NACM") 
    
    PCL5_NACM_Plot + scale_y_continuous(limits = c(0, 28), breaks = c(0,7,14,21,28)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
```

\newpage

##Hyperarousal Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Hyperarousal_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
PCL5_Hyperarousal_Reformat<- dplyr::select(Scale_Report_Df, Name, PCL5.Hyperarousal.First.Score, PCL5.Hyperarousal.Last.Score)
    PCL5_Hyperarousal_Reformat<- PCL5_Hyperarousal_Reformat %>% rename(Pre = PCL5.Hyperarousal.First.Score, Post = PCL5.Hyperarousal.Last.Score)
    PCL5_Hyperarousal_Reformat<- PCL5_Hyperarousal_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    PCL5_Hyperarousal_Reformat<- gather(PCL5_Hyperarousal_Reformat, Group, PCL5.Hyperarousal.Score, Pre:Post)
    PCL5_Hyperarousal_Reformat$Group<- factor(PCL5_Hyperarousal_Reformat$Group, levels=unique(PCL5_Hyperarousal_Reformat$Group))
    
    PCL5_Hyperarousal_Plot<- ggplot(data = PCL5_Hyperarousal_Reformat, aes(x = factor(Group), y = PCL5.Hyperarousal.Score, group = Name))
    PCL5_Hyperarousal_Plot<- PCL5_Hyperarousal_Plot + geom_line() + xlab("Time") + ylab("Hyperarousal") 
    
    PCL5_Hyperarousal_Plot + scale_y_continuous(limits = c(0, 24), breaks = c(0,8,16,24)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```

##Avoidance Subscale

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(Avoidance_Percentages, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T)
```

```{r,echo=FALSE,warning=FALSE,comment=NA, fig.width = 4, fig.height = 1.9, fig.align='left'}
PCL5_Avoidance_Reformat<- dplyr::select(Scale_Report_Df, Name, PCL5.Avoidance.First.Score, PCL5.Avoidance.Last.Score)
    PCL5_Avoidance_Reformat<- PCL5_Avoidance_Reformat %>% rename(Pre = PCL5.Avoidance.First.Score, Post = PCL5.Avoidance.Last.Score)
    PCL5_Avoidance_Reformat<- PCL5_Avoidance_Reformat %>% dplyr::filter(complete.cases(Pre, Post))

    PCL5_Avoidance_Reformat<- gather(PCL5_Avoidance_Reformat, Group, PCL5.Avoidance.Score, Pre:Post)
    PCL5_Avoidance_Reformat$Group<- factor(PCL5_Avoidance_Reformat$Group, levels=unique(PCL5_Avoidance_Reformat$Group))
    
    PCL5_Avoidance_Plot<- ggplot(data = PCL5_Avoidance_Reformat, aes(x = factor(Group), y = PCL5.Avoidance.Score, group = Name))
    PCL5_Avoidance_Plot<- PCL5_Avoidance_Plot + geom_line() + xlab("Time") + ylab("Avoidance") 
    
    PCL5_Avoidance_Plot + scale_y_continuous(limits = c(0, 8), breaks = c(0,2,4,6,8)) + scale_x_discrete(expand = c(0.2, 0)) + theme_bw() + theme(panel.background = element_rect("#f1f1f1"), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "#00004c", fill=NA, size=3)) + theme(axis.text.x =  element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.text.y = element_text(size=9, family = "AvantGarde", color = "black", face = "bold"), axis.title.x = element_text(size=9, family = "AvantGarde", face = "bold"), axis.title.y = element_text(size=9, family = "AvantGarde", face = "bold")) 
    

```


##Average Change Over Treatment Period

```{r,echo=FALSE,warning=FALSE,comment=NA,results='asis'}

kable(PCL5_Descriptives, booktabs = T, format = "latex") %>% kable_styling(position = "left", full_width = T, latex_options = "striped") %>% row_spec(0, bold = T) 

```

##Reporting Period
```{r,echo = FALSE,warning=FALSE,comment = NA, results='asis'}


if(!is.null(Periods)) {
  cat(Periods, sep = ", ")
} else if (is.null(Periods)) {
  cat("No reporting period was specified. All cases with complete PCL-5 data were used.")
}


```